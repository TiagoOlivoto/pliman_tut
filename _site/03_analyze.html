<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.80">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R package {pliman} - Analyze objects</title>
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><link href="./04_phytopathometry.html" rel="next">
<link href="./02_segment.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link class="quarto-color-scheme" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link class="quarto-color-scheme" href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="site_libs/bootstrap/bootstrap-dark.min.css">
<script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="docked">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R package {pliman}</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./00_about.html">About</a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto"><i class="bi bi-fab fa-researchgate fa" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TiagoOlivoto/pliman"><i class="bi bi-bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tolivoto"><i class="bi bi-bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><i class="bi bi-fab fa-mendeley fa" role="img">
</i> 
 </a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Analyze objects</h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_manipulate.html" class="sidebar-item-text sidebar-link">Import and manipulate</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_segment.html" class="sidebar-item-text sidebar-link">Segment objects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_analyze.html" class="sidebar-item-text sidebar-link active">Analyze objects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_phytopathometry.html" class="sidebar-item-text sidebar-link">Phytopathometry</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">In this page</h2>
<ul>
<li><a href="#directory" class="nav-link active" data-scroll-target="#directory"> <span class="header-section-number">1</span> Directory</a></li>
<li>
<a href="#working-with-polygons" class="nav-link" data-scroll-target="#working-with-polygons"> <span class="header-section-number">2</span> Working with polygons</a>
<ul class="collapse">
<li><a href="#area" class="nav-link" data-scroll-target="#area"> <span class="header-section-number">2.1</span> Area</a></li>
<li><a href="#perimeter" class="nav-link" data-scroll-target="#perimeter"> <span class="header-section-number">2.2</span> Perimeter</a></li>
<li><a href="#radius" class="nav-link" data-scroll-target="#radius"> <span class="header-section-number">2.3</span> Radius</a></li>
<li><a href="#length-and-width" class="nav-link" data-scroll-target="#length-and-width"> <span class="header-section-number">2.4</span> Length and width</a></li>
<li><a href="#circularity-eccentricity-diameter-and-elongation" class="nav-link" data-scroll-target="#circularity-eccentricity-diameter-and-elongation"> <span class="header-section-number">2.5</span> Circularity, eccentricity, diameter and elongation</a></li>
<li><a href="#rotate-polygons" class="nav-link" data-scroll-target="#rotate-polygons"> <span class="header-section-number">2.6</span> Rotate polygons</a></li>
<li><a href="#invert-polygons" class="nav-link" data-scroll-target="#invert-polygons"> <span class="header-section-number">2.7</span> Invert polygons</a></li>
<li><a href="#perimeter-sampling" class="nav-link" data-scroll-target="#perimeter-sampling"> <span class="header-section-number">2.8</span> Perimeter sampling</a></li>
<li><a href="#smoothing" class="nav-link" data-scroll-target="#smoothing"> <span class="header-section-number">2.9</span> smoothing</a></li>
<li><a href="#noises" class="nav-link" data-scroll-target="#noises"> <span class="header-section-number">2.10</span> Noises</a></li>
</ul>
</li>
<li>
<a href="#analyzing-objects" class="nav-link" data-scroll-target="#analyzing-objects"> <span class="header-section-number">3</span> Analyzing objects</a>
<ul class="collapse">
<li>
<a href="#adjusting-object-measurements" class="nav-link" data-scroll-target="#adjusting-object-measurements"> <span class="header-section-number">3.1</span> Adjusting object measurements</a>
<ul class="collapse">
<li><a href="#declaring-a-known-value" class="nav-link" data-scroll-target="#declaring-a-known-value"> <span class="header-section-number">3.1.1</span> Declaring a known value</a></li>
<li><a href="#declaring-the-image-resolution" class="nav-link" data-scroll-target="#declaring-the-image-resolution"> <span class="header-section-number">3.1.2</span> Declaring the image resolution</a></li>
<li><a href="#understanding-measurements" class="nav-link" data-scroll-target="#understanding-measurements"> <span class="header-section-number">3.1.3</span> Understanding measurements</a></li>
</ul>
</li>
<li><a href="#texture-features" class="nav-link" data-scroll-target="#texture-features"> <span class="header-section-number">3.2</span> Texture features</a></li>
<li><a href="#single-image-processing" class="nav-link" data-scroll-target="#single-image-processing"> <span class="header-section-number">3.3</span> Single image processing</a></li>
<li><a href="#batch-processing" class="nav-link" data-scroll-target="#batch-processing"> <span class="header-section-number">3.4</span> Batch processing</a></li>
</ul>
</li>
<li><a href="#object-coordinates" class="nav-link" data-scroll-target="#object-coordinates"> <span class="header-section-number">4</span> Object coordinates</a></li>
<li><a href="#isolating-objects" class="nav-link" data-scroll-target="#isolating-objects"> <span class="header-section-number">5</span> Isolating objects</a></li>
<li><a href="#including-objects-in-a-list" class="nav-link" data-scroll-target="#including-objects-in-a-list"> <span class="header-section-number">6</span> Including objects in a list</a></li>
<li><a href="#rgb-values-for-each-object" class="nav-link" data-scroll-target="#rgb-values-for-each-object"> <span class="header-section-number">7</span> RGB values for each object</a></li>
<li>
<a href="#leaf-area" class="nav-link" data-scroll-target="#leaf-area"> <span class="header-section-number">8</span> Leaf area</a>
<ul class="collapse">
<li><a href="#known-resolution" class="nav-link" data-scroll-target="#known-resolution"> <span class="header-section-number">8.1</span> Known resolution</a></li>
<li><a href="#reference-object-dev-version" class="nav-link" data-scroll-target="#reference-object-dev-version"> <span class="header-section-number">8.2</span> Reference object (dev version)</a></li>
<li><a href="#filling-holes" class="nav-link" data-scroll-target="#filling-holes"> <span class="header-section-number">8.3</span> Filling ‘holes’</a></li>
<li><a href="#compound-leaves" class="nav-link" data-scroll-target="#compound-leaves"> <span class="header-section-number">8.4</span> Compound leaves</a></li>
<li><a href="#multiple-images-of-the-same-sample" class="nav-link" data-scroll-target="#multiple-images-of-the-same-sample"> <span class="header-section-number">8.5</span> Multiple images of the same sample</a></li>
</ul>
</li>
</ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title-block d-none d-lg-block"><div><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<div class="quarto-title"><h1 class="title d-none d-lg-block">Analyze objects</h1></div></header><section id="directory" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Directory</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="working-with-polygons" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Working with polygons</h1>
<blockquote class="blockquote">
<p>A ‘polygon’ is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
</blockquote>
<p>Given the above, we can conclude that image objects can be expressed as polygons with <code>n</code> vertices. <code>pliman</code> has a set of functions(<code>draw_*()</code>) useful for drawing common shapes like circles, squares, triangles, rectangles and <code>n</code>- tagons . Another group of <code>poly_*()</code> functions can be used to analyze polygons. Let’s start with a simple example related to the area and perimeter of a square.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>| Tools for Plant Image Analysis (pliman 1.2.0)            |</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>| Author: Tiago Olivoto                                    |</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>| Type 'citation('pliman')' to know how to cite pliman     |</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>| Type 'vignette('pliman_start')' for a short tutorial     |</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>| Visit 'http://bit.ly/pkg_pliman' for a complete tutorial |</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">square</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Now, let’s see what happens when we start with a hexagon and increase the number of sides up to 1000.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>  side6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 side12 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">12</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 side24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">24</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">100</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 side500 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">500</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">1000</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">shapes</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   side6   side12   side24  side100  side500  side100 
2.598076 3.000000 3.105829 3.139526 3.141510 3.141572 </code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   side6   side12   side24  side100  side500  side100 
6.000000 6.211657 6.265257 6.282152 6.283144 6.283175 </code></pre>
</div>
</div>
<p>Note that when <span class="math inline">\(n \to \infty\)</span>, the sum of the sides becomes the circumference of the circle, given by <span class="math inline">\(2 \pi r\)</span>, and the area becomes <span class="math inline">\(\pi r^2\)</span>. This is fun, but <code>pliman</code> is primarily designed for analyzing plant image analysis. So why use polygons? Let’s see how we can use these functions to get applicable information.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># getting the outline of objects</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plotting the polygon</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 3, 12, and 24.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cont</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"12"</span>, <span class="st">"24"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the current version of <code>pliman</code>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, Claude (2008)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and Montero et al.&nbsp;(2009)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<section id="area" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="area">
<span class="header-section-number">2.1</span> Area</h2>
<p>The area of a shape is calculated using Shoelace ’s formula (Lee and Lim, 2017)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, as follows</p>
<p><span class="math display">\[
A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>      1       3      12      24 
22619.5 46388.5 11087.0  1768.0 </code></pre>
</div>
</div>
</section><section id="perimeter" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="perimeter">
<span class="header-section-number">2.2</span> Perimeter</h2>
<p>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_distpts()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       1        3       12       24 
669.5412 896.6783 514.5290 175.5097 </code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># perimeter of a circle with radius 2</span></span>
<span><span class="va">circle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 12.56635</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check the result</span></span>
<span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 12.56637</code></pre>
</div>
</div>
</section><section id="radius" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="radius">
<span class="header-section-number">2.3</span> Radius</h2>
<p>The radius of a pixel on the object’s contour is calculated as its distance from the object’s centroid(also called ‘center of mass’). These distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stats for radius</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
 88.75563 124.90380  62.67764  24.21182 </code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">min_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       1        3       12       24 
63.58162 88.99496 39.17004 16.46777 </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">max_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
134.19687 185.49516  98.89383  36.25669 </code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">sd_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
17.399797 27.191664 15.269774  5.728793 </code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># average radius of circle above</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 1.999998</code></pre>
</div>
</div>
</section><section id="length-and-width" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="length-and-width">
<span class="header-section-number">2.4</span> Length and width</h2>
<p>The length and width of an object are calculated with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw()</a></code>, as the difference between the maximum and minimum of the <code>x</code> and <code>y</code> coordinates after the object has been aligned with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_align()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>     length     width
1  254.5408 139.27127
3  352.6398 186.09592
12 170.3480 126.74856
24  70.0622  35.30868</code></pre>
</div>
</div>
</section><section id="circularity-eccentricity-diameter-and-elongation" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="circularity-eccentricity-diameter-and-elongation">
<span class="header-section-number">2.5</span> Circularity, eccentricity, diameter and elongation</h2>
<p>Circularity(Montero et al.&nbsp;2009)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is also called shape compactness, or measure of roundness of an object. It is given by <span class="math inline">\(C = P^2 / A\)</span>, where <span class="math inline">\(P\)</span> is the perimeter and <span class="math inline">\(A\)</span> is the area of the object.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       1        3       12       24 
19.81854 17.33257 23.87842 17.42288 </code></pre>
</div>
</div>
<p>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given <span class="math inline">\(Cn = P^2 / 4 \pi A\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       1        3       12       24 
1.577109 1.379282 1.900185 1.386468 </code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># normalized circularity for different shapes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>plot <span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 1.27324</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 1.000003</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick()</a></code> calculates the circularity of Haralick , CH(Haralick , 1974)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. The method is based on calculating all Euclidean distances from the object’s centroid to each contour pixel. With this set of distances, the mean(<span class="math inline">\(m\)</span>) and the standard deviation(<span class="math inline">\(s\)</span>) are calculated. These statistical parameters are used in a ratio that calculates CH as $CH = m/ sd $.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       1        3       12       24 
5.100958 4.593459 4.104687 4.226340 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity()</a></code> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
0.8541852 0.9065881 0.8338600 0.8891777 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity()</a></code> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
0.3886748 0.3941193 0.5431220 0.3815938 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation()</a></code> Calculates the elongation of an object as <code>1 - width / length</code></p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
0.4528529 0.4722776 0.2559433 0.4960381 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper()</a></code> Calculates the gauge(also called Feret’s diameter).</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>        1         3        12        24 
254.56826 352.75062 173.30320  70.06426 </code></pre>
</div>
</div>
<p>Users can use the <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code> function to calculate most object measurements in a single call.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_rows_cols.html">round_cols</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>                            1        3       12      24
id                       1.00     2.00     3.00    4.00
x                      534.76   275.03   593.92  613.97
y                      164.70   220.22   375.49  509.49
area                 22619.50 46388.50 11087.00 1768.00
area_ch              23834.00 46946.50 12775.00 1818.00
perimeter              669.54   896.68   514.53  175.51
radius_mean             88.76   124.90    62.68   24.21
radius_min              63.58    88.99    39.17   16.47
radius_max             134.20   185.50    98.89   36.26
radius_sd               17.40    27.19    15.27    5.73
radius_ratio             2.11     2.08     2.52    2.20
diam_mean              177.51   249.81   125.36   48.42
diam_min               127.16   177.99    78.34   32.94
diam_max               268.39   370.99   197.79   72.51
caliper                254.57   352.75   173.30   70.06
length                 254.54   352.64   170.35   70.06
width                  139.27   186.10   126.75   35.31
solidity                 0.95     0.99     0.87    0.97
convexity                0.85     0.91     0.83    0.89
elongation               0.45     0.47     0.26    0.50
circularity             19.82    17.33    23.88   17.42
circularity_haralick     3.65     3.27     2.57    2.87
circularity_norm         1.58     1.38     1.90    1.39
eccentricity             0.39     0.39     0.54    0.38</code></pre>
</div>
</div>
<p>If the image resolution is known, the measurements can be corrected with <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">dpi()</a></code> the resolution can be obtained. In this case, the dpi is ~50.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">color_measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">measures</span>, dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   id      x      y    area area_ch perimeter radius_mean radius_min radius_max
1   1 534.76 164.70  58.373  61.507    34.013       4.509      3.230      6.817
3   2 275.03 220.22 119.712 121.152    45.551       6.345      4.521      9.423
12  3 593.92 375.49  28.612  32.968    26.138       3.184      1.990      5.024
24  4 613.97 509.49   4.563   4.692     8.916       1.230      0.837      1.842
   radius_sd radius_ratio diam_mean diam_min diam_max caliper length width
1      0.884        0.107     9.018    6.460   13.634  12.932 12.931 7.075
3      1.381        0.106    12.690    9.042   18.846  17.920 17.914 9.454
12     0.776        0.128     6.368    3.980   10.048   8.804  8.654 6.439
24     0.291        0.112     2.460    1.673    3.684   3.559  3.559 1.794
   solidity convexity elongation circularity circularity_haralick
1      0.95      0.85       0.45       19.82                 3.65
3      0.99      0.91       0.47       17.33                 3.27
12     0.87      0.83       0.26       23.88                 2.57
24     0.97      0.89       0.50       17.42                 2.87
   circularity_norm eccentricity
1              1.58         0.39
3              1.38         0.39
12             1.90         0.54
24             1.39         0.38</code></pre>
</div>
</div>
<p>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <code>pliman</code>. Just for simplicity, I’ll just use object 2.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[[</span><span class="st">"3"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="rotate-polygons" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="rotate-polygons">
<span class="header-section-number">2.6</span> Rotate polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate()</a></code> can be used to rotate the polygon coordinates by an <code>angle</code> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate</a></span><span class="op">(</span><span class="va">o2</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="384"></p>
</div>
</div>
</section><section id="invert-polygons" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="invert-polygons">
<span class="header-section-number">2.7</span> Invert polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y()</a></code> can be used to flip shapes along the x and y axis, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flipped</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span>, </span>
<span>       fy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">flipped</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section><section id="perimeter-sampling" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="perimeter-sampling">
<span class="header-section-number">2.8</span> Perimeter sampling</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample()</a></code> samples <code>n</code> coordinates between existing points, and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop()</a></code> samples a proportion of coordinates between existing ones.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 50 coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample</a></span><span class="op">(</span><span class="va">o2</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="384"></p>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 10% of coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="384"></p>
</div>
</div>
</section><section id="smoothing" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="smoothing">
<span class="header-section-number">2.9</span> smoothing</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth()</a></code> smooths the contour of a polygon by combining <code>prop</code> coordinate point samples and interpolating them using <code>vertices</code> vertices(default is 1000) .</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> original <span class="op">=</span> <span class="va">o2</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.04</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">smoothed</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section><section id="noises" class="level2" data-number="2.10"><h2 data-number="2.10" class="anchored" data-anchor-id="noises">
<span class="header-section-number">2.10</span> Noises</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter()</a></code> adds a small amount of noise to a set of coordinates. See <code><a href="https://rdrr.io/r/base/jitter.html">base::jitter()</a></code> for more details.</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter</a></span><span class="op">(</span>noise_x <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              noise_y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section></section><section id="analyzing-objects" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Analyzing objects</h1>
<p>The functions seen so far can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. Let’s start with a simple example, using the <code>object_300dpi.png</code> image available on <a href="https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images">GitHub page</a>. To facilitate importing images from this folder, an <code><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman()</a></code> helper function is used.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span><span class="co">## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4</span></span>
<span><span class="co">## ✔ tibble  3.1.7     ✔ dplyr   1.0.9</span></span>
<span><span class="co">## ✔ tidyr   1.2.0     ✔ stringr 1.4.0</span></span>
<span><span class="co">## ✔ readr   2.1.2     ✔ forcats 0.5.1</span></span>
<span><span class="co">## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## ✖ forcats::%&gt;%()               masks stringr::%&gt;%(), dplyr::%&gt;%(), purrr::%&gt;%(), tidyr::%&gt;%(), tibble::%&gt;%(), pliman::%&gt;%()</span></span>
<span><span class="co">## ✖ tibble::column_to_rownames() masks pliman::column_to_rownames()</span></span>
<span><span class="co">## ✖ dplyr::filter()              masks stats::filter()</span></span>
<span><span class="co">## ✖ dplyr::lag()                 masks stats::lag()</span></span>
<span><span class="co">## ✖ tibble::remove_rownames()    masks pliman::remove_rownames()</span></span>
<span><span class="co">## ✖ tibble::rownames_to_column() masks pliman::rownames_to_column()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"objects_300dpi.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</p>
<ul>
<li>Larger square: 10 x 10 cm (100 cm<span class="math inline">\(^2\)</span>)</li>
<li>Smaller square: 5 x 5 cm(25 cm<span class="math inline">\(^2\)</span>)</li>
<li>Rectangle: 4 x 2 cm(8 cm<span class="math inline">\(^2\)</span>)</li>
<li>Circle: 3 cm in diameter(~7.07 cm<span class="math inline">\(^2\)</span>)</li>
</ul>
<p>To count the objects in the image we use <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> and inform the image(the only required argument). By default, the <code>NB</code> index is used for object segmentation.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<section id="adjusting-object-measurements" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="adjusting-object-measurements">
<span class="header-section-number">3.1</span> Adjusting object measurements</h2>
<p>The results were stored in <code>img_res</code>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm<span class="math inline">\(^2\)</span>, only in pixels. In this case, we use <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code> to adjust pixel measurements to metric units.</p>
<p>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area and radius will be adjusted by the dpi informed.</p>
<section id="declaring-a-known-value" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="declaring-a-known-value">
<span class="header-section-number">3.1.1</span> Declaring a known value</h3>
<p>Since we know the area of the larger square (object 1), let’s adjust the area of the other objects in the image using this.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             <span class="va">area</span> <span class="op">~</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>-----------------------------------------
measures corrected with:
object id: 1
area     : 100
-----------------------------------------
Total    : 40.009 
Average  : 13.336 
-----------------------------------------</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>  id        x        y   area area_ch perimeter radius_mean radius_min
2  2 1737.518  452.998 25.041  24.958    19.983       2.866      2.492
3  3 1737.571 1296.354  7.019   7.022    10.093       1.491      1.479
4  4 1737.966  939.007  7.949   7.907    11.913       1.668      0.988
  radius_max radius_sd diam_mean diam_min diam_max major_axis minor_axis length
2      3.531     0.314     5.732    4.983    7.062      5.783      5.773  6.520
3      1.504     0.004     2.982    2.957    3.008      2.990      2.989  2.996
4      2.224     0.423     3.335    1.976    4.449      4.609      2.299  3.994
  width radius_ratio eccentricity  theta solidity convexity elongation
2 6.509        1.417        0.996  1.563    1.003     0.749      0.002
3 2.999        1.017        0.994 -1.547    1.000     0.905     -0.001
4 1.987        2.252        0.348  0.000    1.005     0.836      0.502
  circularity circularity_haralick circularity_norm   asm   con   cor   var
2      15.946                9.127            1.273 0.913 0.051 0.731 1.095
3      14.512              423.369            1.161 0.829 0.078 0.781 1.178
4      17.854                3.947            1.430 0.853 0.069 0.786 1.161
    idm    sav     sva   sen   ent   dva   den   f12   f13
2 0.987 21.901 475.312 0.106 0.116 0.051 0.054 0.518 0.279
3 0.975 21.821 468.297 0.196 0.220 0.078 0.090 0.523 0.380
4 0.979 21.828 470.245 0.156 0.176 0.069 0.076 0.555 0.356</code></pre>
</div>
</div>
</section><section id="declaring-the-image-resolution" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="declaring-the-image-resolution">
<span class="header-section-number">3.1.2</span> Declaring the image resolution</h3>
<p>If the image resolution is known, all measurements will be adjusted accordingly. Let’s see a numerical example with <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm()</a></code>. This function converts the number of pixels(* px *) into cm, considering the image resolution in <code>dpi</code>, as follows: <span class="math inline">\(cm = px \times(2.54 / dpi)\)</span>. As we know the number of pixels of the larger square, its perimeter in cm is given by</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span></span>
<span><span class="va">ls_px</span> <span class="op">&lt;-</span> <span class="va">img_res</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">perimeter</span> <span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm</a></span><span class="op">(</span>px <span class="op">=</span> <span class="va">ls_px</span> , dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 39.9265</code></pre>
</div>
</div>
<p>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <code>dpi</code> argument in <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span> , dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>                           1        2        3        4
id                     1.000    2.000    3.000    4.000
x                    668.995 1737.518 1737.571 1737.966
y                    797.992  452.998 1296.354  939.007
area                  99.812   24.994    7.006    7.934
area_ch               99.686   24.911    7.008    7.892
perimeter             39.926   19.964   10.083   11.902
radius_mean            5.728    2.863    1.489    1.666
radius_min             4.984    2.489    1.477    0.987
radius_max             7.057    3.528    1.502    2.222
radius_sd              0.629    0.314    0.004    0.422
diam_mean             11.456    5.726    2.979    3.332
diam_min               9.967    4.978    2.955    1.974
diam_max              14.114    7.055    3.005    4.445
major_axis            11.546    5.778    2.987    4.604
minor_axis            11.526    5.768    2.986    2.297
length                11.121    6.514    2.994    3.990
width                 11.107    6.503    2.996    1.985
radius_ratio           1.416    1.417    1.017    2.252
eccentricity           0.997    0.996    0.994    0.348
theta                 -0.007    1.563   -1.547    0.000
solidity               1.001    1.003    1.000    1.005
convexity              0.750    0.749    0.905    0.836
elongation             0.001    0.002   -0.001    0.502
circularity           15.971   15.946   14.512   17.854
circularity_haralick   9.111    9.127  423.369    3.947
circularity_norm       1.273    1.273    1.161    1.430
asm                    0.949    0.913    0.829    0.853
con                    0.016    0.051    0.078    0.069
cor                    0.797    0.731    0.781    0.786
var                    1.040    1.095    1.178    1.161
idm                    0.995    0.987    0.975    0.979
sav                   21.946   21.901   21.821   21.828
sva                  478.992  475.312  468.297  470.245
sen                    0.063    0.106    0.196    0.156
ent                    0.069    0.116    0.220    0.176
dva                    0.016    0.051    0.078    0.069
den                    0.024    0.054    0.090    0.076
f12                    0.674    0.518    0.523    0.555
f13                    0.260    0.279    0.380    0.356</code></pre>
</div>
</div>
</section><section id="understanding-measurements" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="understanding-measurements">
<span class="header-section-number">3.1.3</span> Understanding measurements</h3>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># get the contour of objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># computes center of mass and minimum and maximum radii</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot the measurements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Larger square:</li>
<li>The minimum diameter(a = 9.97) can be considered as the side of the square</li>
<li>The maximum diameter, given by <span class="math inline">\(a \sqrt {2}\)</span> can be considered the diagonal of the square (<span class="math inline">\(9.97 \sqrt {2} = 14,099 \approx 14,105\)</span>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>                           1        2        3        4
id                     1.000    2.000    3.000    4.000
x                    668.995 1737.518 1737.571 1737.966
y                    797.992  452.998 1296.354  939.007
area                  99.812   24.994    7.006    7.934
area_ch               99.686   24.911    7.008    7.892
perimeter             39.926   19.964   10.083   11.902
radius_mean            5.728    2.863    1.489    1.666
radius_min             4.984    2.489    1.477    0.987
radius_max             7.057    3.528    1.502    2.222
radius_sd              0.629    0.314    0.004    0.422
diam_mean             11.456    5.726    2.979    3.332
diam_min               9.967    4.978    2.955    1.974
diam_max              14.114    7.055    3.005    4.445
major_axis            11.546    5.778    2.987    4.604
minor_axis            11.526    5.768    2.986    2.297
length                11.121    6.514    2.994    3.990
width                 11.107    6.503    2.996    1.985
radius_ratio           1.416    1.417    1.017    2.252
eccentricity           0.997    0.996    0.994    0.348
theta                 -0.007    1.563   -1.547    0.000
solidity               1.001    1.003    1.000    1.005
convexity              0.750    0.749    0.905    0.836
elongation             0.001    0.002   -0.001    0.502
circularity           15.971   15.946   14.512   17.854
circularity_haralick   9.111    9.127  423.369    3.947
circularity_norm       1.273    1.273    1.161    1.430
asm                    0.949    0.913    0.829    0.853
con                    0.016    0.051    0.078    0.069
cor                    0.797    0.731    0.781    0.786
var                    1.040    1.095    1.178    1.161
idm                    0.995    0.987    0.975    0.979
sav                   21.946   21.901   21.821   21.828
sva                  478.992  475.312  468.297  470.245
sen                    0.063    0.106    0.196    0.156
ent                    0.069    0.116    0.220    0.176
dva                    0.016    0.051    0.078    0.069
den                    0.024    0.054    0.090    0.076
f12                    0.674    0.518    0.523    0.555
f13                    0.260    0.279    0.380    0.356</code></pre>
</div>
</div>
</section></section><section id="texture-features" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="texture-features">
<span class="header-section-number">3.2</span> Texture features</h2>
<p>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al.&nbsp;1979)<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Haralick features depend on the configuration of the parameters <code>har_nbins</code> and <code>har_scales</code>. <code>har_nbins</code> controls the number of bins used to compute the Haralick matrix. A smaller <code>har_nbins</code> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <code>har_scales</code> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To chance this default, use the argument <code>har_band</code>. For example, <code>har_band = 2</code> will compute the features with the green band.</p>
<p>The followig measures are returned (fore more details, see <a href="https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html">this post</a>)</p>
<ul>
<li>
<code>asm</code>: The angular second-moment feature.</li>
<li>
<code>con</code>: The contrast feature</li>
<li>
<code>cor</code>: Correlation measures the linear dependency of gray levels of neighboring pixels.</li>
<li>
<code>var</code>: The variance of gray levels pixels.</li>
<li>
<code>idm</code>: The Inverse Difference Moment (IDM), i.e., the local homogeneity.</li>
<li>
<code>sav</code>: The Sum Average.</li>
<li>
<code>sva</code>: The Sum Variance.</li>
<li>
<code>sen</code>: Sum Entropy.</li>
<li>
<code>dva</code>: Difference Variance.</li>
<li>
<code>den</code>: Difference Entropy</li>
<li>
<code>f12</code>: Difference Variance.</li>
<li>
<code>f13</code>: The angular second-moment feature.</li>
</ul></section><section id="single-image-processing" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="single-image-processing">
<span class="header-section-number">3.3</span> Single image processing</h2>
<p>The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves_meas</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leaves_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">leaves_meas</span> , dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">leaves_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>                            1       2
id                      1.000   2.000
x                     528.542 234.020
y                     299.984 825.798
area                    5.862   3.879
area_ch                 5.946   4.227
perimeter              12.157   9.942
radius_mean             1.591   1.145
radius_min              0.735   0.838
radius_max              2.683   1.677
radius_sd               0.582   0.219
diam_mean               3.181   2.290
diam_min                1.470   1.675
diam_max                5.366   3.353
major_axis              4.843   2.864
minor_axis              1.563   1.744
length                  5.241   3.210
width                   1.602   1.883
radius_ratio            3.650   2.002
eccentricity            0.136   0.425
theta                  -1.057  -0.087
solidity                0.986   0.918
convexity               0.913   0.791
elongation              0.694   0.413
circularity            25.209  25.478
circularity_haralick    2.735   5.219
circularity_norm        2.021   2.047
asm                     0.044   0.172
con                     1.120   0.495
cor                     0.942   0.814
var                    10.687   2.328
idm                     0.778   0.814
sav                    38.905  28.391
sva                  1449.029 763.014
sen                     1.337   0.856
ent                     1.573   1.002
dva                     1.120   0.495
den                     0.407   0.328
f12                     0.526   0.352
f13                     0.822   0.590</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot width and length</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"width"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"length"</span>, vjust <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, we will count the grains in the <code>grains.jpg</code> image. This image has a cyan background and contains 90 soybeans that touch each other. The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function segments the image using the normalized blue index by default, as follows <span class="math inline">\(NB =(B /(R + G + B))\)</span>, where <em>R</em>, <em>G</em> and <em>B </em> are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <code>img</code> argument(e.g., <code>img = "grains"</code>).</p>
<p>In this example, objects are counted and segmented objects are colored with random colors using the <code>show_segmentation = TRUE</code> argument. Users can set <code>show_contour = FALSE</code> to remove the contour line and identify the objects (in this example, the grains) using the <code>marker = "id"</code> arguments. The background color can also be changed with <code>col_background</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span><span class="op">$</span><span class="va">statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>       stat       value
1         n    90.00000
2  min_area   446.00000
3 mean_area   675.45556
4  max_area   842.00000
5   sd_area    71.65494
6  sum_area 60791.00000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the measurements of the object</span></span>
<span><span class="va">measurements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">measurements</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  id       x       y area area_ch perimeter radius_mean radius_min radius_max
1  1 351.890 411.183  842     810   104.497      15.911     14.847     16.897
2  2 824.970 264.736  822     801   107.083      15.740     13.563     17.782
3  3 811.263 198.825  738     712    98.497      14.876     14.129     15.379
4  4 710.004 262.800  761     733   100.255      15.112     12.886     17.048
5  5 807.122 341.979  757     724    98.841      15.072     13.745     16.714
6  6 818.892 714.864  742     714    98.841      14.906     13.775     16.272
  radius_sd diam_mean diam_min diam_max major_axis minor_axis length  width
1     0.465    31.822   29.695   33.793     33.506     32.027 33.480 32.195
2     1.201    31.480   27.126   35.565     35.775     29.288 35.413 29.731
3     0.309    29.752   28.258   30.759     30.739     30.581 30.445 30.323
4     1.175    30.224   25.773   34.097     34.365     28.228 33.818 27.708
5     0.771    30.144   27.489   33.428     33.056     29.186 33.005 29.399
6     0.635    29.812   27.550   32.543     32.191     29.373 31.766 29.094
  radius_ratio eccentricity  theta solidity convexity elongation circularity
1        1.138        0.938  1.224    1.040     0.936      0.038      12.969
2        1.311        0.742 -0.327    1.026     0.923      0.160      13.950
3        1.088        0.975 -1.283    1.037     0.904      0.004      13.146
4        1.323        0.749 -0.261    1.038     0.882      0.181      13.208
5        1.216        0.812  0.544    1.046     0.867      0.109      12.906
6        1.181        0.864 -1.197    1.039     0.886      0.084      13.166
  circularity_haralick circularity_norm   asm   con   cor   var   idm    sav
1               34.181            1.092 0.066 0.850 0.912 5.837 0.733 32.747
2               13.107            1.179 0.080 0.975 0.883 5.179 0.746 33.476
3               48.152            1.112 0.059 0.888 0.920 6.566 0.706 34.419
4               12.857            1.117 0.053 0.917 0.911 6.166 0.724 33.375
5               19.539            1.091 0.065 0.855 0.909 5.681 0.727 32.003
6               23.486            1.115 0.058 0.847 0.924 6.564 0.720 30.684
       sva   sen   ent   dva   den   f12   f13
1 1014.530 1.187 1.418 0.850 0.421 0.445 0.745
2 1061.010 1.145 1.356 0.975 0.429 0.445 0.735
3 1121.793 1.247 1.482 0.888 0.428 0.461 0.767
4 1052.364 1.241 1.478 0.917 0.429 0.456 0.763
5  967.498 1.187 1.407 0.855 0.416 0.447 0.745
6  889.380 1.223 1.446 0.847 0.419 0.465 0.764</code></pre>
</div>
</div>
<p>In the following example, we will select objects with an area above the average of all objects using <code>lower_size = 719.1</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                lower_size <span class="op">=</span> <span class="fl">719.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Users can also use the <code>topn _*</code> arguments to select the <code>n</code> objects based on the smallest or largest areas. Let’s see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <code>my_index</code> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <code>my_index = "B /(R + G + B)"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_lower <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                col_background <span class="op">=</span> <span class="st">"salmon"</span>,</span>
<span>                my_index <span class="op">=</span> <span class="st">"B /(R + G + B)"</span><span class="op">)</span> <span class="co"># normalized blue(NB)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section><section id="batch-processing" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="batch-processing">
<span class="header-section-number">3.4</span> Batch processing</h2>
<p>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in indirect selection of high-yielding plants. In <code>pliman</code>, batch processing can be done when the user declares the <code>pattern</code> argument.</p>
<p>To speed up processing time, especially for large numbers of images, the <code>parallel = TRUE</code> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <code>R</code> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <code>workers</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Processing image img_sb_50_1 |===                                | 8% 00:00:00 
Processing image img_sb_50_10 |=====                             | 15% 00:00:01 
Processing image img_sb_50_11 |========                          | 23% 00:00:01 
Processing image img_sb_50_12 |==========                        | 31% 00:00:02 
Processing image img_sb_50_13 |=============                     | 38% 00:00:02 
Processing image img_sb_50_2 |================                   | 46% 00:00:03 
Processing image img_sb_50_3 |===================                | 54% 00:00:04 
Processing image img_sb_50_4 |======================             | 62% 00:00:05 
Processing image img_sb_50_5 |========================           | 69% 00:00:07 
Processing image img_sb_50_6 |===========================        | 77% 00:00:08 
Processing image img_sb_50_7 |==============================     | 85% 00:00:09 
Processing image img_sb_50_8 |================================   | 92% 00:00:10 
Processing image img_sb_50_9 |===================================| 100% 00:00:11 
--------------------------------------------
        Image Objects
  img_sb_50_1     100
 img_sb_50_10      29
 img_sb_50_11      23
 img_sb_50_12      15
 img_sb_50_13       7
  img_sb_50_2      90
  img_sb_50_3      83
  img_sb_50_4      75
  img_sb_50_5      70
  img_sb_50_6      60
  img_sb_50_7      57
  img_sb_50_8      48
  img_sb_50_9      36
--------------------------------------------</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
    11.00      0.61     11.69 </code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># parallel processing</span></span>
<span><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>,</span>
<span>                    show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>--------------------------------------------
        Image Objects
  img_sb_50_1     100
 img_sb_50_10      29
 img_sb_50_11      23
 img_sb_50_12      15
 img_sb_50_13       7
  img_sb_50_2      90
  img_sb_50_3      83
  img_sb_50_4      75
  img_sb_50_5      70
  img_sb_50_6      60
  img_sb_50_7      57
  img_sb_50_8      48
  img_sb_50_9      36
--------------------------------------------</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     0.13      0.03      6.49 </code></pre>
</div>
</div>
</section></section><section id="object-coordinates" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Object coordinates</h1>
<p>Users can get the coordinates for all desired objects with <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord()</a></code>. When the <code>id</code> argument is set to <code>NULL</code> (default), a bounding rectangle is drawn including all objects. Use <code>id = "all"</code> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <code>watershed = FALSE</code> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the id of each object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_id</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>$col_min
[1] 49

$col_max
[1] 937

$row_min
[1] 40

$row_max
[1] 702</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get coordinates for all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>$col_min
[1]  49 710

$col_max
[1] 603 937

$row_min
[1] 379  40

$row_max
[1] 702 425</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span><span class="co"># 20 border pixels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             edge <span class="op">=</span> <span class="fl">20</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>$col_min
[1] 31

$col_max
[1] 621

$row_min
[1] 361

$row_max
[1] 720</code></pre>
</div>
</div>
</section><section id="isolating-objects" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Isolating objects</h1>
<p>Knowing the coordinates of each object, it is possible to isolate it. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate()</a></code> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 edge <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">id1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/object3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="including-objects-in-a-list" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Including objects in a list</h1>
<p><code><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split()</a></code> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>==============================
Summary of the procedure
==============================
Number of objects: 2 
Average area     : 67935 
Minimum area     : 54096 
Maximum area     : 81774 
Objects created  : 2 
==============================</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>List of 2
 $ 1:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:330, 1:561, 1:3] 1 1 1 1 1 1 1 1 1 1 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 330 561 3
 $ 2:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:390, 1:234, 1:3] 1 1 1 1 1 1 1 1 1 1 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 390 234 3</code></pre>
</div>
</div>
</section><section id="rgb-values-for-each-object" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> RGB values for each object</h1>
<p>To get the RGB intensity of each object in the image, we use the <code>object_rgb = TRUE</code> argument in the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. In the following example, we will use the R, G and B bands and their normalized values. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes()</a></code> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g.&nbsp;<code>object_index = "B/G+R"</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"green.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">indx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code> [1] "R"     "G"     "B"     "NR"    "NG"    "NB"    "GB"    "RB"    "GR"   
[10] "BI"    "BIM"   "SCI"   "GLI"   "HI"    "NGRDI" "NDGBI" "NDRBI" "I"    
[19] "S"     "VARI"  "HUE"   "HUE2"  "BGI"   "L"     "GRAY"  "GLAI"  "SAT"  
[28] "CI"    "SHP"   "RI"   </code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soy_green</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span> ,</span>
<span>                  object_index <span class="op">=</span> <span class="va">indx</span> <span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="co"># R:NB</span></span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-2.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PCA with the indices</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">soy_green</span>, type <span class="op">=</span><span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-3.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The <code>R</code> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="768"></p>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Now, let’s plot the <code>R</code> index on each object</p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">soy_green</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" black "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It seems that grains with average red (<code>R</code>) value less than 0.6 can be considered greenish seeds. Users can then work with this feature and adapt it to their case.</p>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">soy_green</span> ,</span>
<span>                index <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>                cut_point <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">report</span><span class="op">$</span><span class="va">ids</span></span>
<span><span class="va">report</span><span class="op">$</span><span class="va">between_id</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   n nsel prop mean_index_sel mean_index_nsel
1 50    5  0.1      0.5453667       0.7062646</code></pre>
</div>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span><span class="op">[</span><span class="va">ids</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   id        x        y n_less n_greater less_ratio greater_ratio
29 29 520.4530 364.3528   2720       163      0.943         0.057
45 45 282.2126 502.3140   1165       848      0.579         0.421
46 46 732.0210 638.1693   1575       380      0.806         0.194
48 48 207.0810 808.0929    841       936      0.473         0.527
50 50 511.4567 808.5150   2387        15      0.994         0.006</code></pre>
</div>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ratio of pixels of each object(above and below 0.6)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span> <span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R &lt; 0.6"</span>, <span class="st">"R &gt; 0.6"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>In the following graph, I plot the distribution of the greenish and non-greenish R, G, and B values.</p>
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># distribution of RGB values</span></span>
<span><span class="va">rgbs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">soy_green</span><span class="op">$</span><span class="va">object_rgb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span>, <span class="st">" Greenish "</span>, <span class="st">" No greenish "</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">rgbs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">type</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, using the ids of each grain, I plot the values only in the greenish ones.</p>
<div class="cell">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">soy_green</span> ,</span>
<span>              id <span class="op">=</span> <span class="va">ids</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span> , show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">cont</span>,</span>
<span>             id <span class="op">=</span> <span class="va">ids</span>,</span>
<span>             col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When there are many objects, the <code>parallel = TRUE</code> argument will speed up extracting the RGB values. In the following example, an image with 1343 grains of <em>Vicia cracca</em> is analyzed. The indices <code>"R"</code> and <code>"R/G"</code> are computed. Grains with an average red value greater than 0.25 are highlighted.</p>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"vicia.jpg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vicia</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img2</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                  object_index <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_index</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">vicia</span> ,</span>
<span>                index <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>                cut_point <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                select_higher <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">count2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img2</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ids2</span> <span class="op">&lt;-</span> <span class="va">summary_index</span><span class="op">$</span><span class="va">ids</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">count2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="leaf-area" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Leaf area</h1>
<section id="known-resolution" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="known-resolution">
<span class="header-section-number">8.1</span> Known resolution</h2>
<div class="cell">
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>image <span class="op">=</span> <span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">af_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">af</span>, dpi <span class="op">=</span> <span class="fl">50.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" red "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="reference-object-dev-version" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="reference-object-dev-version">
<span class="header-section-number">8.2</span> Reference object (dev version)</h2>
<p>The <code>reference</code> argument can now be used to correct the object measures even when images with different shooting distances are used. In this example, the leaf area of the <code>ref_leaves</code> image is quantified and corrected considering a 5 x 5 (25 cm<span class="math inline">\(^2\)</span>) white square as the reference object. For this, it is necessary to provide color palettes referring to the background (<code>background</code>), leaves (<code>foreground</code>) and the reference object (<code>reference</code>). Also, the area of the reference object needs to be informed in <code>reference_area</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"ref_"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">area</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>img <span class="op">=</span> <span class="st">"ref_leaves"</span>,</span>
<span>                  foreground <span class="op">=</span> <span class="st">"ref_folha"</span>,</span>
<span>                  background <span class="op">=</span> <span class="st">"ref_back"</span>,</span>
<span>                  reference <span class="op">=</span> <span class="st">"ref_ref"</span>,</span>
<span>                  reference_area <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="filling-holes" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="filling-holes">
<span class="header-section-number">8.3</span> Filling ‘holes’</h2>
<p>An important aspect to consider in leaf area measures is when leaves present ‘holes’. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</p>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"holes.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>In this case, the missing area will not be computed using the default settings of <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>. To include this area as the leaf area, we can use the argument <code>fill_hull()</code>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</p>
<div class="cell">
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fill the missing area</span></span>
<span><span class="va">af2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  fill_hull <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  prefix <span class="op">=</span> <span class="st">"proc2_"</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"proc"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can simply use the ratio between <code>proc_img</code> and <code>proc_img2</code> to compute the injured area in this leaflet.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># percent of injuried area</span></span>
<span><span class="fl">100</span> <span class="op">-</span> <span class="fl">88379</span> <span class="op">/</span> <span class="fl">99189</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 10.89839</code></pre>
</div>
</div>
</section><section id="compound-leaves" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="compound-leaves">
<span class="header-section-number">8.4</span> Compound leaves</h2>
<p>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</p>
<p>The following images by <a href="https://www.florestaombrofilamista.com.br/sidol/?menu=contact">Daniel Saueressig</a> were obtained from the <em>Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista</em><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> and show examples of simple and compound leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imgs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span><span class="op">)</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc1-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm<span class="math inline">\(^2\)</span>. With this information, it is possible to obtain the image resolution with <code>dpi(simple)</code>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simple</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">simple.jpg</span></span>
<span><span class="va">sarea</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <code>object_size = "large"</code> or <code>watershed = FALSE</code>, to omit the watershed segmentation algorithm. The last is used here.</p>
<div class="cell">
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">sarea</span>, dpi <span class="op">=</span> <span class="fl">48.65</span><span class="op">)</span></span>
<span><span class="va">sarea_cor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  id       x       y   area area_ch perimeter radius_mean radius_min radius_max
1  1 184.643 156.157 41.417  56.267    41.308       4.285      1.070      7.953
2  2  68.637 151.759 20.035  31.852    31.560       3.030      1.095      5.717
  radius_sd diam_mean diam_min diam_max major_axis minor_axis length width
1     1.801      8.57    2.139   15.906     13.661      4.225 15.474 6.041
2     1.215      6.06    2.190   11.433      9.237      3.194 11.068 4.698
  radius_ratio eccentricity theta solidity convexity elongation circularity
1        7.435        0.133 1.489    0.736     0.685      0.610      41.200
2        5.220        0.147 1.552    0.629     0.638      0.576      49.715
  circularity_haralick circularity_norm   asm   con   cor    var   idm    sav
1                2.379            3.356 0.043 1.671 0.845  6.401 0.663 23.134
2                2.493            4.106 0.048 3.761 0.811 10.970 0.647 22.952
     sva   sen   ent   dva   den   f12   f13
1 499.01 1.246 1.618 1.671 0.516 0.319 0.677
2 507.26 1.246 1.663 3.761 0.603 0.287 0.654</code></pre>
</div>
</div>
<p>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">compound</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">compound.jpg</span></span>
<span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Therefore, using <code>watershed = FALSE</code> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">carea</span>, dpi <span class="op">=</span> <span class="fl">49.5</span><span class="op">)</span></span>
<span><span class="va">carea_cor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  id       x       y   area area_ch perimeter radius_mean radius_min radius_max
2  1 114.593  91.213 15.890  33.168    48.779       2.254      0.018      4.964
3  2 113.124 244.782 18.895  43.161    54.501       2.548      0.056      5.940
  radius_sd diam_mean diam_min diam_max major_axis minor_axis length width
2     1.148     4.509    0.035    9.929      6.954      5.552  8.135 6.435
3     1.260     5.097    0.112   11.879      8.404      6.577  9.339 7.142
  radius_ratio eccentricity  theta solidity convexity elongation circularity
2      280.481        0.506 -0.263    0.479     0.425      0.209     149.739
3      105.791        0.656  0.709    0.438     0.479      0.235     157.203
  circularity_haralick circularity_norm   asm   con   cor   var   idm    sav
2                1.964           12.783 0.047 2.223 0.753 5.507 0.666 27.342
3                2.023           13.363 0.054 1.100 0.838 4.386 0.711 18.751
      sva   sen   ent   dva   den   f12   f13
2 700.322 1.179 1.559 2.223 0.543 0.279 0.630
3 322.551 1.141 1.448 1.100 0.456 0.328 0.658</code></pre>
</div>
</div>
</section><section id="multiple-images-of-the-same-sample" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="multiple-images-of-the-same-sample">
<span class="header-section-number">8.5</span> Multiple images of the same sample</h2>
<p>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<code>-</code>) or underscore (<code>_</code>). Then, when using <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>, measurements from leaf images called, for example, <code>F1-1.jpeg</code>, <code>F1_2.jpeg</code> and <code>F1-3.jpeg</code> will be combined into a single image (<code>F1</code>), displayed in the <code>merge</code> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</p>
<p>In the following example, five images will be used as examples. Each image has leaves of different species. The images have been split into different images that share the same prefix (eg L1_*, L2_*, and so on). Note that to ensure that all images are processed, all images must share a common pattern, in this case (<code>"L"</code>). The three dots in the lower right corner have a known distance of 5 cm between them, which can be used to extract the dpi of the image with <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">dpi()</a></code>. For teaching purposes only, I will assume that all images are 100 dpi resolution .</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># entire images</span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"leaf"</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge0-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># images of the same sample</span></span>
<span><span class="va">sample_imgs</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"L"</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge0-2.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Here, I will use the <code>pattern = "L"</code> to indicate that all images with this pattern name should be merged. The green index (<code>"G"</code>) is used to segment the leaves and <code>watershed = FALSE</code> is used to omit the watershed segmentation algorithm.</p>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"L"</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Processing image L1_1 |====                                      | 8% 00:00:00 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L1_2 |=======                                   | 17% 00:00:00 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L2_1 |==========                                | 25% 00:00:00 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L2_2 |==============                            | 33% 00:00:01 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L3_1 |==================                        | 42% 00:00:01 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L3_2 |=====================                     | 50% 00:00:02 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L3_3 |========================                  | 58% 00:00:02 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L4_1 |============================              | 67% 00:00:02 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L4_2 |================================          | 75% 00:00:03 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L4_3 |===================================       | 83% 00:00:03 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L5_1 |======================================    | 92% 00:00:04 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-stdout">
<pre><code>Processing image L5_2 |==========================================| 100% 00:00:04 </code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>--------------------------------------------
 Image Objects
  L1_1       1
  L1_2       1
  L2_1       2
  L2_2       3
  L3_1       1
  L3_2       1
  L3_3       1
  L4_1       2
  L4_2       2
  L4_3       3
  L5_1       3
  L5_2       3
--------------------------------------------</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge1-12.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using the <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code> function it is possible to convert measurements from pixel units to metric units(cm<span class="math inline">\(^ 2\)</span>).</p>
<div class="cell">
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">merged</span>, dpi <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the merged_cor` is a list with three objects:</p>
<ul>
<li>
<code>results</code>: a data frame that contains the measurements of each individual object (in this case, leaf) of each analyzed image.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged_cor</span><span class="op">$</span><span class="va">results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>    img id       x       y    area area_ch perimeter radius_mean radius_min
1  L1_1  1 427.651 516.720 102.091   7.427   133.758       6.213      0.565
2  L1_2  1 372.493 526.103  92.764   5.262   124.363       5.335      1.048
3  L2_1  1 251.395 282.805  46.317   1.188    28.464       3.937      2.525
4  L2_1  2 146.358 701.888  35.300   0.918    25.697       3.441      2.314
5  L2_2  1 326.111 391.144  19.027   0.488    19.495       2.614      1.660
6  L2_2  2 113.863 755.333  38.151   0.983    25.176       3.535      2.517
7  L2_2  3 376.185 784.765  16.317   0.418    17.262       2.367      1.530
8  L3_1  1 253.948 480.245  64.030   2.994    92.378       4.204      0.408
9  L3_2  1 200.085 436.480  30.204   1.462    63.319       2.829      0.065
10 L3_3  1 204.972 363.480  51.966   2.219    93.421       3.495      0.073
11 L4_1  1 270.224 326.531  54.353   1.392    29.454       4.181      3.401
12 L4_1  3 252.939 845.147  61.670   1.626    34.277       4.536      3.678
13 L4_2  1 291.918 235.531  61.482   1.597    33.038       4.544      3.158
14 L4_2  2 260.741 799.763  73.238   1.915    36.282       4.938      3.761
15 L4_3  1 206.165 213.369  29.187   0.752    22.372       3.097      2.053
16 L4_3  2 219.504 552.867  19.512   0.520    19.495       2.598      1.609
17 L4_3  3 229.146 937.131  34.152   0.900    27.177       3.471      2.211
18 L5_1  1 225.324 275.743  52.788   1.383    35.509       4.591      2.262
19 L5_1  2 120.375 887.851  30.186   0.821    30.527       3.827      1.648
20 L5_1  3 335.521 884.863  31.673   0.828    28.115       3.621      1.731
21 L5_2  1 338.958 300.167  45.584   1.189    34.031       4.329      2.190
22 L5_2  2 205.349 802.627  42.838   1.114    33.268       4.266      2.049
23 L5_2  3 535.296 819.587  44.986   1.175    33.299       4.300      1.992
   radius_max radius_sd diam_mean diam_min diam_max major_axis minor_axis
1      11.927     2.899    12.426    1.130   23.853     19.865     15.143
2      10.164     2.189    10.669    2.096   20.327     15.129     13.217
3       5.915     0.911     7.873    5.049   11.830     10.478      5.708
4       5.204     0.819     6.882    4.627   10.408      9.307      4.873
5       4.134     0.736     5.227    3.320    8.268      7.300      3.375
6       5.093     0.665     7.070    5.035   10.185      8.955      5.462
7       3.609     0.606     4.734    3.060    7.219      6.510      3.237
8       9.466     2.050     8.407    0.817   18.932     15.228      8.684
9       6.578     1.425     5.658    0.130   13.155      9.857      7.103
10      7.816     1.656     6.990    0.146   15.632     12.405      8.416
11      5.708     0.559     8.362    6.803   11.415      9.917      7.035
12      6.506     0.705     9.071    7.356   13.012     10.548      7.549
13      6.585     0.821     9.088    6.316   13.170     10.968      7.277
14      6.971     0.780     9.875    7.521   13.941     11.609      8.148
15      4.379     0.668     6.195    4.107    8.758      8.257      4.534
16      3.939     0.648     5.196    3.218    7.879      7.069      3.549
17      5.147     0.799     6.943    4.422   10.294      8.810      5.089
18      7.740     1.623     9.182    4.523   15.481     13.610      5.029
19      6.794     1.523     7.654    3.297   13.589     11.055      3.579
20      6.200     1.321     7.241    3.463   12.399     10.717      3.823
21      7.462     1.610     8.659    4.379   14.925     13.162      4.461
22      7.335     1.584     8.533    4.098   14.670     12.765      4.353
23      7.465     1.584     8.600    3.983   14.930     13.069      4.449
   length   width radius_ratio eccentricity  theta solidity convexity
1  21.589 722.973       21.109        0.638  0.158    0.349     0.402
2  16.895 579.711        9.696        0.805  0.600    0.448     0.387
3  11.347 234.524        2.343        0.390  1.502    0.990     0.928
4  10.313 198.853        2.249        0.371 -1.533    0.977     0.908
5   8.154 140.030        2.491        0.272  1.560    0.990     0.911
6   9.780 222.355        2.023        0.475  1.556    0.986     0.915
7   7.151 137.698        2.359        0.325  1.395    0.992     0.928
8  15.717 391.913       23.182        0.369 -1.550    0.543     0.384
9  10.814 323.238      101.214        0.511  1.564    0.525     0.395
10 13.411 365.216      107.425        0.467  1.539    0.595     0.385
11 10.444 285.934        1.678        0.610  1.484    0.992     0.903
12 11.942 313.755        1.769        0.552  1.428    0.964     0.871
13 12.132 297.157        2.085        0.473 -1.332    0.978     0.907
14 12.743 326.311        1.854        0.520  1.527    0.971     0.842
15  8.531 181.471        2.133        0.411 -1.535    0.986     0.895
16  7.552 145.609        2.448        0.322  1.537    0.954     0.868
17  9.491 210.669        2.328        0.344  1.471    0.964     0.845
18 15.329 204.320        3.423        0.174 -1.479    0.970     0.888
19 13.489 149.278        4.122        0.109 -1.564    0.934     0.917
20 12.264 159.481        3.581        0.156  1.382    0.971     0.901
21 14.760 183.121        3.408        0.152 -1.547    0.974     0.894
22 14.614 179.397        3.580        0.144  1.508    0.976     0.912
23 14.488 185.910        3.748        0.155 -1.450    0.973     0.916
   elongation circularity circularity_haralick circularity_norm   asm   con
1       0.149     175.249                2.143           14.149 0.169 0.302
2       0.128     166.727                2.437           13.463 0.189 0.347
3       0.475      17.492                4.320            1.401 0.168 0.244
4       0.510      18.706                4.199            1.500 0.255 0.168
5       0.564      19.975                3.549            1.608 0.177 0.172
6       0.423      16.613                5.318            1.331 0.200 0.189
7       0.511      18.263                3.907            1.470 0.212 0.224
8       0.367     133.276                2.051           10.649 0.262 0.238
9       0.241     132.739                1.985           10.813 0.231 0.295
10      0.308     167.949                2.111           13.621 0.399 0.204
11      0.305      15.961                7.481            1.278 0.277 0.136
12      0.333      19.052                6.431            1.525 0.366 0.113
13      0.378      17.753                5.534            1.421 0.253 0.172
14      0.350      17.974                6.327            1.438 0.300 0.162
15      0.460      17.148                4.636            1.376 0.427 0.149
16      0.510      19.478                4.010            1.567 0.380 0.164
17      0.436      21.627                4.346            1.736 0.294 0.152
18      0.661      23.886                2.829            1.915 0.267 0.184
19      0.719      30.872                2.512            2.485 0.304 0.181
20      0.670      24.957                2.741            2.006 0.378 0.165
21      0.685      25.406                2.690            2.039 0.311 0.218
22      0.688      25.836                2.694            2.074 0.393 0.228
23      0.674      24.648                2.714            1.978 0.302 0.188
     cor   var   idm    sav    sva   sen   ent   dva   den   f12   f13
1  0.912 2.707 0.896  8.593 65.679 0.902 0.995 0.302 0.247 0.590 0.752
2  0.881 2.455 0.879  7.598 50.922 0.856 0.963 0.347 0.270 0.516 0.699
3  0.922 2.557 0.899  9.682 83.240 0.892 0.977 0.244 0.236 0.593 0.749
4  0.936 2.305 0.933  7.446 49.798 0.756 0.813 0.168 0.182 0.659 0.742
5  0.946 2.596 0.922 10.430 97.784 0.861 0.920 0.172 0.197 0.663 0.774
6  0.941 2.598 0.923  7.647 52.459 0.846 0.911 0.189 0.199 0.658 0.768
7  0.888 2.003 0.905  6.667 38.384 0.785 0.858 0.224 0.223 0.561 0.699
8  0.912 2.355 0.918  5.438 27.026 0.765 0.840 0.238 0.213 0.607 0.720
9  0.898 2.442 0.891  5.250 25.212 0.807 0.903 0.295 0.252 0.525 0.689
10 0.905 2.069 0.937  3.221 11.024 0.585 0.645 0.204 0.181 0.607 0.656
11 0.913 1.784 0.938  7.577 50.688 0.671 0.718 0.136 0.168 0.641 0.701
12 0.882 1.478 0.950  7.710 52.805 0.568 0.606 0.113 0.146 0.639 0.659
13 0.907 1.923 0.929  6.449 36.264 0.727 0.787 0.172 0.188 0.625 0.715
14 0.884 1.699 0.935  7.157 44.739 0.668 0.723 0.162 0.179 0.615 0.688
15 0.899 1.735 0.939  4.710 20.011 0.560 0.611 0.149 0.170 0.582 0.628
16 0.879 1.680 0.936  5.071 22.756 0.576 0.630 0.164 0.176 0.583 0.636
17 0.890 1.694 0.939  5.520 26.487 0.635 0.687 0.152 0.172 0.622 0.680
18 0.883 1.781 0.946  4.571 18.167 0.669 0.723 0.184 0.161 0.680 0.725
19 0.838 1.556 0.937  6.308 34.419 0.618 0.675 0.181 0.176 0.601 0.664
20 0.810 1.436 0.953  4.902 20.716 0.527 0.575 0.165 0.147 0.643 0.648
21 0.882 1.919 0.945  6.987 43.417 0.666 0.723 0.218 0.166 0.673 0.721
22 0.755 1.467 0.934  6.771 40.603 0.529 0.585 0.228 0.185 0.526 0.584
23 0.866 1.703 0.942  6.836 40.858 0.653 0.706 0.188 0.168 0.648 0.701</code></pre>
</div>
</div>
<ul>
<li>
<code>summary</code> : a data frame that contains the summary of the results, containing the number of objects in each image (<code>n</code>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged_cor</span><span class="op">$</span><span class="va">summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>    img n area_sum area_mean area_sd area_ch perimeter radius_mean radius_min
1  L1_1 1  102.091   102.091   0.000   7.427   133.758       6.213      0.565
2  L1_2 1   92.764    92.764   0.000   5.262   124.363       5.335      1.048
3  L2_1 2   81.617    40.809   7.790   1.053    27.080       3.689      2.419
4  L2_2 3   73.495    24.498  11.901   0.630    20.644       2.838      1.902
5  L3_1 1   64.030    64.030   0.000   2.994    92.378       4.204      0.408
6  L3_2 1   30.204    30.204   0.000   1.462    63.319       2.829      0.065
7  L3_3 1   51.966    51.966   0.000   2.219    93.421       3.495      0.073
8  L4_1 2  116.023    58.011   5.174   1.509    31.866       4.358      3.540
9  L4_2 2  134.720    67.360   8.313   1.756    34.660       4.741      3.459
10 L4_3 3   82.851    27.617   7.445   0.724    23.015       3.056      1.958
11 L5_1 3  114.648    38.216  12.642   1.011    31.384       4.013      1.880
12 L5_2 3  133.409    44.470   1.444   1.159    33.533       4.299      2.077
   radius_max radius_sd diam_mean diam_min diam_max major_axis minor_axis
1      11.927     2.899    12.426    1.130   23.853     19.865     15.143
2      10.164     2.189    10.669    2.096   20.327     15.129     13.217
3       5.559     0.865     7.378    4.838   11.119      9.893      5.290
4       4.279     0.669     5.677    3.805    8.557      7.588      4.025
5       9.466     2.050     8.407    0.817   18.932     15.228      8.684
6       6.578     1.425     5.658    0.130   13.155      9.857      7.103
7       7.816     1.656     6.990    0.146   15.632     12.405      8.416
8       6.107     0.632     8.717    7.079   12.214     10.232      7.292
9       6.778     0.801     9.482    6.919   13.556     11.288      7.712
10      4.488     0.705     6.111    3.915    8.977      8.046      4.391
11      6.911     1.489     8.026    3.761   13.823     11.794      4.144
12      7.421     1.593     8.597    4.154   14.842     12.999      4.421
   length   width radius_ratio eccentricity  theta solidity convexity
1  21.589 722.973       21.109        0.638  0.158    0.349     0.402
2  16.895 579.711        9.696        0.805  0.600    0.448     0.387
3  10.830 216.689        2.296        0.381 -0.016    0.983     0.918
4   8.362 166.694        2.291        0.357  1.504    0.989     0.918
5  15.717 391.913       23.182        0.369 -1.550    0.543     0.384
6  10.814 323.238      101.214        0.511  1.564    0.525     0.395
7  13.411 365.216      107.425        0.467  1.539    0.595     0.385
8  11.193 299.845        1.723        0.581  1.456    0.978     0.887
9  12.437 311.734        1.969        0.496  0.097    0.975     0.874
10  8.525 179.250        2.303        0.359  0.491    0.968     0.869
11 13.694 171.027        3.709        0.146 -0.554    0.958     0.902
12 14.620 182.810        3.579        0.150 -0.496    0.974     0.908
   elongation circularity circularity_haralick circularity_norm   asm   con
1       0.149     175.249                2.143           14.149 0.169 0.302
2       0.128     166.727                2.437           13.463 0.189 0.347
3       0.493      18.099                4.259            1.451 0.211 0.206
4       0.499      18.284                4.258            1.470 0.196 0.195
5       0.367     133.276                2.051           10.649 0.262 0.238
6       0.241     132.739                1.985           10.813 0.231 0.295
7       0.308     167.949                2.111           13.621 0.399 0.204
8       0.319      17.506                6.956            1.401 0.321 0.125
9       0.364      17.864                5.930            1.430 0.277 0.167
10      0.469      19.418                4.331            1.560 0.367 0.155
11      0.683      26.572                2.694            2.135 0.317 0.176
12      0.682      25.297                2.699            2.030 0.336 0.211
     cor   var   idm   sav    sva   sen   ent   dva   den   f12   f13
1  0.912 2.707 0.896 8.593 65.679 0.902 0.995 0.302 0.247 0.590 0.752
2  0.881 2.455 0.879 7.598 50.922 0.856 0.963 0.347 0.270 0.516 0.699
3  0.929 2.431 0.916 8.564 66.519 0.824 0.895 0.206 0.209 0.626 0.746
4  0.925 2.399 0.917 8.248 62.876 0.831 0.896 0.195 0.206 0.627 0.747
5  0.912 2.355 0.918 5.438 27.026 0.765 0.840 0.238 0.213 0.607 0.720
6  0.898 2.442 0.891 5.250 25.212 0.807 0.903 0.295 0.252 0.525 0.689
7  0.905 2.069 0.937 3.221 11.024 0.585 0.645 0.204 0.181 0.607 0.656
8  0.897 1.631 0.944 7.644 51.747 0.620 0.662 0.125 0.157 0.640 0.680
9  0.896 1.811 0.932 6.803 40.502 0.697 0.755 0.167 0.183 0.620 0.702
10 0.889 1.703 0.938 5.100 23.084 0.590 0.643 0.155 0.173 0.596 0.648
11 0.844 1.591 0.946 5.260 24.434 0.605 0.658 0.176 0.162 0.641 0.679
12 0.834 1.696 0.941 6.865 41.626 0.616 0.672 0.211 0.173 0.616 0.669</code></pre>
</div>
</div>
<ul>
<li>
<code>merge</code>: a data frame that contains the results merged by image prefix. Note that in this case the results are displayed by L1, L2, L3, L4 and L5.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged_cor</span><span class="op">$</span><span class="va">merge</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  img n area_sum area_mean area_sd area_ch perimeter radius_mean radius_min
1  L1 2  194.854    97.427   0.000   6.345   129.061       5.774      0.807
2  L2 5  155.112    32.653   9.846   0.841    23.862       3.264      2.161
3  L3 3  146.200    48.733   0.000   2.225    83.039       3.509      0.182
4  L4 7  333.594    50.996   6.977   1.330    29.847       4.052      2.986
5  L5 6  248.056    41.343   7.043   1.085    32.458       4.156      1.979
  radius_max radius_sd diam_mean diam_min diam_max major_axis minor_axis length
1     11.045     2.544    11.547    1.613   22.090     17.497     14.180 19.242
2      4.919     0.767     6.527    4.322    9.838      8.741      4.657  9.596
3      7.953     1.710     7.018    0.364   15.906     12.497      8.068 13.314
4      5.791     0.713     8.103    5.971   11.582      9.856      6.465 10.718
5      7.166     1.541     8.311    3.957   14.332     12.396      4.282 14.157
    width radius_ratio eccentricity  theta solidity convexity elongation
1 651.342       15.402        0.722  0.379    0.398     0.395      0.139
2 191.691        2.293        0.369  0.744    0.986     0.918      0.496
3 360.122       77.274        0.449  0.517    0.554     0.388      0.305
4 263.609        1.999        0.479  0.681    0.973     0.877      0.384
5 176.918        3.644        0.148 -0.525    0.966     0.905      0.683
  circularity circularity_haralick circularity_norm   asm   con   cor   var
1     170.988                2.290           13.806 0.179 0.324 0.896 2.581
2      18.191                4.259            1.460 0.204 0.201 0.927 2.415
3     144.655                2.049           11.694 0.297 0.245 0.905 2.289
4      18.263                5.739            1.464 0.322 0.149 0.894 1.715
5      25.934                2.697            2.083 0.326 0.194 0.839 1.644
    idm   sav    sva   sen   ent   dva   den   f12   f13
1 0.888 8.096 58.300 0.879 0.979 0.324 0.259 0.553 0.726
2 0.916 8.406 64.697 0.828 0.896 0.201 0.207 0.627 0.746
3 0.915 4.637 21.087 0.719 0.796 0.245 0.215 0.580 0.688
4 0.938 6.515 38.444 0.636 0.686 0.149 0.171 0.618 0.677
5 0.943 6.062 33.030 0.610 0.665 0.194 0.167 0.629 0.674</code></pre>
</div>
</div>
<p>The <code>area_sum</code> of img <code>L1</code> is the sum of the two sheets (one in each image).</p>
<div class="cell">
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">merged_cor</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">area</span> <span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 194.855</code></pre>
</div>
</div>
<p>Below, I will create a plot to show the distribution of leaf area</p>
<div class="cell">
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_leaf</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">merged_cor</span><span class="op">$</span><span class="va">results</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">img</span> , into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"img"</span>, <span class="st">"code"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># leaf area of the different species</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_leaf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">" Image "</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Area</span> <span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_leaf</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">img</span> , y <span class="op">=</span> <span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">sum</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">" black "</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">" Image "</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Total</span><span class="op">~</span><span class="va">area</span> <span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># solidity of the different species</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_leaf</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">img</span> , y <span class="op">=</span> <span class="va">solidity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Image"</span>, y <span class="op">=</span> <span class="st">"Solidity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/merge9-1.png" class="img-fluid" width="960"></p>
</div>
</div>


<!-- -->
<div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title anchored" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb176" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analyze objects"</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include = FALSE}</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># Directory</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># Working with polygons</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A 'polygon' is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)^</span><span class="co">[</span><span class="ot">Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019–1028. doi: 10.1016/0031-3203(93)90003-F.</span><span class="co">]</span><span class="at">.</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>Given the above, we can conclude that image objects can be expressed as polygons with <span class="in">`n`</span> vertices. <span class="in">`pliman`</span> has a set of functions(<span class="in">`draw_*()`</span>) useful for drawing common shapes like circles, squares, triangles, rectangles and <span class="in">`n`</span>- tagons . Another group of <span class="in">` poly_*()`</span> functions can be used to analyze polygons. Let's start with a simple example related to the area and perimeter of a square.</span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =6}</span></span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">draw_square</span>(<span class="at">side =</span> <span class="dv">1</span>)</span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(square)</span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(square)</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>Now, let's see what happens when we start with a hexagon and increase the number of sides up to 1000.</span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =6}</span></span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span> <span class="fu">list</span>(  <span class="at">side6 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">6</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">side12 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">12</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">side24 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">24</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">100</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">side500 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">500</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>))</span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(shapes, <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(shapes)</span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(shapes)</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>Note that when $n \to \infty$, the sum of the sides becomes the circumference of the circle, given by $2 \pi r$, and the area becomes $\pi r^2$. This is fun, but <span class="in">`pliman`</span> is primarily designed for analyzing plant image analysis. So why use polygons? Let's see how we can use these functions to get applicable information.</span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =8, fig.height =6}</span></span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a><span class="co"># getting the outline of objects</span></span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">object_contour</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the polygon</span></span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 3, 12, and 24.</span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-62"><a href="#cb176-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =6}</span></span>
<span id="cb176-63"><a href="#cb176-63" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> cont[<span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"12"</span>, <span class="st">"24"</span>)]</span>
<span id="cb176-64"><a href="#cb176-64" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb176-65"><a href="#cb176-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-66"><a href="#cb176-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-67"><a href="#cb176-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-68"><a href="#cb176-68" aria-hidden="true" tabindex="-1"></a>In the current version of <span class="in">`pliman`</span>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)^<span class="co">[</span><span class="ot">Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed. World Scientific.</span><span class="co">]</span>, Claude (2008)^<span class="co">[</span><span class="ot">Claude, J. 2008. Morphometrics with R. Springer.</span><span class="co">]</span>, and Montero et al. (2009)^<span class="co">[</span><span class="ot">Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335.</span><span class="co">]</span>.</span>
<span id="cb176-69"><a href="#cb176-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-70"><a href="#cb176-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Area</span></span>
<span id="cb176-71"><a href="#cb176-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-72"><a href="#cb176-72" aria-hidden="true" tabindex="-1"></a>The area of a shape is calculated using Shoelace 's formula (Lee and Lim, 2017)^<span class="co">[</span><span class="ot">Lee, Y., and W. Lim. 2017. Fórmula de cadarço: conectando a área de um polígono e o produto vetorial vetorial. The Mathematics Teacher 110(8): 631–636. doi: 10.5951/MATHTEACHER.110.8.0631.</span><span class="co">]</span>, as follows</span>
<span id="cb176-73"><a href="#cb176-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-74"><a href="#cb176-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb176-75"><a href="#cb176-75" aria-hidden="true" tabindex="-1"></a>A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|</span>
<span id="cb176-76"><a href="#cb176-76" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb176-77"><a href="#cb176-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-78"><a href="#cb176-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =6}</span></span>
<span id="cb176-79"><a href="#cb176-79" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(cont)</span>
<span id="cb176-80"><a href="#cb176-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-81"><a href="#cb176-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-82"><a href="#cb176-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-83"><a href="#cb176-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter</span></span>
<span id="cb176-84"><a href="#cb176-84" aria-hidden="true" tabindex="-1"></a>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <span class="in">`poly_distpts()`</span>.</span>
<span id="cb176-85"><a href="#cb176-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-88"><a href="#cb176-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-89"><a href="#cb176-89" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(cont)</span>
<span id="cb176-90"><a href="#cb176-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-91"><a href="#cb176-91" aria-hidden="true" tabindex="-1"></a><span class="co"># perimeter of a circle with radius 2</span></span>
<span id="cb176-92"><a href="#cb176-92" aria-hidden="true" tabindex="-1"></a>circle <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">radius =</span> <span class="dv">2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-93"><a href="#cb176-93" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(circle)</span>
<span id="cb176-94"><a href="#cb176-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-95"><a href="#cb176-95" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result</span></span>
<span id="cb176-96"><a href="#cb176-96" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb176-97"><a href="#cb176-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-98"><a href="#cb176-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-99"><a href="#cb176-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-100"><a href="#cb176-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Radius</span></span>
<span id="cb176-101"><a href="#cb176-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-102"><a href="#cb176-102" aria-hidden="true" tabindex="-1"></a>The radius of a pixel on the object's contour is calculated as its distance from the object's centroid(also called 'center of mass'). These distances can be obtained with <span class="in">`poly_centdist()`</span>.</span>
<span id="cb176-103"><a href="#cb176-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-106"><a href="#cb176-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-107"><a href="#cb176-107" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">poly_centdist</span>(cont)</span>
<span id="cb176-108"><a href="#cb176-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-109"><a href="#cb176-109" aria-hidden="true" tabindex="-1"></a><span class="co"># stats for radius</span></span>
<span id="cb176-110"><a href="#cb176-110" aria-hidden="true" tabindex="-1"></a><span class="fu">mean_list</span>(dist)</span>
<span id="cb176-111"><a href="#cb176-111" aria-hidden="true" tabindex="-1"></a><span class="fu">min_list</span>(dist)</span>
<span id="cb176-112"><a href="#cb176-112" aria-hidden="true" tabindex="-1"></a><span class="fu">max_list</span>(dist)</span>
<span id="cb176-113"><a href="#cb176-113" aria-hidden="true" tabindex="-1"></a><span class="fu">sd_list</span>(dist)</span>
<span id="cb176-114"><a href="#cb176-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-115"><a href="#cb176-115" aria-hidden="true" tabindex="-1"></a><span class="co"># average radius of circle above</span></span>
<span id="cb176-116"><a href="#cb176-116" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_centdist</span>(circle) <span class="sc">|&gt;</span> <span class="fu">mean_list</span>()</span>
<span id="cb176-117"><a href="#cb176-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-118"><a href="#cb176-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-119"><a href="#cb176-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-120"><a href="#cb176-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-121"><a href="#cb176-121" aria-hidden="true" tabindex="-1"></a><span class="fu">## Length and width</span></span>
<span id="cb176-122"><a href="#cb176-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-123"><a href="#cb176-123" aria-hidden="true" tabindex="-1"></a>The length and width of an object are calculated with <span class="in">`poly_lw()`</span>, as the difference between the maximum and minimum of the <span class="in">`x`</span> and <span class="in">`y`</span> coordinates after the object has been aligned with <span class="in">`poly_align()`</span>.</span>
<span id="cb176-124"><a href="#cb176-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-125"><a href="#cb176-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =2, fig.width=10}</span></span>
<span id="cb176-126"><a href="#cb176-126" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_lw</span>(cont)</span>
<span id="cb176-127"><a href="#cb176-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-128"><a href="#cb176-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-129"><a href="#cb176-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Circularity, eccentricity, diameter and elongation</span></span>
<span id="cb176-130"><a href="#cb176-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-131"><a href="#cb176-131" aria-hidden="true" tabindex="-1"></a>Circularity(Montero et al. 2009)^<span class="co">[</span><span class="ot">Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335</span><span class="co">]</span> is also called shape compactness, or measure of roundness of an object. It is given by $C = P^2 / A$, where $P$ is the perimeter and $A$ is the area of the object.</span>
<span id="cb176-132"><a href="#cb176-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-135"><a href="#cb176-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-136"><a href="#cb176-136" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity</span>(cont)</span>
<span id="cb176-137"><a href="#cb176-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-138"><a href="#cb176-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-139"><a href="#cb176-139" aria-hidden="true" tabindex="-1"></a>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given $Cn = P^2 / 4 \pi A$</span>
<span id="cb176-140"><a href="#cb176-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-143"><a href="#cb176-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-144"><a href="#cb176-144" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_norm</span>(cont)</span>
<span id="cb176-145"><a href="#cb176-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-146"><a href="#cb176-146" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized circularity for different shapes</span></span>
<span id="cb176-147"><a href="#cb176-147" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_square</span>(<span class="at">plot =</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb176-148"><a href="#cb176-148" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_circle</span>(<span class="at">plot=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb176-149"><a href="#cb176-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-150"><a href="#cb176-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-151"><a href="#cb176-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-152"><a href="#cb176-152" aria-hidden="true" tabindex="-1"></a><span class="in">` poly_circularity_haralick()`</span> calculates the circularity of Haralick , CH(Haralick , 1974)^<span class="co">[</span><span class="ot">Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394–396. doi: 10.1109/TSMC.1974.5408463.</span><span class="co">]</span>. The method is based on calculating all Euclidean distances from the object's centroid to each contour pixel. With this set of distances, the mean($m$) and the standard deviation($s$) are calculated. These statistical parameters are used in a ratio that calculates CH as $CH = m/ sd $.</span>
<span id="cb176-153"><a href="#cb176-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-156"><a href="#cb176-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-157"><a href="#cb176-157" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_haralick</span>(cont)</span>
<span id="cb176-158"><a href="#cb176-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-159"><a href="#cb176-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-160"><a href="#cb176-160" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_convexity()`</span> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</span>
<span id="cb176-161"><a href="#cb176-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-164"><a href="#cb176-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-165"><a href="#cb176-165" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_convexity</span>(cont)</span>
<span id="cb176-166"><a href="#cb176-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-167"><a href="#cb176-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-168"><a href="#cb176-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-169"><a href="#cb176-169" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_eccentricity()`</span> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</span>
<span id="cb176-170"><a href="#cb176-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-173"><a href="#cb176-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-174"><a href="#cb176-174" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_eccentricity</span>(cont)</span>
<span id="cb176-175"><a href="#cb176-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-176"><a href="#cb176-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-177"><a href="#cb176-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-178"><a href="#cb176-178" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_elongation()`</span> Calculates the elongation of an object as <span class="in">`1 - width / length`</span></span>
<span id="cb176-179"><a href="#cb176-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-182"><a href="#cb176-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-183"><a href="#cb176-183" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_elongation</span>(cont)</span>
<span id="cb176-184"><a href="#cb176-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-185"><a href="#cb176-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-186"><a href="#cb176-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-187"><a href="#cb176-187" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_caliper()`</span> Calculates the gauge(also called Feret's diameter).</span>
<span id="cb176-188"><a href="#cb176-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-191"><a href="#cb176-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-192"><a href="#cb176-192" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_caliper</span>(cont)</span>
<span id="cb176-193"><a href="#cb176-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-194"><a href="#cb176-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-195"><a href="#cb176-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-196"><a href="#cb176-196" aria-hidden="true" tabindex="-1"></a>Users can use the <span class="in">`poly_measures()`</span> function to calculate most object measurements in a single call.</span>
<span id="cb176-197"><a href="#cb176-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-200"><a href="#cb176-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-201"><a href="#cb176-201" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">poly_measures</span>(cont) <span class="sc">|&gt;</span> <span class="fu">round_cols</span>()</span>
<span id="cb176-202"><a href="#cb176-202" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(measures)</span>
<span id="cb176-203"><a href="#cb176-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-204"><a href="#cb176-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-205"><a href="#cb176-205" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, the measurements can be corrected with <span class="in">` get_measures()`</span>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <span class="in">`dpi()`</span> the resolution can be obtained. In this case, the dpi is ~50.</span>
<span id="cb176-206"><a href="#cb176-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-209"><a href="#cb176-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-210"><a href="#cb176-210" aria-hidden="true" tabindex="-1"></a>(color_measures <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(measures, <span class="at">dpi =</span> <span class="dv">50</span>))</span>
<span id="cb176-211"><a href="#cb176-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-212"><a href="#cb176-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-213"><a href="#cb176-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-214"><a href="#cb176-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-215"><a href="#cb176-215" aria-hidden="true" tabindex="-1"></a>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <span class="in">`pliman`</span>. Just for simplicity, I'll just use object 2.</span>
<span id="cb176-216"><a href="#cb176-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-217"><a href="#cb176-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-220"><a href="#cb176-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-221"><a href="#cb176-221" aria-hidden="true" tabindex="-1"></a>o2 <span class="ot">&lt;-</span> cont[[<span class="st">"3"</span>]]</span>
<span id="cb176-222"><a href="#cb176-222" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(o2)</span>
<span id="cb176-223"><a href="#cb176-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-224"><a href="#cb176-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-225"><a href="#cb176-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rotate polygons</span></span>
<span id="cb176-226"><a href="#cb176-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-227"><a href="#cb176-227" aria-hidden="true" tabindex="-1"></a><span class="in">` poly_rotate()`</span> can be used to rotate the polygon coordinates by an <span class="in">`angle`</span> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</span>
<span id="cb176-228"><a href="#cb176-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-229"><a href="#cb176-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-230"><a href="#cb176-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =4, fig.height =4}</span></span>
<span id="cb176-231"><a href="#cb176-231" aria-hidden="true" tabindex="-1"></a>rot <span class="ot">&lt;-</span> <span class="fu">poly_rotate</span>(o2, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb176-232"><a href="#cb176-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-233"><a href="#cb176-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-234"><a href="#cb176-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-235"><a href="#cb176-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Invert polygons</span></span>
<span id="cb176-236"><a href="#cb176-236" aria-hidden="true" tabindex="-1"></a><span class="in">` poly_flip_x()`</span> and <span class="in">` poly_flip_y()`</span> can be used to flip shapes along the x and y axis, respectively.</span>
<span id="cb176-237"><a href="#cb176-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-238"><a href="#cb176-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =8, fig.height =4}</span></span>
<span id="cb176-239"><a href="#cb176-239" aria-hidden="true" tabindex="-1"></a>flipped <span class="ot">&lt;-</span> </span>
<span id="cb176-240"><a href="#cb176-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">fx =</span> <span class="fu">poly_flip_x</span>(o2), </span>
<span id="cb176-241"><a href="#cb176-241" aria-hidden="true" tabindex="-1"></a>       <span class="at">fy =</span> <span class="fu">poly_flip_y</span>(o2))</span>
<span id="cb176-242"><a href="#cb176-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-243"><a href="#cb176-243" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(flipped, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb176-244"><a href="#cb176-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-245"><a href="#cb176-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-246"><a href="#cb176-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-247"><a href="#cb176-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter sampling</span></span>
<span id="cb176-248"><a href="#cb176-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-249"><a href="#cb176-249" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_sample()`</span> samples <span class="in">`n`</span> coordinates between existing points, and <span class="in">`poly_sample_prop()`</span> samples a proportion of coordinates between existing ones.</span>
<span id="cb176-250"><a href="#cb176-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-251"><a href="#cb176-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =4, fig.height =4}</span></span>
<span id="cb176-252"><a href="#cb176-252" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 50 coordinates</span></span>
<span id="cb176-253"><a href="#cb176-253" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample</span>(o2, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb176-254"><a href="#cb176-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-255"><a href="#cb176-255" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 10% of coordinates</span></span>
<span id="cb176-256"><a href="#cb176-256" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample_prop</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb176-257"><a href="#cb176-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-258"><a href="#cb176-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-259"><a href="#cb176-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-260"><a href="#cb176-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## smoothing</span></span>
<span id="cb176-261"><a href="#cb176-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-262"><a href="#cb176-262" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_smooth()`</span> smooths the contour of a polygon by combining <span class="in">` prop`</span> coordinate point samples and interpolating them using <span class="in">` vertices`</span> vertices(default is 1000) .</span>
<span id="cb176-263"><a href="#cb176-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-264"><a href="#cb176-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =6, fig.height = 6}</span></span>
<span id="cb176-265"><a href="#cb176-265" aria-hidden="true" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span></span>
<span id="cb176-266"><a href="#cb176-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>( <span class="at">original =</span> o2,</span>
<span id="cb176-267"><a href="#cb176-267" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-268"><a href="#cb176-268" aria-hidden="true" tabindex="-1"></a>        <span class="at">s2 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb176-269"><a href="#cb176-269" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.04</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-270"><a href="#cb176-270" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb176-271"><a href="#cb176-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-272"><a href="#cb176-272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(smoothed, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb176-273"><a href="#cb176-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-274"><a href="#cb176-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-275"><a href="#cb176-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-276"><a href="#cb176-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Noises</span></span>
<span id="cb176-277"><a href="#cb176-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-278"><a href="#cb176-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-279"><a href="#cb176-279" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_jitter()`</span> adds a small amount of noise to a set of coordinates. See <span class="in">`base::jitter()`</span> for more details.</span>
<span id="cb176-280"><a href="#cb176-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-281"><a href="#cb176-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =8, fig.height =4}</span></span>
<span id="cb176-282"><a href="#cb176-282" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb176-283"><a href="#cb176-283" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-284"><a href="#cb176-284" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb176-285"><a href="#cb176-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_jitter</span>(<span class="at">noise_x =</span> <span class="dv">100</span>,</span>
<span id="cb176-286"><a href="#cb176-286" aria-hidden="true" tabindex="-1"></a>              <span class="at">noise_y =</span> <span class="dv">100</span>,</span>
<span id="cb176-287"><a href="#cb176-287" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-288"><a href="#cb176-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-289"><a href="#cb176-289" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(<span class="fu">list</span>(c1, c2), <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-290"><a href="#cb176-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-291"><a href="#cb176-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-292"><a href="#cb176-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-293"><a href="#cb176-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-294"><a href="#cb176-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-295"><a href="#cb176-295" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyzing objects</span></span>
<span id="cb176-296"><a href="#cb176-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-297"><a href="#cb176-297" aria-hidden="true" tabindex="-1"></a>The functions seen so far can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <span class="in">`object_contour()`</span> and <span class="in">`poly_measures()`</span>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <span class="in">` analyze_objects()`</span> function. Let's start with a simple example, using the <span class="in">`object_300dpi.png`</span> image available on <span class="co">[</span><span class="ot"> GitHub page</span><span class="co">](https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images)</span>. To facilitate importing images from this folder, an <span class="in">`image_pliman()`</span> helper function is used.</span>
<span id="cb176-298"><a href="#cb176-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-299"><a href="#cb176-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-300"><a href="#cb176-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse =TRUE}</span></span>
<span id="cb176-301"><a href="#cb176-301" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb176-302"><a href="#cb176-302" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb176-303"><a href="#cb176-303" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb176-304"><a href="#cb176-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-305"><a href="#cb176-305" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">"objects_300dpi.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-306"><a href="#cb176-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-307"><a href="#cb176-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-308"><a href="#cb176-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-309"><a href="#cb176-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-310"><a href="#cb176-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-311"><a href="#cb176-311" aria-hidden="true" tabindex="-1"></a>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</span>
<span id="cb176-312"><a href="#cb176-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-313"><a href="#cb176-313" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Larger square: 10 x 10 cm (100 cm$^2$)</span>
<span id="cb176-314"><a href="#cb176-314" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Smaller square: 5 x 5 cm(25 cm$^2$)</span>
<span id="cb176-315"><a href="#cb176-315" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rectangle: 4 x 2 cm(8 cm$^2$)</span>
<span id="cb176-316"><a href="#cb176-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Circle: 3 cm in diameter(~7.07 cm$^2$)</span>
<span id="cb176-317"><a href="#cb176-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-318"><a href="#cb176-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-319"><a href="#cb176-319" aria-hidden="true" tabindex="-1"></a>To count the objects in the image we use <span class="in">`analyze_objects()`</span> and inform the image(the only required argument). By default, the <span class="in">`NB`</span> index is used for object segmentation.</span>
<span id="cb176-320"><a href="#cb176-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-321"><a href="#cb176-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-322"><a href="#cb176-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 10, fig.height = 5}</span></span>
<span id="cb176-323"><a href="#cb176-323" aria-hidden="true" tabindex="-1"></a>img_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(img, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-324"><a href="#cb176-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-325"><a href="#cb176-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-326"><a href="#cb176-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-327"><a href="#cb176-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-328"><a href="#cb176-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjusting object measurements</span></span>
<span id="cb176-329"><a href="#cb176-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-330"><a href="#cb176-330" aria-hidden="true" tabindex="-1"></a>The results were stored in <span class="in">`img_res`</span>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm$^2$, only in pixels. In this case, we use <span class="in">`get_measures()`</span> to adjust pixel measurements to metric units.</span>
<span id="cb176-331"><a href="#cb176-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-332"><a href="#cb176-332" aria-hidden="true" tabindex="-1"></a>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area and radius will be adjusted by the dpi informed.</span>
<span id="cb176-333"><a href="#cb176-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-334"><a href="#cb176-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring a known value</span></span>
<span id="cb176-335"><a href="#cb176-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-336"><a href="#cb176-336" aria-hidden="true" tabindex="-1"></a>Since we know the area of the larger square (object 1), let's adjust the area of the other objects in the image using this.</span>
<span id="cb176-337"><a href="#cb176-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-338"><a href="#cb176-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-341"><a href="#cb176-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-342"><a href="#cb176-342" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(img_res ,</span>
<span id="cb176-343"><a href="#cb176-343" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb176-344"><a href="#cb176-344" aria-hidden="true" tabindex="-1"></a>             area <span class="sc">~</span> <span class="dv">100</span>)</span>
<span id="cb176-345"><a href="#cb176-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-346"><a href="#cb176-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-347"><a href="#cb176-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-348"><a href="#cb176-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-349"><a href="#cb176-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-350"><a href="#cb176-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring the image resolution</span></span>
<span id="cb176-351"><a href="#cb176-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-352"><a href="#cb176-352" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, all measurements will be adjusted accordingly. Let's see a numerical example with <span class="in">`pixels_to_cm()`</span>. This function converts the number of pixels(* px *) into cm, considering the image resolution in <span class="in">` dpi `</span>, as follows: $cm = px \times(2.54 / dpi)$. As we know the number of pixels of the larger square, its perimeter in cm is given by</span>
<span id="cb176-353"><a href="#cb176-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-354"><a href="#cb176-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-355"><a href="#cb176-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-358"><a href="#cb176-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-359"><a href="#cb176-359" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span id="cb176-360"><a href="#cb176-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-361"><a href="#cb176-361" aria-hidden="true" tabindex="-1"></a>ls_px <span class="ot">&lt;-</span> img_res<span class="sc">$</span>results<span class="sc">$</span>perimeter [<span class="dv">1</span>]</span>
<span id="cb176-362"><a href="#cb176-362" aria-hidden="true" tabindex="-1"></a><span class="fu">pixels_to_cm</span>(<span class="at">px =</span> ls_px , <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb176-363"><a href="#cb176-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-364"><a href="#cb176-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-365"><a href="#cb176-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-366"><a href="#cb176-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-367"><a href="#cb176-367" aria-hidden="true" tabindex="-1"></a>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <span class="in">`dpi`</span> argument in <span class="in">`get_measures()`</span>.</span>
<span id="cb176-368"><a href="#cb176-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-371"><a href="#cb176-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-372"><a href="#cb176-372" aria-hidden="true" tabindex="-1"></a>img_res_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(img_res , <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb176-373"><a href="#cb176-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-374"><a href="#cb176-374" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb176-375"><a href="#cb176-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-376"><a href="#cb176-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-377"><a href="#cb176-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-378"><a href="#cb176-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-379"><a href="#cb176-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-380"><a href="#cb176-380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Understanding measurements</span></span>
<span id="cb176-381"><a href="#cb176-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-384"><a href="#cb176-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-385"><a href="#cb176-385" aria-hidden="true" tabindex="-1"></a><span class="fu">object_contour</span>(img) <span class="sc">%&gt;%</span> <span class="co"># get the contour of objects</span></span>
<span id="cb176-386"><a href="#cb176-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_mass</span>() <span class="sc">%&gt;%</span> <span class="co"># computes center of mass and minimum and maximum radii</span></span>
<span id="cb176-387"><a href="#cb176-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_mass</span>() <span class="co"># plot the measurements</span></span>
<span id="cb176-388"><a href="#cb176-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-389"><a href="#cb176-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-390"><a href="#cb176-390" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Larger square:</span>
<span id="cb176-391"><a href="#cb176-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The minimum diameter(a = 9.97) can be considered as the side of the square</span>
<span id="cb176-392"><a href="#cb176-392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The maximum diameter, given by $a \sqrt {2}$ can be considered the diagonal of the square ($9.97 \sqrt {2} = 14,099 \approx 14,105$</span>
<span id="cb176-393"><a href="#cb176-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-396"><a href="#cb176-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-397"><a href="#cb176-397" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb176-398"><a href="#cb176-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-399"><a href="#cb176-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-400"><a href="#cb176-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-401"><a href="#cb176-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## Texture features</span></span>
<span id="cb176-402"><a href="#cb176-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-403"><a href="#cb176-403" aria-hidden="true" tabindex="-1"></a>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al. 1979)^<span class="co">[</span><span class="ot">Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610–621. doi: 10.1109/TSMC.1973.4309314</span><span class="co">]</span>. Haralick features depend on the configuration of the parameters <span class="in">`har_nbins`</span> and <span class="in">`har_scales`</span>. <span class="in">`har_nbins`</span> controls the number of bins used to compute the Haralick matrix. A smaller <span class="in">`har_nbins`</span> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <span class="in">`har_scales`</span> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To chance this default, use the argument <span class="in">`har_band`</span>. For example, <span class="in">`har_band = 2`</span> will compute the features with the green band. </span>
<span id="cb176-404"><a href="#cb176-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-405"><a href="#cb176-405" aria-hidden="true" tabindex="-1"></a>The followig measures are returned (fore more details, see <span class="co">[</span><span class="ot">this post</span><span class="co">](https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html)</span>)</span>
<span id="cb176-406"><a href="#cb176-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-407"><a href="#cb176-407" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`asm`</span>: The angular second-moment feature.</span>
<span id="cb176-408"><a href="#cb176-408" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`con`</span>: The contrast feature</span>
<span id="cb176-409"><a href="#cb176-409" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`cor`</span>: Correlation measures the linear dependency of gray levels of</span>
<span id="cb176-410"><a href="#cb176-410" aria-hidden="true" tabindex="-1"></a> neighboring pixels.</span>
<span id="cb176-411"><a href="#cb176-411" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`var`</span>: The variance of gray levels pixels.</span>
<span id="cb176-412"><a href="#cb176-412" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`idm`</span>: The Inverse Difference Moment (IDM), i.e., the local</span>
<span id="cb176-413"><a href="#cb176-413" aria-hidden="true" tabindex="-1"></a> homogeneity.</span>
<span id="cb176-414"><a href="#cb176-414" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`sav`</span>: The Sum Average.</span>
<span id="cb176-415"><a href="#cb176-415" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`sva`</span>: The Sum Variance.</span>
<span id="cb176-416"><a href="#cb176-416" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`sen`</span>: Sum Entropy.</span>
<span id="cb176-417"><a href="#cb176-417" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`dva`</span>: Difference Variance.</span>
<span id="cb176-418"><a href="#cb176-418" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`den`</span>: Difference Entropy</span>
<span id="cb176-419"><a href="#cb176-419" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`f12`</span>: Difference Variance.</span>
<span id="cb176-420"><a href="#cb176-420" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`f13`</span>: The angular second-moment feature.</span>
<span id="cb176-421"><a href="#cb176-421" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb176-422"><a href="#cb176-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-423"><a href="#cb176-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Single image processing</span></span>
<span id="cb176-424"><a href="#cb176-424" aria-hidden="true" tabindex="-1"></a>The <span class="in">`analyze_objects()`</span> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</span>
<span id="cb176-425"><a href="#cb176-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-426"><a href="#cb176-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-429"><a href="#cb176-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-430"><a href="#cb176-430" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-431"><a href="#cb176-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-432"><a href="#cb176-432" aria-hidden="true" tabindex="-1"></a>leaves_meas <span class="ot">&lt;-</span></span>
<span id="cb176-433"><a href="#cb176-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves ,</span>
<span id="cb176-434"><a href="#cb176-434" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-435"><a href="#cb176-435" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"black"</span>)</span>
<span id="cb176-436"><a href="#cb176-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-437"><a href="#cb176-437" aria-hidden="true" tabindex="-1"></a>leaves_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(leaves_meas , <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb176-438"><a href="#cb176-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-439"><a href="#cb176-439" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(leaves_cor)</span>
<span id="cb176-440"><a href="#cb176-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-441"><a href="#cb176-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-442"><a href="#cb176-442" aria-hidden="true" tabindex="-1"></a><span class="co"># plot width and length</span></span>
<span id="cb176-443"><a href="#cb176-443" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"width"</span>)</span>
<span id="cb176-444"><a href="#cb176-444" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"length"</span>, <span class="at">vjust =</span> <span class="dv">50</span>)</span>
<span id="cb176-445"><a href="#cb176-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-446"><a href="#cb176-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-447"><a href="#cb176-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-448"><a href="#cb176-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-449"><a href="#cb176-449" aria-hidden="true" tabindex="-1"></a>Here, we will count the grains in the <span class="in">`grains.jpg`</span> image. This image has a cyan background and contains 90 soybeans that touch each other. The <span class="in">` analyze_objects()`</span> function segments the image using the normalized blue index by default, as follows $NB =(B /(R + G + B))$, where *R*, *G* and *B * are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <span class="in">`img`</span> argument(e.g., <span class="in">`img = "grains"`</span>).</span>
<span id="cb176-450"><a href="#cb176-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-451"><a href="#cb176-451" aria-hidden="true" tabindex="-1"></a>In this example, objects are counted and segmented objects are colored with random colors using the <span class="in">`show_segmentation = TRUE`</span> argument. Users can set <span class="in">` show_contour = FALSE`</span> to remove the contour line and identify the objects (in this example, the grains) using the <span class="in">`marker = "id"`</span> arguments. The background color can also be changed with <span class="in">`col_background`</span>.</span>
<span id="cb176-452"><a href="#cb176-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-453"><a href="#cb176-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-454"><a href="#cb176-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-455"><a href="#cb176-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 12, fig.height = 6}</span></span>
<span id="cb176-456"><a href="#cb176-456" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span></span>
<span id="cb176-457"><a href="#cb176-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb176-458"><a href="#cb176-458" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-459"><a href="#cb176-459" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-460"><a href="#cb176-460" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-461"><a href="#cb176-461" aria-hidden="true" tabindex="-1"></a>count<span class="sc">$</span>statistics</span>
<span id="cb176-462"><a href="#cb176-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-463"><a href="#cb176-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-464"><a href="#cb176-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-467"><a href="#cb176-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-468"><a href="#cb176-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the measurements of the object</span></span>
<span id="cb176-469"><a href="#cb176-469" aria-hidden="true" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(count)</span>
<span id="cb176-470"><a href="#cb176-470" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(measurements)</span>
<span id="cb176-471"><a href="#cb176-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-472"><a href="#cb176-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-473"><a href="#cb176-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-474"><a href="#cb176-474" aria-hidden="true" tabindex="-1"></a>In the following example, we will select objects with an area above the average of all objects using <span class="in">` lower_size = 719.1`</span>.</span>
<span id="cb176-475"><a href="#cb176-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-476"><a href="#cb176-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-477"><a href="#cb176-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-478"><a href="#cb176-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 12, fig.height = 6}</span></span>
<span id="cb176-479"><a href="#cb176-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-480"><a href="#cb176-480" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb176-481"><a href="#cb176-481" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb176-482"><a href="#cb176-482" aria-hidden="true" tabindex="-1"></a>                <span class="at">lower_size =</span> <span class="fl">719.1</span>)</span>
<span id="cb176-483"><a href="#cb176-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-484"><a href="#cb176-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-485"><a href="#cb176-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-486"><a href="#cb176-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-487"><a href="#cb176-487" aria-hidden="true" tabindex="-1"></a>Users can also use the <span class="in">`topn _*`</span> arguments to select the <span class="in">`n`</span> objects based on the smallest or largest areas. Let's see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <span class="in">`my_index`</span> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <span class="in">`my_index = "B /(R + G + B)"`</span>.</span>
<span id="cb176-488"><a href="#cb176-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-489"><a href="#cb176-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-490"><a href="#cb176-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-491"><a href="#cb176-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 12, fig.height = 6}</span></span>
<span id="cb176-492"><a href="#cb176-492" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb176-493"><a href="#cb176-493" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb176-494"><a href="#cb176-494" aria-hidden="true" tabindex="-1"></a>                <span class="at">topn_lower =</span> <span class="dv">5</span>,</span>
<span id="cb176-495"><a href="#cb176-495" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_background =</span> <span class="st">"salmon"</span>,</span>
<span id="cb176-496"><a href="#cb176-496" aria-hidden="true" tabindex="-1"></a>                <span class="at">my_index =</span> <span class="st">"B /(R + G + B)"</span>) <span class="co"># normalized blue(NB)</span></span>
<span id="cb176-497"><a href="#cb176-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-498"><a href="#cb176-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-499"><a href="#cb176-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-500"><a href="#cb176-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-501"><a href="#cb176-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## Batch processing</span></span>
<span id="cb176-502"><a href="#cb176-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-503"><a href="#cb176-503" aria-hidden="true" tabindex="-1"></a>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in indirect selection of high-yielding plants. In <span class="in">`pliman`</span>, batch processing can be done when the user declares the <span class="in">`pattern`</span> argument.</span>
<span id="cb176-504"><a href="#cb176-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-505"><a href="#cb176-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-506"><a href="#cb176-506" aria-hidden="true" tabindex="-1"></a>To speed up processing time, especially for large numbers of images, the <span class="in">`parallel = TRUE`</span> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <span class="in">`R`</span> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <span class="in">`workers`</span> argument.</span>
<span id="cb176-507"><a href="#cb176-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-508"><a href="#cb176-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-511"><a href="#cb176-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-512"><a href="#cb176-512" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb176-513"><a href="#cb176-513" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-514"><a href="#cb176-514" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-515"><a href="#cb176-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-516"><a href="#cb176-516" aria-hidden="true" tabindex="-1"></a><span class="co"># parallel processing</span></span>
<span id="cb176-517"><a href="#cb176-517" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span id="cb176-518"><a href="#cb176-518" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb176-519"><a href="#cb176-519" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span></span>
<span id="cb176-520"><a href="#cb176-520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>,</span>
<span id="cb176-521"><a href="#cb176-521" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-522"><a href="#cb176-522" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-523"><a href="#cb176-523" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-524"><a href="#cb176-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-525"><a href="#cb176-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-526"><a href="#cb176-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-527"><a href="#cb176-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-528"><a href="#cb176-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-529"><a href="#cb176-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-530"><a href="#cb176-530" aria-hidden="true" tabindex="-1"></a><span class="fu"># Object coordinates</span></span>
<span id="cb176-531"><a href="#cb176-531" aria-hidden="true" tabindex="-1"></a>Users can get the coordinates for all desired objects with <span class="in">`object_coord()`</span>. When the <span class="in">`id`</span> argument is set to <span class="in">`NULL`</span> (default), a bounding rectangle is drawn including all objects. Use <span class="in">`id = "all"`</span> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <span class="in">`watershed = FALSE`</span> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</span>
<span id="cb176-532"><a href="#cb176-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-533"><a href="#cb176-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-534"><a href="#cb176-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r objec2}</span></span>
<span id="cb176-535"><a href="#cb176-535" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-536"><a href="#cb176-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-537"><a href="#cb176-537" aria-hidden="true" tabindex="-1"></a><span class="co"># get the id of each object</span></span>
<span id="cb176-538"><a href="#cb176-538" aria-hidden="true" tabindex="-1"></a><span class="fu">object_id</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-539"><a href="#cb176-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-540"><a href="#cb176-540" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span id="cb176-541"><a href="#cb176-541" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-542"><a href="#cb176-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-543"><a href="#cb176-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coordinates for all objects</span></span>
<span id="cb176-544"><a href="#cb176-544" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb176-545"><a href="#cb176-545" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="st">"all"</span>,</span>
<span id="cb176-546"><a href="#cb176-546" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-547"><a href="#cb176-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-548"><a href="#cb176-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span id="cb176-549"><a href="#cb176-549" aria-hidden="true" tabindex="-1"></a><span class="co"># 20 border pixels</span></span>
<span id="cb176-550"><a href="#cb176-550" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb176-551"><a href="#cb176-551" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb176-552"><a href="#cb176-552" aria-hidden="true" tabindex="-1"></a>             <span class="at">edge =</span> <span class="dv">20</span>,</span>
<span id="cb176-553"><a href="#cb176-553" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-554"><a href="#cb176-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-555"><a href="#cb176-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-556"><a href="#cb176-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-557"><a href="#cb176-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-558"><a href="#cb176-558" aria-hidden="true" tabindex="-1"></a><span class="fu"># Isolating objects</span></span>
<span id="cb176-559"><a href="#cb176-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-560"><a href="#cb176-560" aria-hidden="true" tabindex="-1"></a>Knowing the coordinates of each object, it is possible to isolate it. The <span class="in">`object_isolate()`</span> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</span>
<span id="cb176-561"><a href="#cb176-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-562"><a href="#cb176-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r object3}</span></span>
<span id="cb176-563"><a href="#cb176-563" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span></span>
<span id="cb176-564"><a href="#cb176-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_isolate</span>(leaves ,</span>
<span id="cb176-565"><a href="#cb176-565" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-566"><a href="#cb176-566" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb176-567"><a href="#cb176-567" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge =</span> <span class="dv">10</span>)</span>
<span id="cb176-568"><a href="#cb176-568" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(id1)</span>
<span id="cb176-569"><a href="#cb176-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-570"><a href="#cb176-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-571"><a href="#cb176-571" aria-hidden="true" tabindex="-1"></a><span class="fu"># Including objects in a list</span></span>
<span id="cb176-572"><a href="#cb176-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-573"><a href="#cb176-573" aria-hidden="true" tabindex="-1"></a><span class="in">`object_split()`</span> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</span>
<span id="cb176-574"><a href="#cb176-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-575"><a href="#cb176-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10}</span></span>
<span id="cb176-576"><a href="#cb176-576" aria-hidden="true" tabindex="-1"></a>list <span class="ot">&lt;-</span> <span class="fu">object_split</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-577"><a href="#cb176-577" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list)</span>
<span id="cb176-578"><a href="#cb176-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-579"><a href="#cb176-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-580"><a href="#cb176-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-581"><a href="#cb176-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-582"><a href="#cb176-582" aria-hidden="true" tabindex="-1"></a><span class="fu"># RGB values for each object</span></span>
<span id="cb176-583"><a href="#cb176-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-584"><a href="#cb176-584" aria-hidden="true" tabindex="-1"></a>To get the RGB intensity of each object in the image, we use the <span class="in">`object_rgb = TRUE`</span> argument in the <span class="in">`analyze_objects()`</span> function. In the following example, we will use the R, G and B bands and their normalized values. The <span class="in">`pliman_indexes()`</span> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g. <span class="in">`object_index = "B/G+R"`</span>).</span>
<span id="cb176-585"><a href="#cb176-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-586"><a href="#cb176-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-587"><a href="#cb176-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-588"><a href="#cb176-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb2, fig.width = 10, fig.height = 6}</span></span>
<span id="cb176-589"><a href="#cb176-589" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"green.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-590"><a href="#cb176-590" aria-hidden="true" tabindex="-1"></a>(indx <span class="ot">&lt;-</span> <span class="fu">pliman_indexes</span>())</span>
<span id="cb176-591"><a href="#cb176-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-592"><a href="#cb176-592" aria-hidden="true" tabindex="-1"></a>soy_green <span class="ot">&lt;-</span></span>
<span id="cb176-593"><a href="#cb176-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img ,</span>
<span id="cb176-594"><a href="#cb176-594" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> indx [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="co"># R:NB</span></span>
<span id="cb176-595"><a href="#cb176-595" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb176-596"><a href="#cb176-596" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"black"</span>,</span>
<span id="cb176-597"><a href="#cb176-597" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb176-598"><a href="#cb176-598" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-599"><a href="#cb176-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-600"><a href="#cb176-600" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA with the indices</span></span>
<span id="cb176-601"><a href="#cb176-601" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">summary_index</span>(soy_green, <span class="at">type =</span><span class="st">"var"</span>)</span>
<span id="cb176-602"><a href="#cb176-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-603"><a href="#cb176-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-604"><a href="#cb176-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-605"><a href="#cb176-605" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</span>
<span id="cb176-606"><a href="#cb176-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-607"><a href="#cb176-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =8, fig.height =8}</span></span>
<span id="cb176-608"><a href="#cb176-608" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"var"</span>)</span>
<span id="cb176-609"><a href="#cb176-609" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"ind"</span>)</span>
<span id="cb176-610"><a href="#cb176-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-611"><a href="#cb176-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-612"><a href="#cb176-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-613"><a href="#cb176-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-614"><a href="#cb176-614" aria-hidden="true" tabindex="-1"></a>Now, let's plot the <span class="in">`R`</span> index on each object</span>
<span id="cb176-615"><a href="#cb176-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-618"><a href="#cb176-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-619"><a href="#cb176-619" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb176-620"><a href="#cb176-620" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(soy_green ,</span>
<span id="cb176-621"><a href="#cb176-621" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"R"</span>,</span>
<span id="cb176-622"><a href="#cb176-622" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" black "</span>)</span>
<span id="cb176-623"><a href="#cb176-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-624"><a href="#cb176-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-625"><a href="#cb176-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-626"><a href="#cb176-626" aria-hidden="true" tabindex="-1"></a>It seems that grains with average red (<span class="in">`R`</span>) value less than 0.6 can be considered greenish seeds. Users can then work with this feature and adapt it to their case.</span>
<span id="cb176-627"><a href="#cb176-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-628"><a href="#cb176-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb4, fig.width =10, fig.height =4}</span></span>
<span id="cb176-629"><a href="#cb176-629" aria-hidden="true" tabindex="-1"></a>report <span class="ot">&lt;-</span></span>
<span id="cb176-630"><a href="#cb176-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_index</span>(soy_green ,</span>
<span id="cb176-631"><a href="#cb176-631" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"R"</span>,</span>
<span id="cb176-632"><a href="#cb176-632" aria-hidden="true" tabindex="-1"></a>                <span class="at">cut_point =</span> <span class="fl">0.6</span>,</span>
<span id="cb176-633"><a href="#cb176-633" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-634"><a href="#cb176-634" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> report<span class="sc">$</span>ids</span>
<span id="cb176-635"><a href="#cb176-635" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>between_id</span>
<span id="cb176-636"><a href="#cb176-636" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>within_id[ids,]</span>
<span id="cb176-637"><a href="#cb176-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-638"><a href="#cb176-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-639"><a href="#cb176-639" aria-hidden="true" tabindex="-1"></a><span class="co"># ratio of pixels of each object(above and below 0.6)</span></span>
<span id="cb176-640"><a href="#cb176-640" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(report<span class="sc">$</span>within_id [,<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb176-641"><a href="#cb176-641" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"R &lt; 0.6"</span>, <span class="st">"R &gt; 0.6"</span>))</span>
<span id="cb176-642"><a href="#cb176-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-643"><a href="#cb176-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-644"><a href="#cb176-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-645"><a href="#cb176-645" aria-hidden="true" tabindex="-1"></a>In the following graph, I plot the distribution of the greenish and non-greenish R, G, and B values.</span>
<span id="cb176-646"><a href="#cb176-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-649"><a href="#cb176-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-650"><a href="#cb176-650" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of RGB values</span></span>
<span id="cb176-651"><a href="#cb176-651" aria-hidden="true" tabindex="-1"></a>rgbs <span class="ot">&lt;-</span></span>
<span id="cb176-652"><a href="#cb176-652" aria-hidden="true" tabindex="-1"></a>  soy_green<span class="sc">$</span>object_rgb <span class="sc">|&gt;</span></span>
<span id="cb176-653"><a href="#cb176-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> ids, <span class="st">" Greenish "</span>, <span class="st">" No greenish "</span>)) <span class="sc">|&gt;</span></span>
<span id="cb176-654"><a href="#cb176-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span></span>
<span id="cb176-655"><a href="#cb176-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>type)</span>
<span id="cb176-656"><a href="#cb176-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-657"><a href="#cb176-657" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rgbs, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb176-658"><a href="#cb176-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb176-659"><a href="#cb176-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type)</span>
<span id="cb176-660"><a href="#cb176-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-661"><a href="#cb176-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-662"><a href="#cb176-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-663"><a href="#cb176-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-664"><a href="#cb176-664" aria-hidden="true" tabindex="-1"></a>Now, using the ids of each grain, I plot the values only in the greenish ones.</span>
<span id="cb176-665"><a href="#cb176-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-666"><a href="#cb176-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-669"><a href="#cb176-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-670"><a href="#cb176-670" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb176-671"><a href="#cb176-671" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb176-672"><a href="#cb176-672" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(soy_green ,</span>
<span id="cb176-673"><a href="#cb176-673" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> ids,</span>
<span id="cb176-674"><a href="#cb176-674" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"R"</span>,</span>
<span id="cb176-675"><a href="#cb176-675" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb176-676"><a href="#cb176-676" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">object_contour</span>(img , <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-677"><a href="#cb176-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-678"><a href="#cb176-678" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(cont,</span>
<span id="cb176-679"><a href="#cb176-679" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> ids,</span>
<span id="cb176-680"><a href="#cb176-680" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb176-681"><a href="#cb176-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-682"><a href="#cb176-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-683"><a href="#cb176-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-684"><a href="#cb176-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-685"><a href="#cb176-685" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb176-686"><a href="#cb176-686" aria-hidden="true" tabindex="-1"></a>When there are many objects, the <span class="in">`parallel = TRUE`</span> argument will speed up extracting the RGB values. In the following example, an image with 1343 grains of *Vicia cracca* is analyzed. The indices <span class="in">`"R"`</span> and <span class="in">`"R/G"`</span> are computed. Grains with an average red value greater than 0.25 are highlighted.</span>
<span id="cb176-687"><a href="#cb176-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-688"><a href="#cb176-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb5, eval=FALSE}</span></span>
<span id="cb176-689"><a href="#cb176-689" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb176-690"><a href="#cb176-690" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"vicia.jpg"</span>)</span>
<span id="cb176-691"><a href="#cb176-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-692"><a href="#cb176-692" aria-hidden="true" tabindex="-1"></a>vicia <span class="ot">&lt;-</span></span>
<span id="cb176-693"><a href="#cb176-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img2,</span>
<span id="cb176-694"><a href="#cb176-694" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb176-695"><a href="#cb176-695" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="st">"R"</span>,</span>
<span id="cb176-696"><a href="#cb176-696" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-697"><a href="#cb176-697" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-698"><a href="#cb176-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-699"><a href="#cb176-699" aria-hidden="true" tabindex="-1"></a>summary_index <span class="ot">&lt;-</span></span>
<span id="cb176-700"><a href="#cb176-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_index</span>(vicia ,</span>
<span id="cb176-701"><a href="#cb176-701" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"R"</span>,</span>
<span id="cb176-702"><a href="#cb176-702" aria-hidden="true" tabindex="-1"></a>                <span class="at">cut_point =</span> <span class="fl">0.25</span>,</span>
<span id="cb176-703"><a href="#cb176-703" aria-hidden="true" tabindex="-1"></a>                <span class="at">select_higher =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-704"><a href="#cb176-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-705"><a href="#cb176-705" aria-hidden="true" tabindex="-1"></a>count2 <span class="ot">&lt;-</span></span>
<span id="cb176-706"><a href="#cb176-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img2,</span>
<span id="cb176-707"><a href="#cb176-707" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb176-708"><a href="#cb176-708" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-709"><a href="#cb176-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-710"><a href="#cb176-710" aria-hidden="true" tabindex="-1"></a>ids2 <span class="ot">&lt;-</span> summary_index<span class="sc">$</span>ids</span>
<span id="cb176-711"><a href="#cb176-711" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(count2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb176-712"><a href="#cb176-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-713"><a href="#cb176-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-714"><a href="#cb176-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-715"><a href="#cb176-715" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb176-716"><a href="#cb176-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-717"><a href="#cb176-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-718"><a href="#cb176-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-719"><a href="#cb176-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-720"><a href="#cb176-720" aria-hidden="true" tabindex="-1"></a><span class="fu"># Leaf area</span></span>
<span id="cb176-721"><a href="#cb176-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## Known resolution</span></span>
<span id="cb176-722"><a href="#cb176-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-725"><a href="#cb176-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-726"><a href="#cb176-726" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> <span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-727"><a href="#cb176-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-728"><a href="#cb176-728" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb176-729"><a href="#cb176-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves ,</span>
<span id="cb176-730"><a href="#cb176-730" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-731"><a href="#cb176-731" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-732"><a href="#cb176-732" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"black"</span>,</span>
<span id="cb176-733"><a href="#cb176-733" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-734"><a href="#cb176-734" aria-hidden="true" tabindex="-1"></a>af_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(af, <span class="at">dpi =</span> <span class="fl">50.5</span>)</span>
<span id="cb176-735"><a href="#cb176-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-736"><a href="#cb176-736" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor ,</span>
<span id="cb176-737"><a href="#cb176-737" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb176-738"><a href="#cb176-738" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">30</span>,</span>
<span id="cb176-739"><a href="#cb176-739" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" red "</span>)</span>
<span id="cb176-740"><a href="#cb176-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-741"><a href="#cb176-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-742"><a href="#cb176-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-743"><a href="#cb176-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-744"><a href="#cb176-744" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference object (dev version)</span></span>
<span id="cb176-745"><a href="#cb176-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-746"><a href="#cb176-746" aria-hidden="true" tabindex="-1"></a>The <span class="in">`reference`</span> argument can now be used to correct the object measures even when images with different shooting distances are used. In this example, the leaf area of the <span class="in">`ref_leaves`</span> image is quantified and corrected considering a 5 x 5 (25 cm$^2$) white square as the reference object. For this, it is necessary to provide color palettes referring to the background (<span class="in">`background`</span>), leaves (<span class="in">` foreground`</span>) and the reference object (<span class="in">`reference`</span>). Also, the area of the reference object needs to be informed in <span class="in">`reference_area`</span>.</span>
<span id="cb176-747"><a href="#cb176-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-750"><a href="#cb176-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-751"><a href="#cb176-751" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb176-752"><a href="#cb176-752" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"ref_"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-753"><a href="#cb176-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-754"><a href="#cb176-754" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span></span>
<span id="cb176-755"><a href="#cb176-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">img =</span> <span class="st">"ref_leaves"</span>,</span>
<span id="cb176-756"><a href="#cb176-756" aria-hidden="true" tabindex="-1"></a>                  <span class="at">foreground =</span> <span class="st">"ref_folha"</span>,</span>
<span id="cb176-757"><a href="#cb176-757" aria-hidden="true" tabindex="-1"></a>                  <span class="at">background =</span> <span class="st">"ref_back"</span>,</span>
<span id="cb176-758"><a href="#cb176-758" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference =</span> <span class="st">"ref_ref"</span>,</span>
<span id="cb176-759"><a href="#cb176-759" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference_area =</span> <span class="dv">25</span>,</span>
<span id="cb176-760"><a href="#cb176-760" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb176-761"><a href="#cb176-761" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-762"><a href="#cb176-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-763"><a href="#cb176-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-764"><a href="#cb176-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-765"><a href="#cb176-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-766"><a href="#cb176-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-767"><a href="#cb176-767" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filling 'holes'</span></span>
<span id="cb176-768"><a href="#cb176-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-769"><a href="#cb176-769" aria-hidden="true" tabindex="-1"></a>An important aspect to consider in leaf area measures is when leaves present 'holes'. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</span>
<span id="cb176-770"><a href="#cb176-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-771"><a href="#cb176-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10, fig.height =6}</span></span>
<span id="cb176-772"><a href="#cb176-772" aria-hidden="true" tabindex="-1"></a>holes <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"holes.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-773"><a href="#cb176-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-774"><a href="#cb176-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-775"><a href="#cb176-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-776"><a href="#cb176-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-777"><a href="#cb176-777" aria-hidden="true" tabindex="-1"></a>In this case, the missing area will not be computed using the default settings of <span class="in">`analyze_objects()`</span>. To include this area as the leaf area, we can use the argument <span class="in">`fill_hull()`</span>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</span>
<span id="cb176-778"><a href="#cb176-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-779"><a href="#cb176-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-780"><a href="#cb176-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10, fig.height =6}</span></span>
<span id="cb176-781"><a href="#cb176-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-782"><a href="#cb176-782" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb176-783"><a href="#cb176-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb176-784"><a href="#cb176-784" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-785"><a href="#cb176-785" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb176-786"><a href="#cb176-786" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb176-787"><a href="#cb176-787" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb176-788"><a href="#cb176-788" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb176-789"><a href="#cb176-789" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-790"><a href="#cb176-790" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-791"><a href="#cb176-791" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb176-792"><a href="#cb176-792" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb176-793"><a href="#cb176-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-794"><a href="#cb176-794" aria-hidden="true" tabindex="-1"></a><span class="co"># fill the missing area</span></span>
<span id="cb176-795"><a href="#cb176-795" aria-hidden="true" tabindex="-1"></a>af2 <span class="ot">&lt;-</span></span>
<span id="cb176-796"><a href="#cb176-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb176-797"><a href="#cb176-797" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span id="cb176-798"><a href="#cb176-798" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-799"><a href="#cb176-799" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb176-800"><a href="#cb176-800" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb176-801"><a href="#cb176-801" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb176-802"><a href="#cb176-802" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb176-803"><a href="#cb176-803" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-804"><a href="#cb176-804" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-805"><a href="#cb176-805" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prefix =</span> <span class="st">"proc2_"</span>,</span>
<span id="cb176-806"><a href="#cb176-806" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb176-807"><a href="#cb176-807" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb176-808"><a href="#cb176-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-809"><a href="#cb176-809" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"proc"</span>, <span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb176-810"><a href="#cb176-810" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb176-811"><a href="#cb176-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-812"><a href="#cb176-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-813"><a href="#cb176-813" aria-hidden="true" tabindex="-1"></a>We can simply use the ratio between <span class="in">`proc_img`</span> and <span class="in">`proc_img2`</span> to compute the injured area in this leaflet.</span>
<span id="cb176-814"><a href="#cb176-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-817"><a href="#cb176-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb176-818"><a href="#cb176-818" aria-hidden="true" tabindex="-1"></a><span class="co"># percent of injuried area</span></span>
<span id="cb176-819"><a href="#cb176-819" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">-</span> <span class="dv">88379</span> <span class="sc">/</span> <span class="dv">99189</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb176-820"><a href="#cb176-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-821"><a href="#cb176-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-822"><a href="#cb176-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-823"><a href="#cb176-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-824"><a href="#cb176-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-825"><a href="#cb176-825" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compound leaves</span></span>
<span id="cb176-826"><a href="#cb176-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-827"><a href="#cb176-827" aria-hidden="true" tabindex="-1"></a>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <span class="in">`analyze_objects()`</span>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</span>
<span id="cb176-828"><a href="#cb176-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-829"><a href="#cb176-829" aria-hidden="true" tabindex="-1"></a>The following images by <span class="co">[</span><span class="ot">Daniel Saueressig</span><span class="co">](https://www.florestaombrofilamista.com.br/sidol/?menu=contact)</span> were obtained from the *Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista*^<span class="co">[</span><span class="ot">https://www.florestaombrofilamista.com.br/sidol/?menu=glossary</span><span class="co">]</span> and show examples of simple and compound leaves.</span>
<span id="cb176-830"><a href="#cb176-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-831"><a href="#cb176-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc1, fig.width=10}</span></span>
<span id="cb176-832"><a href="#cb176-832" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> </span>
<span id="cb176-833"><a href="#cb176-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="fu">c</span>(<span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span>),</span>
<span id="cb176-834"><a href="#cb176-834" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-835"><a href="#cb176-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-836"><a href="#cb176-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-837"><a href="#cb176-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-838"><a href="#cb176-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-839"><a href="#cb176-839" aria-hidden="true" tabindex="-1"></a>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm$^2$. With this information, it is possible to obtain the image resolution with <span class="in">`dpi(simple)`</span>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</span>
<span id="cb176-840"><a href="#cb176-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-841"><a href="#cb176-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc2}</span></span>
<span id="cb176-842"><a href="#cb176-842" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> imgs<span class="sc">$</span>simple.jpg</span>
<span id="cb176-843"><a href="#cb176-843" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(simple, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-844"><a href="#cb176-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-845"><a href="#cb176-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-846"><a href="#cb176-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-847"><a href="#cb176-847" aria-hidden="true" tabindex="-1"></a>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <span class="in">`object_size = "large"`</span> or <span class="in">`watershed = FALSE`</span>, to omit the watershed segmentation algorithm. The last is used here.</span>
<span id="cb176-848"><a href="#cb176-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-849"><a href="#cb176-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-850"><a href="#cb176-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc3}</span></span>
<span id="cb176-851"><a href="#cb176-851" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> </span>
<span id="cb176-852"><a href="#cb176-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(simple,</span>
<span id="cb176-853"><a href="#cb176-853" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-854"><a href="#cb176-854" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb176-855"><a href="#cb176-855" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-856"><a href="#cb176-856" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(sarea, <span class="at">dpi =</span> <span class="fl">48.65</span>)</span>
<span id="cb176-857"><a href="#cb176-857" aria-hidden="true" tabindex="-1"></a>sarea_cor</span>
<span id="cb176-858"><a href="#cb176-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-859"><a href="#cb176-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-860"><a href="#cb176-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-861"><a href="#cb176-861" aria-hidden="true" tabindex="-1"></a>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</span>
<span id="cb176-862"><a href="#cb176-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-863"><a href="#cb176-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc4}</span></span>
<span id="cb176-864"><a href="#cb176-864" aria-hidden="true" tabindex="-1"></a>compound <span class="ot">&lt;-</span> imgs<span class="sc">$</span>compound.jpg</span>
<span id="cb176-865"><a href="#cb176-865" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb176-866"><a href="#cb176-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb176-867"><a href="#cb176-867" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-868"><a href="#cb176-868" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-869"><a href="#cb176-869" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-870"><a href="#cb176-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-871"><a href="#cb176-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-872"><a href="#cb176-872" aria-hidden="true" tabindex="-1"></a>Therefore, using <span class="in">`watershed = FALSE`</span> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</span>
<span id="cb176-873"><a href="#cb176-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-874"><a href="#cb176-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc5}</span></span>
<span id="cb176-875"><a href="#cb176-875" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb176-876"><a href="#cb176-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb176-877"><a href="#cb176-877" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-878"><a href="#cb176-878" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-879"><a href="#cb176-879" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-880"><a href="#cb176-880" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-881"><a href="#cb176-881" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb176-882"><a href="#cb176-882" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(carea, <span class="at">dpi =</span> <span class="fl">49.5</span>)</span>
<span id="cb176-883"><a href="#cb176-883" aria-hidden="true" tabindex="-1"></a>carea_cor</span>
<span id="cb176-884"><a href="#cb176-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-885"><a href="#cb176-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-886"><a href="#cb176-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-887"><a href="#cb176-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-888"><a href="#cb176-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-889"><a href="#cb176-889" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple images of the same sample</span></span>
<span id="cb176-890"><a href="#cb176-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-891"><a href="#cb176-891" aria-hidden="true" tabindex="-1"></a>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<span class="in">`-`</span>) or underscore (<span class="in">`_`</span>). Then, when using <span class="in">` get_measures()`</span>, measurements from leaf images called, for example, <span class="in">`F1-1.jpeg`</span>, <span class="in">`F1_2.jpeg`</span> and <span class="in">`F1-3.jpeg`</span> will be combined into a single image (<span class="in">`F1`</span>), displayed in the <span class="in">`merge`</span> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</span>
<span id="cb176-892"><a href="#cb176-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-893"><a href="#cb176-893" aria-hidden="true" tabindex="-1"></a>In the following example, five images will be used as examples. Each image has leaves of different species. The images have been split into different images that share the same prefix (eg L1_<span class="sc">\*</span>, L2_<span class="sc">\*</span>, and so on). Note that to ensure that all images are processed, all images must share a common pattern, in this case (<span class="in">`"L"`</span>). The three dots in the lower right corner have a known distance of 5 cm between them, which can be used to extract the dpi of the image with <span class="in">`dpi()`</span>. For teaching purposes only, I will assume that all images are 100 dpi resolution .</span>
<span id="cb176-894"><a href="#cb176-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-895"><a href="#cb176-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-896"><a href="#cb176-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge0, fig.width = 10, fig.height = 10}</span></span>
<span id="cb176-897"><a href="#cb176-897" aria-hidden="true" tabindex="-1"></a><span class="co"># entire images</span></span>
<span id="cb176-898"><a href="#cb176-898" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span></span>
<span id="cb176-899"><a href="#cb176-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"leaf"</span>,</span>
<span id="cb176-900"><a href="#cb176-900" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-901"><a href="#cb176-901" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb176-902"><a href="#cb176-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-903"><a href="#cb176-903" aria-hidden="true" tabindex="-1"></a><span class="co"># images of the same sample</span></span>
<span id="cb176-904"><a href="#cb176-904" aria-hidden="true" tabindex="-1"></a>sample_imgs <span class="ot">&lt;-</span></span>
<span id="cb176-905"><a href="#cb176-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"L"</span>,</span>
<span id="cb176-906"><a href="#cb176-906" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-907"><a href="#cb176-907" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb176-908"><a href="#cb176-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-909"><a href="#cb176-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-910"><a href="#cb176-910" aria-hidden="true" tabindex="-1"></a>Here, I will use the <span class="in">`pattern = "L"`</span> to indicate that all images with this pattern name should be merged. The green index (<span class="in">`"G"`</span>) is used to segment the leaves and <span class="in">`watershed = FALSE`</span> is used to omit the watershed segmentation algorithm.</span>
<span id="cb176-911"><a href="#cb176-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-912"><a href="#cb176-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-913"><a href="#cb176-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge1}</span></span>
<span id="cb176-914"><a href="#cb176-914" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span></span>
<span id="cb176-915"><a href="#cb176-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"L"</span>,</span>
<span id="cb176-916"><a href="#cb176-916" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb176-917"><a href="#cb176-917" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-918"><a href="#cb176-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-919"><a href="#cb176-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-920"><a href="#cb176-920" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`get_measures()`</span> function it is possible to convert measurements from pixel units to metric units(cm$^ 2$).</span>
<span id="cb176-921"><a href="#cb176-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-922"><a href="#cb176-922" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge2}</span></span>
<span id="cb176-923"><a href="#cb176-923" aria-hidden="true" tabindex="-1"></a>merged_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(merged, <span class="at">dpi =</span> <span class="dv">100</span>)</span>
<span id="cb176-924"><a href="#cb176-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-925"><a href="#cb176-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-926"><a href="#cb176-926" aria-hidden="true" tabindex="-1"></a>Note that the  merged_cor` is a list with three objects:</span>
<span id="cb176-927"><a href="#cb176-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-928"><a href="#cb176-928" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`results`</span>: a data frame that contains the measurements of each individual object (in this case, leaf) of each analyzed image.</span>
<span id="cb176-929"><a href="#cb176-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-930"><a href="#cb176-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge3}</span></span>
<span id="cb176-931"><a href="#cb176-931" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>results</span>
<span id="cb176-932"><a href="#cb176-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-933"><a href="#cb176-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-934"><a href="#cb176-934" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`summary`</span> : a data frame that contains the summary of the results, containing the number of objects in each image (<span class="in">`n`</span>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</span>
<span id="cb176-935"><a href="#cb176-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-936"><a href="#cb176-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-937"><a href="#cb176-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge4}</span></span>
<span id="cb176-938"><a href="#cb176-938" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>summary</span>
<span id="cb176-939"><a href="#cb176-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-940"><a href="#cb176-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-941"><a href="#cb176-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-942"><a href="#cb176-942" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`merge`</span>: a data frame that contains the results merged by image prefix. Note that in this case the results are displayed by L1, L2, L3, L4 and L5.</span>
<span id="cb176-943"><a href="#cb176-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-944"><a href="#cb176-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge5}</span></span>
<span id="cb176-945"><a href="#cb176-945" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>merge</span>
<span id="cb176-946"><a href="#cb176-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-947"><a href="#cb176-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-948"><a href="#cb176-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-949"><a href="#cb176-949" aria-hidden="true" tabindex="-1"></a>The <span class="in">` area_sum`</span> of img <span class="in">`L1`</span> is the sum of the two sheets (one in each image).</span>
<span id="cb176-950"><a href="#cb176-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-951"><a href="#cb176-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge6}</span></span>
<span id="cb176-952"><a href="#cb176-952" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged_cor<span class="sc">$</span>results<span class="sc">$</span>area [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb176-953"><a href="#cb176-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-954"><a href="#cb176-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-955"><a href="#cb176-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-956"><a href="#cb176-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-957"><a href="#cb176-957" aria-hidden="true" tabindex="-1"></a>Below, I will create a plot to show the distribution of leaf area  </span>
<span id="cb176-958"><a href="#cb176-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-959"><a href="#cb176-959" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge9, fig.width =10, fig.height =5}</span></span>
<span id="cb176-960"><a href="#cb176-960" aria-hidden="true" tabindex="-1"></a>df_leaf <span class="ot">&lt;-</span></span>
<span id="cb176-961"><a href="#cb176-961" aria-hidden="true" tabindex="-1"></a>  merged_cor<span class="sc">$</span>results <span class="sc">%&gt;%</span></span>
<span id="cb176-962"><a href="#cb176-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(img , <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"img"</span>, <span class="st">"code"</span>))</span>
<span id="cb176-963"><a href="#cb176-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-964"><a href="#cb176-964" aria-hidden="true" tabindex="-1"></a><span class="co"># leaf area of the different species</span></span>
<span id="cb176-965"><a href="#cb176-965" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb176-966"><a href="#cb176-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_leaf, <span class="fu">aes</span>(img, area)) <span class="sc">+</span></span>
<span id="cb176-967"><a href="#cb176-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb176-968"><a href="#cb176-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb176-969"><a href="#cb176-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">" Image "</span>, <span class="at">y =</span> <span class="fu">expression</span>(Area <span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb176-970"><a href="#cb176-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-971"><a href="#cb176-971" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb176-972"><a href="#cb176-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_leaf , <span class="fu">aes</span>(<span class="at">x =</span> img , <span class="at">y =</span> area)) <span class="sc">+</span></span>
<span id="cb176-973"><a href="#cb176-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> sum,</span>
<span id="cb176-974"><a href="#cb176-974" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"bar"</span>,</span>
<span id="cb176-975"><a href="#cb176-975" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">" black "</span>) <span class="sc">+</span></span>
<span id="cb176-976"><a href="#cb176-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">" Image "</span>, <span class="at">y =</span> <span class="fu">expression</span>(Total<span class="sc">~</span>area <span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb176-977"><a href="#cb176-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-978"><a href="#cb176-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-979"><a href="#cb176-979" aria-hidden="true" tabindex="-1"></a><span class="co"># solidity of the different species</span></span>
<span id="cb176-980"><a href="#cb176-980" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb176-981"><a href="#cb176-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_leaf , <span class="fu">aes</span>(<span class="at">x =</span> img , <span class="at">y =</span> solidity)) <span class="sc">+</span></span>
<span id="cb176-982"><a href="#cb176-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb176-983"><a href="#cb176-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb176-984"><a href="#cb176-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Image"</span>, <span class="at">y =</span> <span class="st">"Solidity"</span>)</span>
<span id="cb176-985"><a href="#cb176-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-986"><a href="#cb176-986" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span></span>
<span id="cb176-987"><a href="#cb176-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb176-988"><a href="#cb176-988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb176-989"><a href="#cb176-989" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</section></section><div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1" role="doc-endnote"><p>Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019–1028. doi: 10.1016/0031-3203(93)90003-F.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed.&nbsp;World Scientific.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Claude, J. 2008. Morphometrics with R. Springer.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Lee, Y., and W. Lim. 2017. Fórmula de cadarço: conectando a área de um polígono e o produto vetorial vetorial. The Mathematics Teacher 110(8): 631–636. doi: 10.5951/MATHTEACHER.110.8.0631.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394–396. doi: 10.1109/TSMC.1974.5408463.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610–621. doi: 10.1109/TSMC.1973.4309314<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>https://www.florestaombrofilamista.com.br/sidol/?menu=glossary<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02_segment.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Segment objects</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_phytopathometry.html" class="pagination-link">
        <span class="nav-page-text">Phytopathometry</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">A brief tutorial on {pliman} R package</div>   
    <div class="nav-footer-right">Prof.&nbsp;Dr.&nbsp;Tiago Olivoto FIT/CCA/UFSC</div>
  </div>
</footer>


</body></html>