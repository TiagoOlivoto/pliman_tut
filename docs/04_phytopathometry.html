<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.205">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R package {pliman} - Phytopathometry</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_analyze.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    null
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R package {pliman}</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./00_about.html" rel="" target=""><i class="bi bi-fa fa-home" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto" rel="" target=""><i class="bi bi-fab fa-researchgate fa" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TiagoOlivoto/pliman" rel="" target=""><i class="bi bi-bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tolivoto" rel="" target=""><i class="bi bi-bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/" rel="" target=""><i class="bi bi-fab fa-mendeley fa" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04_phytopathometry.html">Phytopathometry</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_manipulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import and manipulate</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_segment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Segment objects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_analyze.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyze objects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_phytopathometry.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Phytopathometry</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">In this page</h2>
   
  <ul>
<li><a href="#directory" id="toc-directory" class="nav-link active" data-scroll-target="#directory"><span class="header-section-number">1</span> Directory</a></li>
  <li><a href="#disease-severity" id="toc-disease-severity" class="nav-link" data-scroll-target="#disease-severity"><span class="header-section-number">2</span> Disease severity</a></li>
  <li><a href="#using-image-indexes" id="toc-using-image-indexes" class="nav-link" data-scroll-target="#using-image-indexes"><span class="header-section-number">3</span> Using image indexes</a></li>
  <li>
<a href="#using-sample-palettes" id="toc-using-sample-palettes" class="nav-link" data-scroll-target="#using-sample-palettes"><span class="header-section-number">4</span> Using sample palettes</a>
  <ul class="collapse">
<li>
<a href="#producing-sample-palettes" id="toc-producing-sample-palettes" class="nav-link" data-scroll-target="#producing-sample-palettes"><span class="header-section-number">4.1</span> Producing sample palettes</a>
  <ul class="collapse">
<li><a href="#defaults-settings" id="toc-defaults-settings" class="nav-link" data-scroll-target="#defaults-settings"><span class="header-section-number">4.1.1</span> Defaults settings</a></li>
  <li><a href="#filling-lesions" id="toc-filling-lesions" class="nav-link" data-scroll-target="#filling-lesions"><span class="header-section-number">4.1.2</span> Filling lesions</a></li>
  <li><a href="#showing-a-mask" id="toc-showing-a-mask" class="nav-link" data-scroll-target="#showing-a-mask"><span class="header-section-number">4.1.3</span> Showing a mask</a></li>
  <li><a href="#segmenting-and-analyzing-lesions" id="toc-segmenting-and-analyzing-lesions" class="nav-link" data-scroll-target="#segmenting-and-analyzing-lesions"><span class="header-section-number">4.1.4</span> Segmenting and analyzing lesions</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#batch-processing" id="toc-batch-processing" class="nav-link" data-scroll-target="#batch-processing"><span class="header-section-number">5</span> Batch processing</a></li>
  <li><a href="#standard-area-diagrams" id="toc-standard-area-diagrams" class="nav-link" data-scroll-target="#standard-area-diagrams"><span class="header-section-number">6</span> Standard area diagrams</a></li>
  <li><a href="#parallel-processing" id="toc-parallel-processing" class="nav-link" data-scroll-target="#parallel-processing"><span class="header-section-number">7</span> Parallel processing</a></li>
  <li><a href="#multiple-images-of-the-same-sample" id="toc-multiple-images-of-the-same-sample" class="nav-link" data-scroll-target="#multiple-images-of-the-same-sample"><span class="header-section-number">8</span> Multiple images of the same sample</a></li>
  <li>
<a href="#multiple-leaves-in-one-image" id="toc-multiple-leaves-in-one-image" class="nav-link" data-scroll-target="#multiple-leaves-in-one-image"><span class="header-section-number">9</span> Multiple leaves in one image</a>
  <ul class="collapse">
<li><a href="#segment-by-color" id="toc-segment-by-color" class="nav-link" data-scroll-target="#segment-by-color"><span class="header-section-number">9.1</span> Segment by color</a></li>
  <li><a href="#segment-by-shape" id="toc-segment-by-shape" class="nav-link" data-scroll-target="#segment-by-shape"><span class="header-section-number">9.2</span> Segment by shape</a></li>
  </ul>
</li>
  <li><a href="#interactive-disease-measurements" id="toc-interactive-disease-measurements" class="nav-link" data-scroll-target="#interactive-disease-measurements"><span class="header-section-number">10</span> Interactive disease measurements</a></li>
  <li><a href="#more-than-two-classes" id="toc-more-than-two-classes" class="nav-link" data-scroll-target="#more-than-two-classes"><span class="header-section-number">11</span> More than two classes</a></li>
  <li><a href="#a-little-gift" id="toc-a-little-gift" class="nav-link" data-scroll-target="#a-little-gift"><span class="header-section-number">12</span> A little gift</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Phytopathometry</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="directory" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Directory</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="disease-severity" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Disease severity</h1>
</section><section id="using-image-indexes" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Using image indexes</h1>
<p>The following image<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> shows symptoms of anthracnose (<em>Elsinoë ampelina</em>) on grape leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"videira.png"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                  index_lb <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>                  index_dh <span class="op">=</span> <span class="st">"G-R"</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span><span class="op">$</span><span class="va">severity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   healthy symptomatic
1 83.31858    16.68142</code></pre>
</div>
</div>
</section><section id="using-sample-palettes" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Using sample palettes</h1>
<p>Sample palettes can be made by simply manually sampling small areas of representative images and producing a composite image that will represent each of the desired classes (background, healthy, and symptomatic tissues).</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"videira_h.png"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"videira_d.png"</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"videira_b.png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">h</span>, <span class="va">d</span>, <span class="va">b</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/doença1-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<section id="producing-sample-palettes" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="producing-sample-palettes">
<span class="header-section-number">4.1</span> Producing sample palettes</h2>
<p>Users can produce these palettes with <code><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">h2</span>, <span class="va">d2</span>, <span class="va">b2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="defaults-settings" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="defaults-settings">
<span class="header-section-number">4.1.1</span> Defaults settings</h3>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">img</span>,</span>
<span>                  img_healthy <span class="op">=</span> <span class="va">h</span>,</span>
<span>                  img_symptoms <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  img_background <span class="op">=</span> <span class="va">b</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span><span class="op">$</span><span class="va">severity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  healthy symptomatic
1  85.309      14.691</code></pre>
</div>
</div>
</section><section id="filling-lesions" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored" data-anchor-id="filling-lesions">
<span class="header-section-number">4.1.2</span> Filling lesions</h3>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">img</span>,</span>
<span>                  img_healthy <span class="op">=</span> <span class="va">h</span>,</span>
<span>                  img_symptoms <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  img_background <span class="op">=</span> <span class="va">b</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="showing-a-mask" class="level3" data-number="4.1.3"><h3 data-number="4.1.3" class="anchored" data-anchor-id="showing-a-mask">
<span class="header-section-number">4.1.3</span> Showing a mask</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">img</span>,</span>
<span>                  img_healthy <span class="op">=</span> <span class="va">h</span>,</span>
<span>                  img_symptoms <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  img_background <span class="op">=</span> <span class="va">b</span>,</span>
<span>                  show_original <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_lesions <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span> <span class="co"># default is "black"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="segmenting-and-analyzing-lesions" class="level3" data-number="4.1.4"><h3 data-number="4.1.4" class="anchored" data-anchor-id="segmenting-and-analyzing-lesions">
<span class="header-section-number">4.1.4</span> Segmenting and analyzing lesions</h3>
<p>When using <code>show_features = TRUE</code>, the function analyzes the lesions and returns results such as number of lesions, area, perimeter, etc. With <code>show_segmentation = TRUE</code>, segmented lesions are shown.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>img <span class="op">=</span> <span class="va">img</span>,</span>
<span>                  img_healthy <span class="op">=</span> <span class="va">h</span>,</span>
<span>                  img_symptoms <span class="op">=</span> <span class="va">d</span>,</span>
<span>                  img_background <span class="op">=</span> <span class="va">b</span>,</span>
<span>                  show_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correct the measures (dpi = 150)</span></span>
<span><span class="va">sev_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">sev</span>, dpi <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="batch-processing" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Batch processing</h1>
<p>To analyze several images from a directory, use the <code>pattern</code> argument to declare a pattern of filenames. Here, we Will used 50 soybean leaves available in the repository https://osf.io/4hbr6, a database of images of annotation of severity of plant diseases. Thanks to <a href="https://osf.io/jb6yd/">Emerson M. Del Ponte</a> and his contributors for keeping this project publicly available. Using the <code>save_image = TRUE</code> argument we save the processed images in a temporary directory, defined by <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># criar um diretório temporário</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">sev_lote</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"soy"</span>,</span>
<span>                    img_healthy <span class="op">=</span> <span class="st">"soja_h"</span>,</span>
<span>                    img_symptoms <span class="op">=</span> <span class="st">"soja_s"</span>,</span>
<span>                    img_background <span class="op">=</span> <span class="st">"soja_b"</span>,</span>
<span>                    plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                    save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    dir_processed <span class="op">=</span> <span class="va">temp_dir</span>,</span>
<span>                    show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    col_lesions <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_1 |=                                        | 2% 00:00:00 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_10 |==                                      | 4% 00:00:03 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_11 |==                                      | 6% 00:00:06 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_12 |===                                     | 8% 00:00:08 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_13 |====                                    | 10% 00:00:11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_14 |=====                                   | 12% 00:00:13 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_15 |======                                  | 14% 00:00:15 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_16 |======                                  | 16% 00:00:16 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_17 |=======                                 | 18% 00:00:19 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_18 |========                                | 20% 00:00:21 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_19 |=========                               | 22% 00:00:24 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_2 |==========                               | 24% 00:00:26 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_20 |==========                              | 26% 00:00:27 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_21 |===========                             | 28% 00:00:30 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_22 |============                            | 30% 00:00:32 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_23 |=============                           | 32% 00:00:33 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_24 |==============                          | 34% 00:00:34 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_25 |==============                          | 36% 00:00:38 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_26 |===============                         | 38% 00:00:40 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_27 |================                        | 40% 00:00:42 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_28 |=================                       | 42% 00:00:45 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_29 |==================                      | 44% 00:00:48 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_3 |===================                      | 46% 00:00:50 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_30 |===================                     | 48% 00:00:52 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_31 |====================                    | 50% 00:00:53 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_32 |=====================                   | 52% 00:00:54 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_33 |======================                  | 54% 00:00:56 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_34 |======================                  | 56% 00:00:59 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_35 |=======================                 | 58% 00:01:01 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_36 |========================                | 60% 00:01:03 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_37 |=========================               | 62% 00:01:05 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_38 |==========================              | 64% 00:01:07 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_39 |==========================              | 66% 00:01:08 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_4 |============================             | 68% 00:01:11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_40 |============================            | 70% 00:01:12 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_41 |=============================           | 72% 00:01:13 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_42 |==============================          | 74% 00:01:16 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_43 |==============================          | 76% 00:01:18 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_44 |===============================         | 78% 00:01:19 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_45 |================================        | 80% 00:01:22 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_46 |=================================       | 82% 00:01:24 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_47 |==================================      | 84% 00:01:26 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_48 |==================================      | 86% 00:01:27 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_49 |===================================     | 88% 00:01:29 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_5 |=====================================    | 90% 00:01:31 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_50 |=====================================   | 92% 00:01:32 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_6 |=======================================  | 94% 00:01:35 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_7 |=======================================  | 96% 00:01:36 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_8 |======================================== | 98% 00:01:37 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image soy_9 |=========================================| 100% 00:01:39 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
    80.78      9.00    101.32 </code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev_lote</span><span class="op">$</span><span class="va">severity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      img  healthy symptomatic
1   soy_1 92.77348   7.2265174
2  soy_10 52.30633  47.6936705
3  soy_11 89.78384  10.2161575
4  soy_12 65.11670  34.8832993
5  soy_13 52.36539  47.6346092
6  soy_14 99.69690   0.3030963
7  soy_15 70.29044  29.7095575
8  soy_16 29.90606  70.0939369
9  soy_17 21.09925  78.9007548
10 soy_18 81.65725  18.3427485
11 soy_19 39.64060  60.3594041
12  soy_2 85.72200  14.2780038
13 soy_20 33.87098  66.1290170
14 soy_21 33.93214  66.0678631
15 soy_22 75.95096  24.0490393
16 soy_23 59.72758  40.2724205
17 soy_24 73.65542  26.3445771
18 soy_25 10.48656  89.5134444
19 soy_26 30.90999  69.0900129
20 soy_27 33.49553  66.5044714
21 soy_28 53.91191  46.0880904
22 soy_29 24.22248  75.7775163
23  soy_3 17.13340  82.8666047
24 soy_30 43.95521  56.0447894
25 soy_31 13.53385  86.4661545
26 soy_32 45.77103  54.2289682
27 soy_33 89.78882  10.2111778
28 soy_34 47.46044  52.5395591
29 soy_35 60.80857  39.1914277
30 soy_36 94.80937   5.1906344
31 soy_37 35.32374  64.6762642
32 soy_38 54.41359  45.5864088
33 soy_39 40.33488  59.6651237
34  soy_4 66.71393  33.2860690
35 soy_40 66.74647  33.2535340
36 soy_41 97.03763   2.9623742
37 soy_42 87.26385  12.7361490
38 soy_43 90.78369   9.2163109
39 soy_44 58.44983  41.5501685
40 soy_45 84.39995  15.6000476
41 soy_46 83.73092  16.2690840
42 soy_47 78.28876  21.7112445
43 soy_48 74.91738  25.0826239
44 soy_49 70.59905  29.4009499
45  soy_5 79.95357  20.0464273
46 soy_50 56.30231  43.6976924
47  soy_6 64.58105  35.4189485
48  soy_7 58.76635  41.2336531
49  soy_8 45.32267  54.6773292
50  soy_9 80.82006  19.1799446</code></pre>
</div>
</div>
</section><section id="standard-area-diagrams" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Standard area diagrams</h1>
<p>Standard area diagrams (SAD) have long been used as a tool to aid the estimation of plant disease severity, serving as a standard reference template before or during the assessments. Given an object computed with <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease()</a></code> a Standard Area Diagram (SAD) with <code>n</code> images containing the respective severity values are obtained with <code><a href="https://rdrr.io/pkg/pliman/man/sad.html">sad()</a></code>.</p>
<p>Leaves with the smallest and highest severity will always be in the SAD. If <code>n = 1</code>, the leaf with the smallest severity will be returned. The others are sampled sequentially to achieve the n images after severity has been ordered in ascending order. For example, if there are 30 leaves and n is set to 3, the leaves sampled will be the 1st, 15th, and 30th with the smallest severity values.</p>
<p>The SAD can be only computed if an image pattern name is used in argument <code>pattern</code> of <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease()</a></code>. If the images are saved, the <code>n</code> images will be retrevied from <code>dir_processed</code> directory. Otherwise, the severity will be computed again to generate the images. A SAD with 8 images from the above example can be obtained easely with:</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/sad.html">sad</a></span><span class="op">(</span><span class="va">sev_lote</span>, n <span class="op">=</span> <span class="fl">9</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      img  healthy symptomatic rank
6  soy_14 99.69690   0.3030963    1
3  soy_11 89.78384  10.2161575    7
50  soy_9 80.82006  19.1799446   13
44 soy_49 70.59905  29.4009499   19
29 soy_35 60.80857  39.1914277   25
21 soy_28 53.91191  46.0880904   31
24 soy_30 43.95521  56.0447894   37
20 soy_27 33.49553  66.5044714   43
18 soy_25 10.48656  89.5134444   50</code></pre>
</div>
</div>
</section><section id="parallel-processing" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Parallel processing</h1>
<p>To speed up processing time when multiple images are available, you can use the <code>paralell</code> argument. In parallel programming (<code>parallel = TRUE</code>), the images are processed asynchronously (in parallel) in separate R sessions running in the background on the same machine. The number of sections is set by default to 50% of available cores. This number can be controlled explicitly with the argument workers.</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">sev_lote</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"soy"</span>,</span>
<span>                    img_healthy <span class="op">=</span> <span class="st">"soja_h"</span>,</span>
<span>                    img_symptoms <span class="op">=</span> <span class="st">"soja_s"</span>,</span>
<span>                    img_background <span class="op">=</span> <span class="st">"soja_b"</span>,</span>
<span>                    plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                    parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     0.58      0.16     63.74 </code></pre>
</div>
</div>
</section><section id="multiple-images-of-the-same-sample" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Multiple images of the same sample</h1>
<p>If users need to analyze multiple images from the same sample, the images from the same sample must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<code>-</code>) or underscore (<code>_</code>).</p>
<p>In the following example, 16 images will be used as examples. Here, they represent four replicates of four different treatments (<code>TRAT1_1, TRAT1_2, ..., TRAT4_4</code>). Note that to ensure that all images are processed, all images must share a common pattern, in this case (<code>"TRAT"</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">sev_trats</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"TRAT"</span>,</span>
<span>                    img_healthy <span class="op">=</span> <span class="st">"feijao_h"</span>,</span>
<span>                    img_symptoms <span class="op">=</span> <span class="st">"feijao_s"</span>,</span>
<span>                    img_background <span class="op">=</span> <span class="st">"feijao_b"</span>,</span>
<span>                    show_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                    parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     0.37      0.11     40.99 </code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sev</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">sev_trats</span><span class="op">$</span><span class="va">severity</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/separate_col.html">separate_col</a></span><span class="op">(</span><span class="va">img</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TRAT"</span>, <span class="st">"REP"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sev</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">TRAT</span>, <span class="va">symptomatic</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tratamentos"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Severidade (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="multiple-leaves-in-one-image" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Multiple leaves in one image</h1>
<section id="segment-by-color" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="segment-by-color">
<span class="header-section-number">9.1</span> Segment by color</h2>
<p>When multiple leaves are present in an image, the <code>measure_disease</code> function returns the average severity of the leaves present in the image. To quantify the severity <em>per leaf</em>, the <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease_byl.html">measure_disease_byl()</a></code> function can be used.</p>
<p>This function computes the percentage of symptomatic leaf area using color palettes or RGB indices for each leaf (<code>byl</code>) of an image. This allows, for example, to process replicates of the same treatment and obtain the results of each replication with a single image. To do this, the sample sheets are first split using the <code><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split()</a></code> function and then the <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease()</a></code> function is applied to the sheet list.</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">byl</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease_byl.html">measure_disease_byl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"multiplas_02"</span>,</span>
<span>                      index <span class="op">=</span> <span class="st">"B"</span>, <span class="co"># used to segment leaves from background</span></span>
<span>                      img_healthy <span class="op">=</span> <span class="st">"soja_h"</span>,</span>
<span>                      img_symptoms <span class="op">=</span> <span class="st">"soja_s"</span>,</span>
<span>                      show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      show_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      col_lesions <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                      parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results_byl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">byl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_byl</span><span class="op">$</span><span class="va">results</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           img leaf id       mx        my area perimeter radius_mean radius_min
1 multiplas_02    1  1 171.2667  80.32549   62  40.97056     4.90362    1.09451
2 multiplas_02    1  2 236.4953 102.94576  520 126.39697    13.72704    2.64672
3 multiplas_02    1  3 135.8283 100.38182  100  36.55635     5.21944    3.54338
4 multiplas_02    1  4 196.3157 128.99638 1196 209.65180    19.48381    5.27639
5 multiplas_02    1  6 155.3493 129.39204  397 121.81118    10.88886    1.10118
6 multiplas_02    1  8 219.5256 115.18590   39  26.31371     2.98820    0.95833
  radius_max radius_sd diam_mean diam_min diam_max maj_axis min_axis   length
1    8.89021   2.30936   9.80723  2.18902 17.78042  5.18036  1.54865 16.46903
2   23.92081   5.14020  27.45408  5.29344 47.84162 13.16349  6.42927 43.98674
3    6.87184   0.99468  10.43889  7.08676 13.74369  4.32261  3.08497 13.15289
4   31.61094   7.09368  38.96762 10.55278 63.22188 17.41109 11.24782 60.57374
5   19.01536   4.12090  21.77773  2.20237 38.03073  9.58203  6.60092 33.93652
6    4.49092   0.90059   5.97640  1.91667  8.98185  2.37612  2.01511  8.22970
     width
1  5.75413
2 22.97408
3  8.67840
4 41.21600
5 24.09180
6  6.02056</code></pre>
</div>
</div>
</section><section id="segment-by-shape" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="segment-by-shape">
<span class="header-section-number">9.2</span> Segment by shape</h2>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"disease_shp.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">byl2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease_shp.html">measure_disease_shp</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                      filter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                      ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                      nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                      index_lb <span class="op">=</span> <span class="st">"HUE2"</span>,</span>
<span>                      index_dh <span class="op">=</span> <span class="st">"NGRDI"</span>,</span>
<span>                      threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Otsu"</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">byl2</span><span class="op">$</span><span class="va">shapefiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">byl2</span>, measure <span class="op">=</span> <span class="st">"symptomatic"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="interactive-disease-measurements" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Interactive disease measurements</h1>
<p>An alternative approach to measuring disease percentage is available through the <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease_iter()</a></code> function. This function offers an interactive interface that empowers users to manually select sample colors directly from the image. By doing so, it provides a highly customizable analysis method.</p>
<p>One advantage of using <code><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease_iter()</a></code> is the ability to utilize the “mapview” viewer, which enhances the analysis process by offering zoom-in options. This feature allows users to closely examine specific areas of the image, enabling detailed inspection and accurate disease measurement.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"sev_leaf.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/measure_disease.html">measure_disease_iter</a></span><span class="op">(</span><span class="va">img</span>, viewer <span class="op">=</span> <span class="st">"mapview"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="imgs/gif_severity.gif" class="img-fluid"></p>
</section><section id="more-than-two-classes" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> More than two classes</h1>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"sev_leaf.jpg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_segment.html">image_segment_iter</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                   nseg <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"NGRDI"</span>, <span class="st">"G-B"</span><span class="op">)</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     image pixels   percent
1 original 818790 100.00000
2     seg1 462912  56.53611
3     seg2  89493  19.33262
4     seg3  27750  31.00801</code></pre>
</div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="a-little-gift" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> A little gift</h1>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fungo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"fungo.jpeg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">fungo</span>, </span>
<span>                  index <span class="op">=</span> <span class="st">"HUE"</span>,</span>
<span>                  invert <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">res</span>, dpi <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="st">"area"</span>, </span>
<span>                col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04_phytopathometry_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The segmentation can also be performed using sample palettes representing the foreground and background. In this example, pick the color samples, then use them in the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette</a></span><span class="op">(</span><span class="va">fungo</span><span class="op">)</span></span>
<span><span class="va">fore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pick.html">pick_palette</a></span><span class="op">(</span><span class="va">fungo</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">fungo</span>,</span>
<span>                  background <span class="op">=</span> <span class="va">back</span>,</span>
<span>                  foreground <span class="op">=</span> <span class="va">fore</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">res</span>, dpi <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">meas</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Fonte: <a href="http://gazeta-rs.com.br/as-principais-doencas-da-videira-na-primavera/#prettyPhoto" class="uri">http://gazeta-rs.com.br/as-principais-doencas-da-videira-na-primavera/#prettyPhoto</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></aside></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03_analyze.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Analyze objects</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb88" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Phytopathometry"</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include = FALSE}</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Directory</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># Disease severity</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Using image indexes</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>The following image<span class="ot">[^1]</span> shows symptoms of anthracnose (*Elsinoë ampelina*) on grape leaves.</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Fonte: <span class="ot">&lt;http://gazeta-rs.com.br/as-principais-doencas-da-videira-na-primavera/#prettyPhoto&gt;</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"videira.png"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(img,</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index_lb =</span> <span class="st">"G"</span>,</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index_dh =</span> <span class="st">"G-R"</span>,</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>sev<span class="sc">$</span>severity</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a><span class="fu"># Using sample palettes</span></span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>Sample palettes can be made by simply manually sampling small areas of representative images and producing a composite image that will represent each of the desired classes (background, healthy, and symptomatic tissues).</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r doença1, fig.width = 12, fig.height = 3}</span></span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"videira_h.png"</span>)</span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"videira_d.png"</span>)</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"videira_b.png"</span>)</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(img, h, d, b, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Producing sample palettes</span></span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>Users can produce these palettes with <span class="in">`pick_palette()`</span> function.</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE, fig.width=10}</span></span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">pick_palette</span>(img)</span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">pick_palette</span>(img)</span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">pick_palette</span>(img)</span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(h2, d2, b2, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defaults settings</span></span>
<span id="cb88-67"><a href="#cb88-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-70"><a href="#cb88-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-71"><a href="#cb88-71" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-72"><a href="#cb88-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb88-73"><a href="#cb88-73" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> h,</span>
<span id="cb88-74"><a href="#cb88-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> d,</span>
<span id="cb88-75"><a href="#cb88-75" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> b)</span>
<span id="cb88-76"><a href="#cb88-76" aria-hidden="true" tabindex="-1"></a>sev<span class="sc">$</span>severity</span>
<span id="cb88-77"><a href="#cb88-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-78"><a href="#cb88-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-79"><a href="#cb88-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-80"><a href="#cb88-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filling lesions</span></span>
<span id="cb88-81"><a href="#cb88-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-84"><a href="#cb88-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-85"><a href="#cb88-85" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-86"><a href="#cb88-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb88-87"><a href="#cb88-87" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> h,</span>
<span id="cb88-88"><a href="#cb88-88" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> d,</span>
<span id="cb88-89"><a href="#cb88-89" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> b,</span>
<span id="cb88-90"><a href="#cb88-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-91"><a href="#cb88-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-92"><a href="#cb88-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-93"><a href="#cb88-93" aria-hidden="true" tabindex="-1"></a><span class="fu">### Showing a mask</span></span>
<span id="cb88-94"><a href="#cb88-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-97"><a href="#cb88-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-98"><a href="#cb88-98" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-99"><a href="#cb88-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb88-100"><a href="#cb88-100" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> h,</span>
<span id="cb88-101"><a href="#cb88-101" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> d,</span>
<span id="cb88-102"><a href="#cb88-102" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> b,</span>
<span id="cb88-103"><a href="#cb88-103" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_original =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-104"><a href="#cb88-104" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_lesions =</span> <span class="st">"brown"</span>) <span class="co"># default is "black"</span></span>
<span id="cb88-105"><a href="#cb88-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-106"><a href="#cb88-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-107"><a href="#cb88-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### Segmenting and analyzing lesions</span></span>
<span id="cb88-108"><a href="#cb88-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-109"><a href="#cb88-109" aria-hidden="true" tabindex="-1"></a>When using <span class="in">`show_features = TRUE`</span>, the function analyzes the lesions and returns results such as number of lesions, area, perimeter, etc. With <span class="in">`show_segmentation = TRUE`</span>, segmented lesions are shown.</span>
<span id="cb88-110"><a href="#cb88-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-113"><a href="#cb88-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-114"><a href="#cb88-114" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-115"><a href="#cb88-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb88-116"><a href="#cb88-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> h,</span>
<span id="cb88-117"><a href="#cb88-117" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> d,</span>
<span id="cb88-118"><a href="#cb88-118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> b,</span>
<span id="cb88-119"><a href="#cb88-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_features =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-120"><a href="#cb88-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-121"><a href="#cb88-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-122"><a href="#cb88-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-123"><a href="#cb88-123" aria-hidden="true" tabindex="-1"></a><span class="co"># correct the measures (dpi = 150)</span></span>
<span id="cb88-124"><a href="#cb88-124" aria-hidden="true" tabindex="-1"></a>sev_corrected <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(sev, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb88-125"><a href="#cb88-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-126"><a href="#cb88-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-127"><a href="#cb88-127" aria-hidden="true" tabindex="-1"></a><span class="fu"># Batch processing</span></span>
<span id="cb88-128"><a href="#cb88-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-129"><a href="#cb88-129" aria-hidden="true" tabindex="-1"></a>To analyze several images from a directory, use the <span class="in">`pattern`</span> argument to declare a pattern of filenames. Here, we Will used 50 soybean leaves available in the repository https://osf.io/4hbr6, a database of images of annotation of severity of plant diseases. Thanks to <span class="co">[</span><span class="ot">Emerson M. Del Ponte</span><span class="co">](https://osf.io/jb6yd/)</span> and his contributors for keeping this project publicly available. Using the <span class="in">`save_image = TRUE`</span> argument we save the processed images in a temporary directory, defined by <span class="in">`tempdir()`</span>.</span>
<span id="cb88-130"><a href="#cb88-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-133"><a href="#cb88-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-134"><a href="#cb88-134" aria-hidden="true" tabindex="-1"></a><span class="co"># criar um diretório temporário</span></span>
<span id="cb88-135"><a href="#cb88-135" aria-hidden="true" tabindex="-1"></a>temp_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb88-136"><a href="#cb88-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-137"><a href="#cb88-137" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb88-138"><a href="#cb88-138" aria-hidden="true" tabindex="-1"></a>  sev_lote <span class="ot">&lt;-</span> </span>
<span id="cb88-139"><a href="#cb88-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">"soy"</span>,</span>
<span id="cb88-140"><a href="#cb88-140" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_healthy =</span> <span class="st">"soja_h"</span>,</span>
<span id="cb88-141"><a href="#cb88-141" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_symptoms =</span> <span class="st">"soja_s"</span>,</span>
<span id="cb88-142"><a href="#cb88-142" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_background =</span> <span class="st">"soja_b"</span>,</span>
<span id="cb88-143"><a href="#cb88-143" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb88-144"><a href="#cb88-144" aria-hidden="true" tabindex="-1"></a>                    <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-145"><a href="#cb88-145" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_processed =</span> temp_dir,</span>
<span id="cb88-146"><a href="#cb88-146" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-147"><a href="#cb88-147" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_lesions =</span> <span class="st">"brown"</span>)</span>
<span id="cb88-148"><a href="#cb88-148" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-149"><a href="#cb88-149" aria-hidden="true" tabindex="-1"></a>sev_lote<span class="sc">$</span>severity</span>
<span id="cb88-150"><a href="#cb88-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-151"><a href="#cb88-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-152"><a href="#cb88-152" aria-hidden="true" tabindex="-1"></a><span class="fu"># Standard area diagrams</span></span>
<span id="cb88-153"><a href="#cb88-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-154"><a href="#cb88-154" aria-hidden="true" tabindex="-1"></a>Standard area diagrams (SAD) have long been used as a tool to aid the estimation of plant disease severity, serving as a standard reference template before or during the assessments. Given an object computed with <span class="in">`measure_disease()`</span> a Standard Area Diagram (SAD) with <span class="in">`n`</span> images containing the respective severity values are obtained with <span class="in">`sad()`</span>.</span>
<span id="cb88-155"><a href="#cb88-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-156"><a href="#cb88-156" aria-hidden="true" tabindex="-1"></a>Leaves with the smallest and highest severity will always be in the SAD. If <span class="in">`n = 1`</span>, the leaf with the smallest severity will be returned. The others are sampled sequentially to achieve the n images after severity has been ordered in ascending order. For example, if there are 30 leaves and n is set to 3, the leaves sampled will be the 1st, 15th, and 30th with the smallest severity values.</span>
<span id="cb88-157"><a href="#cb88-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-158"><a href="#cb88-158" aria-hidden="true" tabindex="-1"></a>The SAD can be only computed if an image pattern name is used in argument <span class="in">`pattern`</span> of <span class="in">`measure_disease()`</span>. If the images are saved, the <span class="in">`n`</span> images will be retrevied from <span class="in">`dir_processed`</span> directory. Otherwise, the severity will be computed again to generate the images. A SAD with 8 images from the above example can be obtained easely with:</span>
<span id="cb88-159"><a href="#cb88-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-162"><a href="#cb88-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-163"><a href="#cb88-163" aria-hidden="true" tabindex="-1"></a><span class="fu">sad</span>(sev_lote, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb88-164"><a href="#cb88-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-165"><a href="#cb88-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-166"><a href="#cb88-166" aria-hidden="true" tabindex="-1"></a><span class="fu"># Parallel processing</span></span>
<span id="cb88-167"><a href="#cb88-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-168"><a href="#cb88-168" aria-hidden="true" tabindex="-1"></a>To speed up processing time when multiple images are available, you can use the <span class="in">`paralell`</span> argument. In parallel programming (<span class="in">`parallel = TRUE`</span>), the images are processed asynchronously (in parallel) in separate R sessions running in the background on the same machine. The number of sections is set by default to 50% of available cores. This number can be controlled explicitly with the argument workers.</span>
<span id="cb88-169"><a href="#cb88-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-172"><a href="#cb88-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-173"><a href="#cb88-173" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb88-174"><a href="#cb88-174" aria-hidden="true" tabindex="-1"></a>  sev_lote <span class="ot">&lt;-</span> </span>
<span id="cb88-175"><a href="#cb88-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">"soy"</span>,</span>
<span id="cb88-176"><a href="#cb88-176" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_healthy =</span> <span class="st">"soja_h"</span>,</span>
<span id="cb88-177"><a href="#cb88-177" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_symptoms =</span> <span class="st">"soja_s"</span>,</span>
<span id="cb88-178"><a href="#cb88-178" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_background =</span> <span class="st">"soja_b"</span>,</span>
<span id="cb88-179"><a href="#cb88-179" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb88-180"><a href="#cb88-180" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-181"><a href="#cb88-181" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-182"><a href="#cb88-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-183"><a href="#cb88-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-184"><a href="#cb88-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-185"><a href="#cb88-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-186"><a href="#cb88-186" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple images of the same sample</span></span>
<span id="cb88-187"><a href="#cb88-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-188"><a href="#cb88-188" aria-hidden="true" tabindex="-1"></a>If users need to analyze multiple images from the same sample, the images from the same sample must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<span class="in">`-`</span>) or underscore (<span class="in">`_`</span>).</span>
<span id="cb88-189"><a href="#cb88-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-190"><a href="#cb88-190" aria-hidden="true" tabindex="-1"></a>In the following example, 16 images will be used as examples. Here, they represent four replicates of four different treatments (<span class="in">`TRAT1_1, TRAT1_2, ..., TRAT4_4`</span>). Note that to ensure that all images are processed, all images must share a common pattern, in this case (<span class="in">`"TRAT"`</span>).</span>
<span id="cb88-191"><a href="#cb88-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-194"><a href="#cb88-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-195"><a href="#cb88-195" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb88-196"><a href="#cb88-196" aria-hidden="true" tabindex="-1"></a>  sev_trats <span class="ot">&lt;-</span> </span>
<span id="cb88-197"><a href="#cb88-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">"TRAT"</span>,</span>
<span id="cb88-198"><a href="#cb88-198" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_healthy =</span> <span class="st">"feijao_h"</span>,</span>
<span id="cb88-199"><a href="#cb88-199" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_symptoms =</span> <span class="st">"feijao_s"</span>,</span>
<span id="cb88-200"><a href="#cb88-200" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_background =</span> <span class="st">"feijao_b"</span>,</span>
<span id="cb88-201"><a href="#cb88-201" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_features =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-202"><a href="#cb88-202" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb88-203"><a href="#cb88-203" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-204"><a href="#cb88-204" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-205"><a href="#cb88-205" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">&lt;-</span> </span>
<span id="cb88-206"><a href="#cb88-206" aria-hidden="true" tabindex="-1"></a>  sev_trats<span class="sc">$</span>severity <span class="sc">|&gt;</span> </span>
<span id="cb88-207"><a href="#cb88-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_col</span>(img, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"TRAT"</span>, <span class="st">"REP"</span>))</span>
<span id="cb88-208"><a href="#cb88-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-209"><a href="#cb88-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-210"><a href="#cb88-210" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sev, <span class="fu">aes</span>(TRAT, symptomatic))<span class="sc">+</span></span>
<span id="cb88-211"><a href="#cb88-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb88-212"><a href="#cb88-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb88-213"><a href="#cb88-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tratamentos"</span>,</span>
<span id="cb88-214"><a href="#cb88-214" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Severidade (%)"</span>)</span>
<span id="cb88-215"><a href="#cb88-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-216"><a href="#cb88-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-217"><a href="#cb88-217" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple leaves in one image</span></span>
<span id="cb88-218"><a href="#cb88-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Segment by color</span></span>
<span id="cb88-219"><a href="#cb88-219" aria-hidden="true" tabindex="-1"></a>When multiple leaves are present in an image, the <span class="in">`measure_disease`</span> function returns the average severity of the leaves present in the image. To quantify the severity *per leaf*, the <span class="in">`measure_disease_byl()`</span> function can be used.</span>
<span id="cb88-220"><a href="#cb88-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-221"><a href="#cb88-221" aria-hidden="true" tabindex="-1"></a>This function computes the percentage of symptomatic leaf area using color palettes or RGB indices for each leaf (<span class="in">`byl`</span>) of an image. This allows, for example, to process replicates of the same treatment and obtain the results of each replication with a single image. To do this, the sample sheets are first split using the <span class="in">`object_split()`</span> function and then the <span class="in">`measure_disease()`</span> function is applied to the sheet list.</span>
<span id="cb88-222"><a href="#cb88-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-225"><a href="#cb88-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-226"><a href="#cb88-226" aria-hidden="true" tabindex="-1"></a>byl <span class="ot">&lt;-</span> </span>
<span id="cb88-227"><a href="#cb88-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease_byl</span>(<span class="at">pattern =</span> <span class="st">"multiplas_02"</span>,</span>
<span id="cb88-228"><a href="#cb88-228" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index =</span> <span class="st">"B"</span>, <span class="co"># used to segment leaves from background</span></span>
<span id="cb88-229"><a href="#cb88-229" aria-hidden="true" tabindex="-1"></a>                      <span class="at">img_healthy =</span> <span class="st">"soja_h"</span>,</span>
<span id="cb88-230"><a href="#cb88-230" aria-hidden="true" tabindex="-1"></a>                      <span class="at">img_symptoms =</span> <span class="st">"soja_s"</span>,</span>
<span id="cb88-231"><a href="#cb88-231" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-232"><a href="#cb88-232" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_features =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-233"><a href="#cb88-233" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_lesions =</span> <span class="st">"red"</span>,</span>
<span id="cb88-234"><a href="#cb88-234" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-235"><a href="#cb88-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-236"><a href="#cb88-236" aria-hidden="true" tabindex="-1"></a>results_byl <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(byl)</span>
<span id="cb88-237"><a href="#cb88-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-238"><a href="#cb88-238" aria-hidden="true" tabindex="-1"></a>results_byl<span class="sc">$</span>results <span class="sc">|&gt;</span> </span>
<span id="cb88-239"><a href="#cb88-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb88-240"><a href="#cb88-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-241"><a href="#cb88-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-242"><a href="#cb88-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-243"><a href="#cb88-243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Segment by shape</span></span>
<span id="cb88-246"><a href="#cb88-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-247"><a href="#cb88-247" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"disease_shp.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-248"><a href="#cb88-248" aria-hidden="true" tabindex="-1"></a>byl2 <span class="ot">&lt;-</span> </span>
<span id="cb88-249"><a href="#cb88-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease_shp</span>(img,</span>
<span id="cb88-250"><a href="#cb88-250" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">10</span>,</span>
<span id="cb88-251"><a href="#cb88-251" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb88-252"><a href="#cb88-252" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb88-253"><a href="#cb88-253" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index_lb =</span> <span class="st">"HUE2"</span>,</span>
<span id="cb88-254"><a href="#cb88-254" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index_dh =</span> <span class="st">"NGRDI"</span>,</span>
<span id="cb88-255"><a href="#cb88-255" aria-hidden="true" tabindex="-1"></a>                      <span class="at">threshold =</span> <span class="fu">c</span>(<span class="st">"Otsu"</span>, <span class="dv">0</span>),</span>
<span id="cb88-256"><a href="#cb88-256" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-257"><a href="#cb88-257" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb88-258"><a href="#cb88-258" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(byl2<span class="sc">$</span>shapefiles)</span>
<span id="cb88-259"><a href="#cb88-259" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(byl2, <span class="at">measure =</span> <span class="st">"symptomatic"</span>)</span>
<span id="cb88-260"><a href="#cb88-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-261"><a href="#cb88-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-262"><a href="#cb88-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-263"><a href="#cb88-263" aria-hidden="true" tabindex="-1"></a><span class="fu"># Interactive disease measurements</span></span>
<span id="cb88-264"><a href="#cb88-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-265"><a href="#cb88-265" aria-hidden="true" tabindex="-1"></a>An alternative approach to measuring disease percentage is available through the <span class="in">`measure_disease_iter()`</span> function. This function offers an interactive interface that empowers users to manually select sample colors directly from the image. By doing so, it provides a highly customizable analysis method.</span>
<span id="cb88-266"><a href="#cb88-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-267"><a href="#cb88-267" aria-hidden="true" tabindex="-1"></a>One advantage of using <span class="in">`measure_disease_iter()`</span> is the ability to utilize the "mapview" viewer, which enhances the analysis process by offering zoom-in options. This feature allows users to closely examine specific areas of the image, enabling detailed inspection and accurate disease measurement.</span>
<span id="cb88-268"><a href="#cb88-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-269"><a href="#cb88-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb88-270"><a href="#cb88-270" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">"sev_leaf.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-271"><a href="#cb88-271" aria-hidden="true" tabindex="-1"></a><span class="fu">measure_disease_iter</span>(img, <span class="at">viewer =</span> <span class="st">"mapview"</span>)</span>
<span id="cb88-272"><a href="#cb88-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-273"><a href="#cb88-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-274"><a href="#cb88-274" aria-hidden="true" tabindex="-1"></a><span class="al">![](imgs/gif_severity.gif)</span></span>
<span id="cb88-275"><a href="#cb88-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-276"><a href="#cb88-276" aria-hidden="true" tabindex="-1"></a><span class="fu"># More than two classes</span></span>
<span id="cb88-279"><a href="#cb88-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-280"><a href="#cb88-280" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">"sev_leaf.jpg"</span>)</span>
<span id="cb88-281"><a href="#cb88-281" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment_iter</span>(img,</span>
<span id="cb88-282"><a href="#cb88-282" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nseg =</span> <span class="dv">3</span>,</span>
<span id="cb88-283"><a href="#cb88-283" aria-hidden="true" tabindex="-1"></a>                   <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"NGRDI"</span>, <span class="st">"G-B"</span>),</span>
<span id="cb88-284"><a href="#cb88-284" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb88-285"><a href="#cb88-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-286"><a href="#cb88-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-287"><a href="#cb88-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-288"><a href="#cb88-288" aria-hidden="true" tabindex="-1"></a><span class="fu"># A little gift</span></span>
<span id="cb88-289"><a href="#cb88-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-292"><a href="#cb88-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb88-293"><a href="#cb88-293" aria-hidden="true" tabindex="-1"></a>fungo <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"fungo.jpeg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-294"><a href="#cb88-294" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb88-295"><a href="#cb88-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(fungo, </span>
<span id="cb88-296"><a href="#cb88-296" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"HUE"</span>,</span>
<span id="cb88-297"><a href="#cb88-297" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-298"><a href="#cb88-298" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">5</span>,</span>
<span id="cb88-299"><a href="#cb88-299" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-300"><a href="#cb88-300" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">6</span>)</span>
<span id="cb88-301"><a href="#cb88-301" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(res, <span class="at">dpi =</span> <span class="dv">90</span>) <span class="sc">|&gt;</span> </span>
<span id="cb88-302"><a href="#cb88-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_measures</span>(<span class="at">measure =</span> <span class="st">"area"</span>, </span>
<span id="cb88-303"><a href="#cb88-303" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb88-304"><a href="#cb88-304" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb88-305"><a href="#cb88-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-306"><a href="#cb88-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-307"><a href="#cb88-307" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb88-308"><a href="#cb88-308" aria-hidden="true" tabindex="-1"></a>The segmentation can also be performed using sample palettes representing the foreground and background. In this example, pick the color samples, then use them in the <span class="in">`analyze_objects()`</span>.</span>
<span id="cb88-309"><a href="#cb88-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-310"><a href="#cb88-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb88-311"><a href="#cb88-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-312"><a href="#cb88-312" aria-hidden="true" tabindex="-1"></a>back <span class="ot">&lt;-</span> <span class="fu">pick_palette</span>(fungo)</span>
<span id="cb88-313"><a href="#cb88-313" aria-hidden="true" tabindex="-1"></a>fore <span class="ot">&lt;-</span> <span class="fu">pick_palette</span>(fungo)</span>
<span id="cb88-314"><a href="#cb88-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-315"><a href="#cb88-315" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb88-316"><a href="#cb88-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(fungo,</span>
<span id="cb88-317"><a href="#cb88-317" aria-hidden="true" tabindex="-1"></a>                  <span class="at">background =</span> back,</span>
<span id="cb88-318"><a href="#cb88-318" aria-hidden="true" tabindex="-1"></a>                  <span class="at">foreground =</span> fore,</span>
<span id="cb88-319"><a href="#cb88-319" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-320"><a href="#cb88-320" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">5</span>,</span>
<span id="cb88-321"><a href="#cb88-321" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">6</span>)</span>
<span id="cb88-322"><a href="#cb88-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-323"><a href="#cb88-323" aria-hidden="true" tabindex="-1"></a>meas <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(res, <span class="at">dpi =</span> <span class="dv">90</span>)</span>
<span id="cb88-324"><a href="#cb88-324" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(meas,</span>
<span id="cb88-325"><a href="#cb88-325" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb88-326"><a href="#cb88-326" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb88-327"><a href="#cb88-327" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb88-328"><a href="#cb88-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb88-329"><a href="#cb88-329" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>The {pliman} R package</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Prof.&nbsp;Dr.&nbsp;Tiago Olivoto FIT/CCA/UFSC</p>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>