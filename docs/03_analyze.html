<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.205">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R package {pliman} - Analyze objects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_phytopathometry.html" rel="next">
<link href="./02_segment.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    null
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R package {pliman}</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./00_about.html" rel="" target=""><i class="bi bi-fa fa-home" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto" rel="" target=""><i class="bi bi-fab fa-researchgate fa" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TiagoOlivoto/pliman" rel="" target=""><i class="bi bi-bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tolivoto" rel="" target=""><i class="bi bi-bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/" rel="" target=""><i class="bi bi-fab fa-mendeley fa" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_analyze.html">Analyze objects</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_manipulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import and manipulate</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_segment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Segment objects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_analyze.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Analyze objects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_phytopathometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phytopathometry</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">In this page</h2>
   
  <ul>
<li><a href="#directory" id="toc-directory" class="nav-link active" data-scroll-target="#directory"><span class="header-section-number">1</span> Directory</a></li>
  <li>
<a href="#working-with-polygons" id="toc-working-with-polygons" class="nav-link" data-scroll-target="#working-with-polygons"><span class="header-section-number">2</span> Working with polygons</a>
  <ul class="collapse">
<li><a href="#area" id="toc-area" class="nav-link" data-scroll-target="#area"><span class="header-section-number">2.1</span> Area</a></li>
  <li><a href="#perimeter" id="toc-perimeter" class="nav-link" data-scroll-target="#perimeter"><span class="header-section-number">2.2</span> Perimeter</a></li>
  <li><a href="#radius" id="toc-radius" class="nav-link" data-scroll-target="#radius"><span class="header-section-number">2.3</span> Radius</a></li>
  <li><a href="#length-and-width" id="toc-length-and-width" class="nav-link" data-scroll-target="#length-and-width"><span class="header-section-number">2.4</span> Length and width</a></li>
  <li><a href="#circularity-eccentricity-diameter-and-elongation" id="toc-circularity-eccentricity-diameter-and-elongation" class="nav-link" data-scroll-target="#circularity-eccentricity-diameter-and-elongation"><span class="header-section-number">2.5</span> Circularity, eccentricity, diameter, and elongation</a></li>
  <li><a href="#rotate-polygons" id="toc-rotate-polygons" class="nav-link" data-scroll-target="#rotate-polygons"><span class="header-section-number">2.6</span> Rotate polygons</a></li>
  <li><a href="#invert-polygons" id="toc-invert-polygons" class="nav-link" data-scroll-target="#invert-polygons"><span class="header-section-number">2.7</span> Invert polygons</a></li>
  <li><a href="#perimeter-sampling" id="toc-perimeter-sampling" class="nav-link" data-scroll-target="#perimeter-sampling"><span class="header-section-number">2.8</span> Perimeter sampling</a></li>
  <li><a href="#smoothing" id="toc-smoothing" class="nav-link" data-scroll-target="#smoothing"><span class="header-section-number">2.9</span> smoothing</a></li>
  <li><a href="#noises" id="toc-noises" class="nav-link" data-scroll-target="#noises"><span class="header-section-number">2.10</span> Noises</a></li>
  </ul>
</li>
  <li>
<a href="#analyzing-objects" id="toc-analyzing-objects" class="nav-link" data-scroll-target="#analyzing-objects"><span class="header-section-number">3</span> Analyzing objects</a>
  <ul class="collapse">
<li>
<a href="#adjusting-object-measurements" id="toc-adjusting-object-measurements" class="nav-link" data-scroll-target="#adjusting-object-measurements"><span class="header-section-number">3.1</span> Adjusting object measurements</a>
  <ul class="collapse">
<li><a href="#declaring-a-known-value" id="toc-declaring-a-known-value" class="nav-link" data-scroll-target="#declaring-a-known-value"><span class="header-section-number">3.1.1</span> Declaring a known value</a></li>
  <li><a href="#declaring-the-image-resolution" id="toc-declaring-the-image-resolution" class="nav-link" data-scroll-target="#declaring-the-image-resolution"><span class="header-section-number">3.1.2</span> Declaring the image resolution</a></li>
  <li><a href="#understanding-measurements" id="toc-understanding-measurements" class="nav-link" data-scroll-target="#understanding-measurements"><span class="header-section-number">3.1.3</span> Understanding measurements</a></li>
  </ul>
</li>
  <li><a href="#texture-features" id="toc-texture-features" class="nav-link" data-scroll-target="#texture-features"><span class="header-section-number">3.2</span> Texture features</a></li>
  <li><a href="#single-image-processing" id="toc-single-image-processing" class="nav-link" data-scroll-target="#single-image-processing"><span class="header-section-number">3.3</span> Single image processing</a></li>
  <li><a href="#batch-processing" id="toc-batch-processing" class="nav-link" data-scroll-target="#batch-processing"><span class="header-section-number">3.4</span> Batch processing</a></li>
  </ul>
</li>
  <li><a href="#object-coordinates" id="toc-object-coordinates" class="nav-link" data-scroll-target="#object-coordinates"><span class="header-section-number">4</span> Object coordinates</a></li>
  <li><a href="#isolating-objects" id="toc-isolating-objects" class="nav-link" data-scroll-target="#isolating-objects"><span class="header-section-number">5</span> Isolating objects</a></li>
  <li><a href="#including-objects-in-a-list" id="toc-including-objects-in-a-list" class="nav-link" data-scroll-target="#including-objects-in-a-list"><span class="header-section-number">6</span> Including objects in a list</a></li>
  <li><a href="#rgb-values-for-each-object" id="toc-rgb-values-for-each-object" class="nav-link" data-scroll-target="#rgb-values-for-each-object"><span class="header-section-number">7</span> RGB values for each object</a></li>
  <li>
<a href="#leaf-area" id="toc-leaf-area" class="nav-link" data-scroll-target="#leaf-area"><span class="header-section-number">8</span> Leaf area</a>
  <ul class="collapse">
<li><a href="#known-resolution" id="toc-known-resolution" class="nav-link" data-scroll-target="#known-resolution"><span class="header-section-number">8.1</span> Known resolution</a></li>
  <li>
<a href="#reference-object-dev-version" id="toc-reference-object-dev-version" class="nav-link" data-scroll-target="#reference-object-dev-version"><span class="header-section-number">8.2</span> Reference object (dev version)</a>
  <ul class="collapse">
<li><a href="#single-images" id="toc-single-images" class="nav-link" data-scroll-target="#single-images"><span class="header-section-number">8.2.1</span> Single images</a></li>
  <li><a href="#multiple-images" id="toc-multiple-images" class="nav-link" data-scroll-target="#multiple-images"><span class="header-section-number">8.2.2</span> Multiple images</a></li>
  </ul>
</li>
  <li><a href="#filling-holes" id="toc-filling-holes" class="nav-link" data-scroll-target="#filling-holes"><span class="header-section-number">8.3</span> Filling ‘holes’</a></li>
  <li><a href="#compound-leaves" id="toc-compound-leaves" class="nav-link" data-scroll-target="#compound-leaves"><span class="header-section-number">8.4</span> Compound leaves</a></li>
  </ul>
</li>
  <li><a href="#shapefiles" id="toc-shapefiles" class="nav-link" data-scroll-target="#shapefiles"><span class="header-section-number">9</span> Shapefiles</a></li>
  <li>
<a href="#fourier-analyses" id="toc-fourier-analyses" class="nav-link" data-scroll-target="#fourier-analyses"><span class="header-section-number">10</span> Fourier analyses</a>
  <ul class="collapse">
<li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions"><span class="header-section-number">10.1</span> Functions</a></li>
  <li><a href="#elliptical-fourier" id="toc-elliptical-fourier" class="nav-link" data-scroll-target="#elliptical-fourier"><span class="header-section-number">10.2</span> Elliptical fourier</a></li>
  <li><a href="#rotation-and-size" id="toc-rotation-and-size" class="nav-link" data-scroll-target="#rotation-and-size"><span class="header-section-number">10.3</span> Rotation and size</a></li>
  <li><a href="#morphological-diversity" id="toc-morphological-diversity" class="nav-link" data-scroll-target="#morphological-diversity"><span class="header-section-number">10.4</span> Morphological diversity</a></li>
  </ul>
</li>
  <li><a href="#distance-to-an-ideotype" id="toc-distance-to-an-ideotype" class="nav-link" data-scroll-target="#distance-to-an-ideotype"><span class="header-section-number">11</span> Distance to an ideotype</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Analyze objects</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="directory" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Directory</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="working-with-polygons" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Working with polygons</h1>
<blockquote class="blockquote">
<p>A ‘polygon’ is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
</blockquote>
<p>We can then conclude that image objects can be expressed as polygons with <code>n</code> vertices. <code>pliman</code> has a set of functions(<code>draw_*()</code>) useful for drawing common shapes like circles, squares, triangles, rectangles and <code>n</code>- tagons . Another group of <code>poly_*()</code> functions can be used to analyze polygons. Let’s start with a simple example related to the area and perimeter of a square.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Tools for Plant Image Analysis (pliman 2.0.0)            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Author: Tiago Olivoto                                    |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'citation('pliman')' to know how to cite pliman     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'vignette('pliman_start')' for a short tutorial     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Visit 'http://bit.ly/pkg_pliman' for a complete tutorial |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">square</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Now, let’s see what happens when we start with a hexagon and increase the number of sides up to 1000.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shapes</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>side6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side12 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">8</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">12</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">50</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side500 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">100</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">1000</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">shapes</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.598076 2.828427 3.000000 3.133331 3.139526 3.141572</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   side6   side12   side24  side100  side500  side100 
5.000000 5.357568 5.694019 6.153471 6.219330 6.276892 </code></pre>
</div>
</div>
<p>Note that when <span class="math inline">\(n \to \infty\)</span>, the sum of the sides becomes the circumference of the circle, given by <span class="math inline">\(2 \pi r\)</span>, and the area becomes <span class="math inline">\(\pi r^2\)</span>. This is fun, but <code>pliman</code> is primarily designed for analyzing plant image analysis. So why use polygons? Let’s see how we can use these functions to get applicable information.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># getting the outline of objects</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B-R"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plotting the polygon</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 2, 12, and 23.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cont2</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5"</span>, <span class="st">"20"</span>, <span class="st">"27"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>In the current version of <code>pliman</code>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, Claude (2008)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and Montero et al.&nbsp;(2009)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<section id="area" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="area">
<span class="header-section-number">2.1</span> Area</h2>
<p>The area of a shape is calculated using Shoelace’s formula (Lee and Lim, 2017)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, as follows</p>
<p><span class="math display">\[
A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 18352.5 36372.0 37283.0 16610.5  5077.0 30713.5 19633.0  6659.0  9035.0
[10]  3083.5 12284.5  8285.0  1518.5  1878.0  1271.5  9692.0  3306.5  8433.5
[19]  2952.0 16263.0 12589.0  1865.5  1726.0</code></pre>
</div>
</div>
</section><section id="perimeter" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="perimeter">
<span class="header-section-number">2.2</span> Perimeter</h2>
<p>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_distpts()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
 615.2569 1125.0874  797.8082  552.3574  386.2914  897.2102  604.4701  412.7056 
       11        14        15        16        17        18        19        20 
 453.4163  284.3797  502.7716  469.5584  160.4386  285.4508  156.2965  412.1026 
       21        22        23        24        25        26        27 
 256.8650  365.7279  301.3087  538.4701  479.2742  211.8944  548.2548 </code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># perimeter of a circle with radius 2</span></span>
<span><span class="va">circle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.56635</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check the result</span></span>
<span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.56637</code></pre>
</div>
</div>
</section><section id="radius" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="radius">
<span class="header-section-number">2.3</span> Radius</h2>
<p>The radius of a pixel on the object’s contour is calculated as its distance from the object’s centroid(also called ‘center of mass’). These distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stats for radius</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
 81.50472 107.15072 111.67757  75.92128  48.48228 112.97916  82.68263  53.51156 
       11        14        15        16        17        18        19        20 
 56.72946  36.54740  64.67529  61.75205  22.48669  33.83886  21.25721  57.39115 
       21        22        23        24        25        26        27 
 34.56566  52.56715  38.06452  73.40734  65.81308  28.06548  67.26094 </code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">min_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
56.365931 62.460726 79.800528 55.452805 21.232635 48.004837 53.638969 25.979106 
       11        14        15        16        17        18        19        20 
34.823777 15.440760 43.867424 29.407891 15.553085  5.815242 11.841794 42.995237 
       21        22        23        24        25        26        27 
23.217347 44.807718 13.925495 59.848727 47.836671 16.415385  3.438458 </code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">max_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
126.82821 152.42898 166.37215 115.03892  84.48600 192.29568 127.78141  91.08601 
       11        14        15        16        17        18        19        20 
 88.38574  62.81868  95.99267 106.86452  33.31437  62.59528  33.27942  85.25620 
       21        22        23        24        25        26        27 
 54.26327  64.41345  67.61794 104.72813  98.71630  47.72001 134.03105 </code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">sd_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
17.425062 18.421426 24.407052 14.837653 18.090150 41.426392 21.177024 19.809781 
       11        14        15        16        17        18        19        20 
13.522420 13.821949 12.949648 23.157277  5.360341 15.964780  6.161850 12.086296 
       21        22        23        24        25        26        27 
 8.886554  5.709767 15.304076  9.980561 12.689383  8.956172 38.480834 </code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># average radius of above circle</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.999998</code></pre>
</div>
</div>
</section><section id="length-and-width" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="length-and-width">
<span class="header-section-number">2.4</span> Length and width</h2>
<p>The length and width of an object are calculated with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw()</a></code>, as the difference between the maximum and minimum of the <code>x</code> and <code>y</code> coordinates after the object has been aligned with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_align()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         length     width
 [1,] 238.54100 125.05197
 [2,] 280.55220 237.69204
 [3,] 315.47889 166.64659
 [4,] 209.33606 123.39163
 [5,] 168.01252  54.02002
 [6,] 375.58661 131.13737
 [7,] 249.45384 116.64014
 [8,] 179.84217  62.94321
 [9,] 152.34622 114.49558
[10,] 124.87025  39.06435
[11,] 166.54470 126.32871
[12,] 208.31970  68.91857
[13,]  66.15298  32.52419
[14,] 123.16969  30.24387
[15,]  66.09709  28.40237
[16,] 164.06833  90.09544
[17,] 102.73052  50.34951
[18,] 100.45299  98.53530
[19,] 133.47743  37.65555
[20,] 180.69778 135.88876
[21,] 176.71212 111.21299
[22,]  89.00219  36.02323
[23,] 266.25888  10.45654</code></pre>
</div>
</div>
</section><section id="circularity-eccentricity-diameter-and-elongation" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="circularity-eccentricity-diameter-and-elongation">
<span class="header-section-number">2.5</span> Circularity, eccentricity, diameter, and elongation</h2>
<p>Circularity(Montero et al.&nbsp;2009)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is also called shape compactness, or measure of roundness of an object. It is given by <span class="math inline">\(C = P^2 / A\)</span>, where <span class="math inline">\(P\)</span> is the perimeter and <span class="math inline">\(A\)</span> is the area of the object.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
 20.62613  34.80209  17.07207  18.36782  29.39158  26.20952  18.61071  25.57831 
       11        14        15        16        17        18        19        20 
 22.75444  26.22728  20.57710  26.61257  16.95130  43.38773  19.21241  17.52255 
       21        22        23        24        25        26        27 
 19.95452  15.86019  30.75437  17.82882  18.24638  24.06822 174.15027 </code></pre>
</div>
</div>
<p>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have a circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given <span class="math inline">\(Cn = P^2 / 4 \pi A\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
0.6092451 0.3610809 0.7360778 0.6841513 0.4275500 0.4794582 0.6752224 0.4912902 
       11        14        15        16        17        18        19        20 
0.5522602 0.4791335 0.6106970 0.4721968 0.7413221 0.2896296 0.6540756 0.7171542 
       21        22        23        24        25        26        27 
0.6297505 0.7923216 0.4086044 0.7048347 0.6887047 0.5221148 0.0721582 </code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># normalized circularity for different shapes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>plot <span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.396263</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999967</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick()</a></code> calculates the Circularity of Haralick, CH (Haralick, 1974)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. The method is based on calculating all Euclidean distances from the object’s centroid to each contour pixel. With this set of distances, the mean(<span class="math inline">\(m\)</span>) and the standard deviation(<span class="math inline">\(s\)</span>) are calculated. These statistical parameters are used in a ratio that calculates CH as $CH = m/ sd $.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7       10 
4.677442 5.816635 4.575627 5.116798 2.680038 2.727227 3.904355 2.701270 
      11       14       15       16       17       18       19       20 
4.195215 2.644156 4.994367 2.666637 4.195010 2.119594 3.449810 4.748449 
      21       22       23       24       25       26       27 
3.889658 9.206531 2.487214 7.355031 5.186468 3.133647 1.747908 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity()</a></code> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
0.8967601 0.6876980 0.9192591 0.9132441 0.8298061 0.8645018 0.8757106 0.9226473 
       11        14        15        16        17        18        19        20 
0.8410503 0.9023328 0.8468413 0.9133223 0.9154601 0.6425806 0.9193294 0.9192070 
       21        22        23        24        25        26        27 
0.8967441 0.8459495 0.9009212 0.9076033 0.8508448 0.7493671 0.7361697 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity()</a></code> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]
 [1,] 0.346560699
 [2,] 0.844858938
 [3,] 0.401595451
 [4,] 0.431419527
 [5,] 0.132562754
 [6,] 0.156699400
 [7,] 0.322626716
 [8,] 0.149181272
 [9,] 0.543013592
[10,] 0.142622157
[11,] 0.608127299
[12,] 0.127298521
[13,] 0.379315768
[14,] 0.069374529
[15,] 0.275223477
[16,] 0.414141956
[17,] 0.313023030
[18,] 0.960354914
[19,] 0.109866568
[20,] 0.648373662
[21,] 0.456904377
[22,] 0.190833679
[23,] 0.002065428</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation()</a></code> Calculates the elongation of an object as <code>1 - width / length</code></p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
 [1,] 0.47576322
 [2,] 0.15277071
 [3,] 0.47176628
 [4,] 0.41055721
 [5,] 0.67847621
 [6,] 0.65084654
 [7,] 0.53241794
 [8,] 0.65000859
 [9,] 0.24845148
[10,] 0.68716047
[11,] 0.24147263
[12,] 0.66916922
[13,] 0.50834888
[14,] 0.75445361
[15,] 0.57029316
[16,] 0.45086636
[17,] 0.50988754
[18,] 0.01909042
[19,] 0.71788823
[20,] 0.24797772
[21,] 0.37065445
[22,] 0.59525454
[23,] 0.96072791</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper()</a></code> Calculates the gauge(also called Feret’s diameter).</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7        10 
235.68835 284.39585 314.63630 205.34118 160.11246 372.48490 249.28097 179.69418 
       11        14        15        16        17        18        19        20 
154.98387 124.78782 167.69317 207.57649  66.18912 123.32883  66.09841 164.24677 
       21        22        23        24        25        26        27 
102.78619 128.03515 133.37541 185.60711 177.11578  89.04493 266.18790 </code></pre>
</div>
</div>
<p>Users can use the <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code> function to calculate most object measurements in a single call.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_rows_cols.html">round_cols</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            1        2        3        4       5        6
id                       1.00     2.00     3.00     4.00    5.00     6.00
x                      473.08   809.08   244.59   612.07  375.16   104.34
y                      144.40   168.44   194.72   152.34  155.65   440.98
area                 18352.50 36372.00 37283.00 16610.50 5077.00 30713.50
area_ch              19538.50 45891.00 37696.50 17423.00 5670.50 32710.50
perimeter              615.26  1125.09   797.81   552.36  386.29   897.21
radius_mean             81.50   107.15   111.68    75.92   48.48   112.98
radius_min              56.37    62.46    79.80    55.45   21.23    48.00
radius_max             126.83   152.43   166.37   115.04   84.49   192.30
radius_sd               17.43    18.42    24.41    14.84   18.09    41.43
radius_ratio             2.25     2.44     2.08     2.07    3.98     4.01
diam_mean              163.01   214.30   223.36   151.84   96.96   225.96
diam_min               112.73   124.92   159.60   110.91   42.47    96.01
diam_max               253.66   304.86   332.74   230.08  168.97   384.59
caliper                238.54   280.55   315.48   209.34  168.01   375.59
length                 238.54   280.55   315.48   209.34  168.01   375.59
width                  125.05   237.69   166.65   123.39   54.02   131.14
solidity                 0.94     0.79     0.99     0.95    0.90     0.94
convexity                0.90     0.69     0.92     0.91    0.83     0.86
elongation               0.48     0.15     0.47     0.41    0.68     0.65
circularity             20.63    34.80    17.07    18.37   29.39    26.21
circularity_haralick     4.68     5.82     4.58     5.12    2.68     2.73
circularity_norm         0.61     0.36     0.74     0.68    0.43     0.48
eccentricity             0.35     0.84     0.40     0.43    0.13     0.16
pcv                      1.26     2.84     0.43     0.94    1.64     0.82
                            7      10       11      14       15      16      17
id                       7.00    8.00     9.00   10.00    11.00   12.00   13.00
x                      929.08  341.49   529.46  632.11   773.02  446.42  568.82
y                      375.55  375.53   335.35  405.31   430.98  518.10  474.33
area                 19633.00 6659.00  9035.00 3083.50 12284.50 8285.00 1518.50
area_ch              20110.50 7117.00 10330.00 3218.50 13343.50 8811.00 1553.00
perimeter              604.47  412.71   453.42  284.38   502.77  469.56  160.44
radius_mean             82.68   53.51    56.73   36.55    64.68   61.75   22.49
radius_min              53.64   25.98    34.82   15.44    43.87   29.41   15.55
radius_max             127.78   91.09    88.39   62.82    95.99  106.86   33.31
radius_sd               21.18   19.81    13.52   13.82    12.95   23.16    5.36
radius_ratio             2.38    3.51     2.54    4.07     2.19    3.63    2.14
diam_mean              165.37  107.02   113.46   73.09   129.35  123.50   44.97
diam_min               107.28   51.96    69.65   30.88    87.73   58.82   31.11
diam_max               255.56  182.17   176.77  125.64   191.99  213.73   66.63
caliper                249.45  179.84   152.35  124.87   166.54  208.32   66.15
length                 249.45  179.84   152.35  124.87   166.54  208.32   66.15
width                  116.64   62.94   114.50   39.06   126.33   68.92   32.52
solidity                 0.98    0.94     0.87    0.96     0.92    0.94    0.98
convexity                0.88    0.92     0.84    0.90     0.85    0.91    0.92
elongation               0.53    0.65     0.25    0.69     0.24    0.67    0.51
circularity             18.61   25.58    22.75   26.23    20.58   26.61   16.95
circularity_haralick     3.90    2.70     4.20    2.64     4.99    2.67    4.20
circularity_norm         0.68    0.49     0.55    0.48     0.61    0.47    0.74
eccentricity             0.32    0.15     0.54    0.14     0.61    0.13    0.38
pcv                      0.85    1.15     1.53    1.75     1.36    1.07    3.13
                          18      19      20      21      22      23       24
id                     14.00   15.00   16.00   17.00   18.00   19.00    20.00
x                     305.39  633.31  858.65  751.61  536.84  654.67   199.12
y                     534.70  510.59  557.43  555.64  588.83  630.47   665.41
area                 1878.00 1271.50 9692.00 3306.50 8433.50 2952.00 16263.00
area_ch              2332.00 1315.00 9969.00 3531.50 8529.50 3202.00 17237.00
perimeter             285.45  156.30  412.10  256.87  365.73  301.31   538.47
radius_mean            33.84   21.26   57.39   34.57   52.57   38.06    73.41
radius_min              5.82   11.84   43.00   23.22   44.81   13.93    59.85
radius_max             62.60   33.28   85.26   54.26   64.41   67.62   104.73
radius_sd              15.96    6.16   12.09    8.89    5.71   15.30     9.98
radius_ratio           10.76    2.81    1.98    2.34    1.44    4.86     1.75
diam_mean              67.68   42.51  114.78   69.13  105.13   76.13   146.81
diam_min               11.63   23.68   85.99   46.43   89.62   27.85   119.70
diam_max              125.19   66.56  170.51  108.53  128.83  135.24   209.46
caliper               123.17   66.10  164.07  102.73  100.45  133.48   180.70
length                123.17   66.10  164.07  102.73  100.45  133.48   180.70
width                  30.24   28.40   90.10   50.35   98.54   37.66   135.89
solidity                0.81    0.97    0.97    0.94    0.99    0.92     0.94
convexity               0.64    0.92    0.92    0.90    0.85    0.90     0.91
elongation              0.75    0.57    0.45    0.51    0.02    0.72     0.25
circularity            43.39   19.21   17.52   19.95   15.86   30.75    17.83
circularity_haralick    2.12    3.45    4.75    3.89    9.21    2.49     7.36
circularity_norm        0.29    0.65    0.72    0.63    0.79    0.41     0.70
eccentricity            0.07    0.28    0.41    0.31    0.96    0.11     0.65
pcv                     2.24    3.12    1.12    1.99    1.10    1.71     1.20
                           25      26      27
id                      21.00   22.00   23.00
x                      767.38  313.05  428.12
y                      675.03  656.60  696.30
area                 12589.00 1865.50 1726.00
area_ch              13171.50 2076.00 2079.00
perimeter              479.27  211.89  548.25
radius_mean             65.81   28.07   67.26
radius_min              47.84   16.42    3.44
radius_max              98.72   47.72  134.03
radius_sd               12.69    8.96   38.48
radius_ratio             2.06    2.91   38.98
diam_mean              131.63   56.13  134.52
diam_min                95.67   32.83    6.88
diam_max               197.43   95.44  268.06
caliper                176.71   89.00  266.26
length                 176.71   89.00  266.26
width                  111.21   36.02   10.46
solidity                 0.96    0.90    0.83
convexity                0.85    0.75    0.74
elongation               0.37    0.60    0.96
circularity             18.25   24.07  174.15
circularity_haralick     5.19    3.13    1.75
circularity_norm         0.69    0.52    0.07
eccentricity             0.46    0.19    0.00
pcv                      1.03    2.45    0.68</code></pre>
</div>
</div>
<p>If the image resolution is known, the measurements can be corrected with <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">dpi()</a></code> the resolution can be obtained. In this case, the dpi is ~50.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">color_measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">measures</span>, dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">color_measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1         2         3         4         5
id                     1.00000   2.00000   3.00000   4.00000   5.00000
x                    473.08000 809.08000 244.59000 612.07000 375.16000
y                    144.40000 168.44000 194.72000 152.34000 155.65000
area                  47.36120  93.86304  96.21400  42.86572  13.10191
area_ch               50.42183 118.42815  97.28110  44.96249  14.63352
perimeter             31.25521  57.15457  40.52875  28.05989  19.62353
radius_mean            4.14020   5.44322   5.67334   3.85674   2.46278
radius_min             2.86360   3.17297   4.05384   2.81686   1.07848
radius_max             6.44296   7.74344   8.45160   5.84403   4.29209
radius_sd              0.88544   0.93574   1.24003   0.75387   0.91897
radius_ratio           0.11430   0.12395   0.10566   0.10516   0.20218
diam_mean              8.28091  10.88644  11.34669   7.71347   4.92557
diam_min               5.72668   6.34594   8.10768   5.63423   2.15748
diam_max              12.88593  15.48689  16.90319  11.68806   8.58368
caliper               12.11783  14.25194  16.02638  10.63447   8.53491
length                12.11783  14.25194  16.02638  10.63447   8.53491
width                  6.35254  12.07465   8.46582   6.26821   2.74422
solidity               0.04775   0.04013   0.05029   0.04826   0.04572
convexity              0.90000   0.69000   0.92000   0.91000   0.83000
elongation             0.48000   0.15000   0.47000   0.41000   0.68000
circularity           20.63000  34.80000  17.07000  18.37000  29.39000
circularity_haralick   4.68000   5.82000   4.58000   5.12000   2.68000
circularity_norm       0.61000   0.36000   0.74000   0.68000   0.43000
eccentricity           0.35000   0.84000   0.40000   0.43000   0.13000
pcv                    1.26000   2.84000   0.43000   0.94000   1.64000
pcv                    1.26000   2.84000   0.43000   0.94000   1.64000
                             6         7        10        11        14
id                     6.00000   7.00000   8.00000   9.00000  10.00000
x                    104.34000 929.08000 341.49000 529.46000 632.11000
y                    440.98000 375.55000 375.53000 335.35000 405.31000
area                  79.26049  50.66571  17.18448  23.31608   7.95740
area_ch               84.41402  51.89796  18.36641  26.65801   8.30579
perimeter             45.57827  30.70708  20.96567  23.03374  14.44650
radius_mean            5.73938   4.20014   2.71831   2.88188   1.85674
radius_min             2.43840   2.72491   1.31978   1.76886   0.78435
radius_max             9.76884   6.49122   4.62737   4.49021   3.19126
radius_sd              2.10464   1.07594   1.00635   0.68682   0.70206
radius_ratio           0.20371   0.12090   0.17831   0.12903   0.20676
diam_mean             11.47877   8.40080   5.43662   5.76377   3.71297
diam_min               4.87731   5.44982   2.63957   3.53822   1.56870
diam_max              19.53717  12.98245   9.25424   8.97992   6.38251
caliper               19.07997  12.67206   9.13587   7.73938   6.34340
length                19.07997  12.67206   9.13587   7.73938   6.34340
width                  6.66191   5.92531   3.19735   5.81660   1.98425
solidity               0.04775   0.04978   0.04775   0.04420   0.04877
convexity              0.86000   0.88000   0.92000   0.84000   0.90000
elongation             0.65000   0.53000   0.65000   0.25000   0.69000
circularity           26.21000  18.61000  25.58000  22.75000  26.23000
circularity_haralick   2.73000   3.90000   2.70000   4.20000   2.64000
circularity_norm       0.48000   0.68000   0.49000   0.55000   0.48000
eccentricity           0.16000   0.32000   0.15000   0.54000   0.14000
pcv                    0.82000   0.85000   1.15000   1.53000   1.75000
pcv                    0.82000   0.85000   1.15000   1.53000   1.75000
                            15        16        17        18        19
id                    11.00000  12.00000  13.00000  14.00000  15.00000
x                    773.02000 446.42000 568.82000 305.39000 633.31000
y                    430.98000 518.10000 474.33000 534.70000 510.59000
area                  31.70187  21.38060   3.91870   4.84644   3.28128
area_ch               34.43477  22.73802   4.00773   6.01805   3.39354
perimeter             25.54072  23.85365   8.15035  14.50086   7.94004
radius_mean            3.28574   3.13690   1.14249   1.71907   1.08001
radius_min             2.22860   1.49403   0.78994   0.29566   0.60147
radius_max             4.87629   5.42849   1.69215   3.18008   1.69062
radius_sd              0.65786   1.17653   0.27229   0.81077   0.31293
radius_ratio           0.11125   0.18440   0.10871   0.54661   0.14275
diam_mean              6.57098   6.27380   2.28448   3.43814   2.15951
diam_min               4.45668   2.98806   1.58039   0.59080   1.20294
diam_max               9.75309  10.85748   3.38480   6.35965   3.38125
caliper                8.46023  10.58266   3.36042   6.25704   3.35788
length                 8.46023  10.58266   3.36042   6.25704   3.35788
width                  6.41756   3.50114   1.65202   1.53619   1.44272
solidity               0.04674   0.04775   0.04978   0.04115   0.04928
convexity              0.85000   0.91000   0.92000   0.64000   0.92000
elongation             0.24000   0.67000   0.51000   0.75000   0.57000
circularity           20.58000  26.61000  16.95000  43.39000  19.21000
circularity_haralick   4.99000   2.67000   4.20000   2.12000   3.45000
circularity_norm       0.61000   0.47000   0.74000   0.29000   0.65000
eccentricity           0.61000   0.13000   0.38000   0.07000   0.28000
pcv                    1.36000   1.07000   3.13000   2.24000   3.12000
pcv                    1.36000   1.07000   3.13000   2.24000   3.12000
                            20        21        22        23        24
id                    16.00000  17.00000  18.00000  19.00000  20.00000
x                    858.65000 751.61000 536.84000 654.67000 199.12000
y                    557.43000 555.64000 588.83000 630.47000 665.41000
area                  25.01156   8.53289  21.76383   7.61805  41.96895
area_ch               25.72640   9.11353  22.01157   8.26321  44.48249
perimeter             20.93468  13.04900  18.57908  15.30655  27.35428
radius_mean            2.91541   1.75616   2.67056   1.93345   3.72923
radius_min             2.18440   1.17958   2.27635   0.70764   3.04038
radius_max             4.33121   2.75641   3.27203   3.43510   5.32028
radius_sd              0.61417   0.45161   0.29007   0.77724   0.50698
radius_ratio           0.10058   0.11887   0.07315   0.24689   0.08890
diam_mean              5.83082   3.51180   5.34060   3.86740   7.45795
diam_min               4.36829   2.35864   4.55270   1.41478   6.08076
diam_max               8.66191   5.51332   6.54456   6.87019  10.64057
caliper                8.33476   5.21868   5.10286   6.78078   9.17956
length                 8.33476   5.21868   5.10286   6.78078   9.17956
width                  4.57708   2.55778   5.00583   1.91313   6.90321
solidity               0.04928   0.04775   0.05029   0.04674   0.04775
convexity              0.92000   0.90000   0.85000   0.90000   0.91000
elongation             0.45000   0.51000   0.02000   0.72000   0.25000
circularity           17.52000  19.95000  15.86000  30.75000  17.83000
circularity_haralick   4.75000   3.89000   9.21000   2.49000   7.36000
circularity_norm       0.72000   0.63000   0.79000   0.41000   0.70000
eccentricity           0.41000   0.31000   0.96000   0.11000   0.65000
pcv                    1.12000   1.99000   1.10000   1.71000   1.20000
pcv                    1.12000   1.99000   1.10000   1.71000   1.20000
                            25        26        27
id                    21.00000  22.00000  23.00000
x                    767.38000 313.05000 428.12000
y                    675.03000 656.60000 696.30000
area                  32.48768   4.81418   4.45418
area_ch               33.99090   5.35741   5.36515
perimeter             24.34692  10.76401  27.85110
radius_mean            3.34315   1.42596   3.41681
radius_min             2.43027   0.83414   0.17475
radius_max             5.01498   2.42418   6.80872
radius_sd              0.64465   0.45517   1.95478
radius_ratio           0.10465   0.14783   1.98018
diam_mean              6.68680   2.85140   6.83362
diam_min               4.86004   1.66776   0.34950
diam_max              10.02944   4.84835  13.61745
caliper                8.97687   4.52120  13.52601
length                 8.97687   4.52120  13.52601
width                  5.64947   1.82982   0.53137
solidity               0.04877   0.04572   0.04216
convexity              0.85000   0.75000   0.74000
elongation             0.37000   0.60000   0.96000
circularity           18.25000  24.07000 174.15000
circularity_haralick   5.19000   3.13000   1.75000
circularity_norm       0.69000   0.52000   0.07000
eccentricity           0.46000   0.19000   0.00000
pcv                    1.03000   2.45000   0.68000
pcv                    1.03000   2.45000   0.68000</code></pre>
</div>
</div>
<p>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <code>pliman</code>. Just for simplicity, I’ll use only one object.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="rotate-polygons" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="rotate-polygons">
<span class="header-section-number">2.6</span> Rotate polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate()</a></code> can be used to rotate the polygon coordinates by an <code>angle</code> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate</a></span><span class="op">(</span><span class="va">o2</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="invert-polygons" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="invert-polygons">
<span class="header-section-number">2.7</span> Invert polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y()</a></code> can be used to flip shapes along the x and y axis, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flipped</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span>, </span>
<span>       fy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">flipped</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="perimeter-sampling" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="perimeter-sampling">
<span class="header-section-number">2.8</span> Perimeter sampling</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample()</a></code> samples <code>n</code> coordinates between existing points, and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop()</a></code> samples a proportion of coordinates between existing ones.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 50 coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample</a></span><span class="op">(</span><span class="va">o2</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 10% of coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="smoothing" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="smoothing">
<span class="header-section-number">2.9</span> smoothing</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth()</a></code> smooths the contour of a polygon by combining <code>prop</code> coordinate point samples and interpolating them using <code>vertices</code> vertices(default is 1000) .</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> original <span class="op">=</span> <span class="va">o2</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.04</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">smoothed</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="noises" class="level2" data-number="2.10"><h2 data-number="2.10" class="anchored" data-anchor-id="noises">
<span class="header-section-number">2.10</span> Noises</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter()</a></code> adds a small amount of noise to a set of coordinates. See <code><a href="https://rdrr.io/r/base/jitter.html">base::jitter()</a></code> for more details.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter</a></span><span class="op">(</span>noise_x <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              noise_y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section></section><section id="analyzing-objects" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Analyzing objects</h1>
<p>The functions we’ve seen can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. Let’s start with a simple example, using the <code>object_300dpi.png</code> image available on <a href="https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images">GitHub page</a>. To facilitate importing images from this folder, an <code><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman()</a></code> helper function is used.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"objects_300dpi.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</p>
<ul>
<li>Larger square: 10 x 10 cm (100 cm<span class="math inline">\(^2\)</span>)</li>
<li>Smaller square: 5 x 5 cm(25 cm<span class="math inline">\(^2\)</span>)</li>
<li>Rectangle: 4 x 2 cm(8 cm<span class="math inline">\(^2\)</span>)</li>
<li>Circle: 3 cm in diameter(~7.07 cm<span class="math inline">\(^2\)</span>)</li>
</ul>
<p>To count the objects in the image we use <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> and inform the image(the only required argument). By default, the <code>NB</code> index is used for object segmentation.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="adjusting-object-measurements" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="adjusting-object-measurements">
<span class="header-section-number">3.1</span> Adjusting object measurements</h2>
<p>The results were stored in <code>img_res</code>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm<span class="math inline">\(^2\)</span>, only in pixels. In this case, we use <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code> to adjust pixel measurements to metric units.</p>
<p>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area, and radius will be adjusted by the dpi informed.</p>
<section id="declaring-a-known-value" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="declaring-a-known-value">
<span class="header-section-number">3.1.1</span> Declaring a known value</h3>
<p>Since we know the area of the larger square (object 1), let’s adjust the area of the other objects in the image using this.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             <span class="va">area</span> <span class="op">~</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------
measures corrected with:
object id: 1
area     : 100
-----------------------------------------
Total    : 40.009 
Average  : 13.336 
-----------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                              2          3          4
id                      2.00000    3.00000    4.00000
x                    1736.51589 1736.57088 1736.96695
y                     451.99673 1295.35408  938.00393
area                   25.04122    7.01935    7.94891
area_ch                24.95759    7.02186    7.90671
perimeter              19.98294   10.09779   11.91303
radius_mean             2.86590    1.49087    1.66756
radius_min              2.49152    1.47805    0.98799
radius_max              3.53105    1.50513    2.22447
radius_sd               0.31408    0.00379    0.42266
diam_mean               5.73181    2.98173    3.33512
diam_min                4.98303    2.95611    1.97598
diam_max                7.06211    3.01026    4.44894
major_axis              2.04045    1.05585    1.48148
minor_axis              2.03680    1.05256    0.87434
caliper                 7.01731    2.99894    4.43833
length                  6.51989    2.99478    3.99360
width                   6.50883    2.99566    1.98719
radius_ratio            1.41723    1.01832    2.25152
theta                  -1.18050   -1.35228    0.00105
eccentricity            0.05980    0.07886    0.80727
form_factor             0.78804    0.86507    0.70384
narrow_factor           1.07629    1.00139    1.11136
asp_ratio               1.00170    0.99971    2.00967
rectangularity          1.69468    1.27809    0.99838
pd_ratio                2.84766    3.36712    2.68412
plw_ratio               1.53376    1.68565    1.99188
solidity                1.00335    0.99964    1.00534
convexity               0.74873    0.90505    0.83591
elongation              0.00170   -0.00029    0.50241
circularity            15.94643   14.52634   17.85407
circularity_haralick    9.12467  393.24974    3.94539
circularity_norm        0.78537    0.86045    0.69937
coverage                0.10684    0.02995    0.03392</code></pre>
</div>
</div>
</section><section id="declaring-the-image-resolution" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="declaring-the-image-resolution">
<span class="header-section-number">3.1.2</span> Declaring the image resolution</h3>
<p>If the image resolution is known, all measurements will be adjusted accordingly. Let’s see a numerical example with <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm()</a></code>. This function converts the number of pixels(* px *) into cm, considering the image resolution in <code>dpi</code>, as follows: <span class="math inline">\(cm = px \times(2.54 / dpi)\)</span>. As we know the number of pixels of the larger square, its perimeter in cm is given by</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span></span>
<span><span class="va">ls_px</span> <span class="op">&lt;-</span> <span class="va">img_res</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">perimeter</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm</a></span><span class="op">(</span>px <span class="op">=</span> <span class="va">ls_px</span> , dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.9265</code></pre>
</div>
</div>
<p>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <code>dpi</code> argument in <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1          2          3          4
id                     1.00000    2.00000    3.00000    4.00000
x                    667.99511 1736.51589 1736.57088 1736.96695
y                    796.99281  451.99673 1295.35408  938.00393
area                  99.81199   24.99414    7.00615    7.93396
area_ch               99.68629   24.91067    7.00866    7.89185
perimeter             39.92650   19.96415   10.08830   11.90183
radius_mean            5.72789    2.86321    1.48946    1.66599
radius_min             4.98370    2.48917    1.47666    0.98706
radius_max             7.05698    3.52773    1.50371    2.22238
radius_sd              0.62876    0.31379    0.00379    0.42226
diam_mean             11.45577    5.72641    2.97893    3.33198
diam_min               9.96740    4.97834    2.95333    1.97412
diam_max              14.11395    7.05547    3.00743    4.44476
major_axis             4.07720    2.03853    1.05486    1.48009
minor_axis             4.07190    2.03488    1.05157    0.87352
caliper               14.03942    7.01071    2.99612    4.43416
length                11.12135    6.51376    2.99197    3.98985
width                 11.10659    6.50271    2.99284    1.98532
radius_ratio           1.41601    1.41723    1.01832    2.25152
theta                  0.12122   -1.18050   -1.35228    0.00105
eccentricity           0.05093    0.05980    0.07886    0.80727
form_factor            0.78681    0.78804    0.86507    0.70384
narrow_factor          1.26238    1.07629    1.00139    1.11136
asp_ratio              1.00133    1.00170    0.99971    2.00967
rectangularity         1.23753    1.69468    1.27809    0.99838
pd_ratio               2.84388    2.84766    3.36712    2.68412
plw_ratio              1.79623    1.53376    1.68565    1.99188
solidity               1.00126    1.00335    0.99964    1.00534
convexity              0.75029    0.74873    0.90505    0.83591
elongation             0.00133    0.00170   -0.00029    0.50241
circularity           15.97128   15.94643   14.52634   17.85407
circularity_haralick   9.10975    9.12467  393.24974    3.94539
circularity_norm       0.78548    0.78537    0.86045    0.69937
coverage               0.42666    0.10684    0.02995    0.03392</code></pre>
</div>
</div>
</section><section id="understanding-measurements" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="understanding-measurements">
<span class="header-section-number">3.1.3</span> Understanding measurements</h3>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># get the contour of objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># computes the center of mass and minimum and maximum radii</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot the measurements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Larger square:</li>
<li>The minimum diameter(a = 9.97) can be considered as the side of the square</li>
<li>The maximum diameter, given by <span class="math inline">\(a \sqrt {2}\)</span> can be considered the diagonal of the square (<span class="math inline">\(9.97 \sqrt {2} = 14,099 \approx 14,105\)</span>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1          2          3          4
id                     1.00000    2.00000    3.00000    4.00000
x                    667.99511 1736.51589 1736.57088 1736.96695
y                    796.99281  451.99673 1295.35408  938.00393
area                  99.81199   24.99414    7.00615    7.93396
area_ch               99.68629   24.91067    7.00866    7.89185
perimeter             39.92650   19.96415   10.08830   11.90183
radius_mean            5.72789    2.86321    1.48946    1.66599
radius_min             4.98370    2.48917    1.47666    0.98706
radius_max             7.05698    3.52773    1.50371    2.22238
radius_sd              0.62876    0.31379    0.00379    0.42226
diam_mean             11.45577    5.72641    2.97893    3.33198
diam_min               9.96740    4.97834    2.95333    1.97412
diam_max              14.11395    7.05547    3.00743    4.44476
major_axis             4.07720    2.03853    1.05486    1.48009
minor_axis             4.07190    2.03488    1.05157    0.87352
caliper               14.03942    7.01071    2.99612    4.43416
length                11.12135    6.51376    2.99197    3.98985
width                 11.10659    6.50271    2.99284    1.98532
radius_ratio           1.41601    1.41723    1.01832    2.25152
theta                  0.12122   -1.18050   -1.35228    0.00105
eccentricity           0.05093    0.05980    0.07886    0.80727
form_factor            0.78681    0.78804    0.86507    0.70384
narrow_factor          1.26238    1.07629    1.00139    1.11136
asp_ratio              1.00133    1.00170    0.99971    2.00967
rectangularity         1.23753    1.69468    1.27809    0.99838
pd_ratio               2.84388    2.84766    3.36712    2.68412
plw_ratio              1.79623    1.53376    1.68565    1.99188
solidity               1.00126    1.00335    0.99964    1.00534
convexity              0.75029    0.74873    0.90505    0.83591
elongation             0.00133    0.00170   -0.00029    0.50241
circularity           15.97128   15.94643   14.52634   17.85407
circularity_haralick   9.10975    9.12467  393.24974    3.94539
circularity_norm       0.78548    0.78537    0.86045    0.69937
coverage               0.42666    0.10684    0.02995    0.03392</code></pre>
</div>
</div>
</section></section><section id="texture-features" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="texture-features">
<span class="header-section-number">3.2</span> Texture features</h2>
<p>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al.&nbsp;1979)<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Haralick features depend on the configuration of the parameters <code>har_nbins</code> and <code>har_scales</code>. <code>har_nbins</code> controls the number of bins used to compute the Haralick matrix. A smaller <code>har_nbins</code> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <code>har_scales</code> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To change this default, use the argument <code>har_band</code>. For example, <code>har_band = 2</code> will compute the features with the green band.</p>
<p>The following measures are returned (for more details, see <a href="https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html">this post</a>)</p>
<ul>
<li>
<code>asm</code>: The angular second-moment feature.</li>
<li>
<code>con</code>: The contrast feature</li>
<li>
<code>cor</code>: Correlation measures the linear dependency of gray levels of neighboring pixels.</li>
<li>
<code>var</code>: The variance of gray levels pixels.</li>
<li>
<code>idm</code>: The Inverse Difference Moment (IDM), i.e., the local homogeneity.</li>
<li>
<code>sav</code>: The Sum Average.</li>
<li>
<code>sva</code>: The Sum Variance.</li>
<li>
<code>sen</code>: Sum Entropy.</li>
<li>
<code>dva</code>: Difference Variance.</li>
<li>
<code>den</code>: Difference Entropy</li>
<li>
<code>f12</code>: Difference Variance.</li>
<li>
<code>f13</code>: The angular second-moment feature.</li>
</ul></section><section id="single-image-processing" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="single-image-processing">
<span class="header-section-number">3.3</span> Single image processing</h2>
<p>The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leaves_meas</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leaves_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">leaves_meas</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">leaves_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1         2
id                     1.00000   2.00000
x                    527.55799 232.98225
y                    298.91031 824.80531
area                   5.86235   3.87949
area_ch                5.94565   4.22712
perimeter             12.16180   9.94191
radius_mean            1.59090   1.14499
radius_min             0.73539   0.83769
radius_max             2.68488   1.67672
radius_sd              0.58172   0.21951
diam_mean              3.18180   2.28999
diam_min               1.47078   1.67538
diam_max               5.36976   3.35344
major_axis             1.58955   0.97653
minor_axis             0.58515   0.63683
caliper                5.23440   3.20489
length                 5.24101   3.20957
width                  1.60227   1.88314
radius_ratio           3.65097   2.00160
theta                 -1.04997  -0.04881
eccentricity           0.92978   0.75810
form_factor            0.49807   0.49322
narrow_factor          0.99874   0.99854
asp_ratio              3.27100   1.70436
rectangularity         1.43244   1.55796
pd_ratio               2.32344   3.10211
plw_ratio              1.77719   1.95219
solidity               0.98599   0.91776
convexity              0.91242   0.79138
elongation             0.69428   0.41327
circularity           25.23036  25.47800
circularity_haralick   2.73482   5.21617
circularity_norm       0.49436   0.48864
coverage               0.10392   0.06877</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot width and length</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"width"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"length"</span>, vjust <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Here, we will count the grains in the <code>grains.jpg</code> image. This image has a cyan background and contains 90 soybeans that touch each other. The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function segments the image using the normalized blue index by default, as follows <span class="math inline">\(NB =(B /(R + G + B))\)</span>, where <em>R</em>, <em>G</em> and <em>B</em> are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <code>img</code> argument(e.g., <code>img = "grains"</code>).</p>
<p>In this example, objects are counted and segmented objects are colored with random colors using the <code>show_segmentation = TRUE</code> argument. Users can set <code>show_contour = FALSE</code> to remove the contour line and identify the objects (in this example, the grains) using the <code>marker = "id"</code> arguments. The background color can also be changed with <code>col_background</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>img <span class="op">=</span> <span class="st">"grains"</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span><span class="op">$</span><span class="va">statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       stat        value
1         n 9.000000e+01
2  min_area 4.440000e+02
3 mean_area 6.731000e+02
4  max_area 8.400000e+02
5   sd_area 7.179435e+01
6  sum_area 6.057900e+04
7  coverage 5.196747e-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the measurements of the object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1         2         3         4         5
id                     1.00000   2.00000   3.00000   4.00000   5.00000
x                    350.85885 823.97070 810.25934 709.00419 806.08333
y                    410.19954 263.76794 197.83538 261.79469 341.01925
area                 840.00000 822.00000 735.00000 761.00000 755.00000
area_ch              809.00000 806.50000 711.00000 733.00000 724.00000
perimeter            104.49747 108.49747  98.49747 100.25483  99.42641
radius_mean           15.89263  15.72760  14.84635  15.11219  15.04126
radius_min            14.82535  13.73620  14.14058  12.88636  13.64198
radius_max            16.89040  17.80771  15.38458  17.04844  16.73018
radius_sd              0.47873   1.20792   0.31891   1.18211   0.81518
diam_mean             31.78526  31.45520  29.69270  30.22438  30.08252
diam_min              29.65071  27.47239  28.28116  25.77273  27.28396
diam_max              33.78080  35.61543  30.76917  34.09688  33.46037
major_axis            11.43632  11.90210  10.56633  11.46245  11.14716
minor_axis            11.04595  10.35090  10.43395   9.91827  10.13100
caliper               33.52611  35.46830  30.59412  33.83785  33.12099
length                33.49452  35.36845  30.47650  33.81768  33.01793
width                 32.03030  29.77299  30.04568  27.70773  29.39465
radius_ratio           1.13929   1.29641   1.08797   1.32298   1.22638
theta                  1.22449  -0.30022  -0.84102  -0.29657   0.58308
eccentricity           0.25904   0.49363   0.15780   0.50128   0.41714
form_factor            0.96667   0.87749   0.95202   0.95145   0.95974
narrow_factor          1.00094   1.00282   1.00386   1.00060   1.00312
asp_ratio              1.04571   1.18794   1.01434   1.22051   1.12326
rectangularity         1.27719   1.28105   1.24583   1.23129   1.28550
pd_ratio               3.11690   3.05900   3.21949   2.96280   3.00192
plw_ratio              1.59478   1.66557   1.62746   1.62949   1.59305
solidity               1.03832   1.01922   1.03376   1.03820   1.04282
convexity              0.94526   0.91214   0.90327   0.88220   0.86156
elongation             0.04372   0.15820   0.01414   0.18067   0.10974
circularity           12.99967  14.32081  13.19966  13.20766  13.09352
circularity_haralick  33.19729  13.02043  46.55411  12.78406  18.45156
circularity_norm       0.91316   0.82572   0.89568   0.89518   0.90254
coverage               0.00072   0.00071   0.00063   0.00065   0.00065
                             6
id                     6.00000
x                    817.90089
y                    713.82865
area                 739.00000
area_ch              713.00000
perimeter             98.84062
radius_mean           14.87775
radius_min            13.79271
radius_max            16.25471
radius_sd              0.61950
diam_mean             29.75550
diam_min              27.58541
diam_max              32.50943
major_axis            10.89320
minor_axis            10.15209
caliper               31.89044
length                31.76844
width                 29.09858
radius_ratio           1.17850
theta                 -1.12183
eccentricity           0.36255
form_factor            0.95057
narrow_factor          1.00384
asp_ratio              1.09175
rectangularity         1.25090
pd_ratio               3.09938
plw_ratio              1.62388
solidity               1.03647
convexity              0.88516
elongation             0.08404
circularity           13.21985
circularity_haralick  24.01584
circularity_norm       0.89333
coverage               0.00063</code></pre>
</div>
</div>
<p>In the following example, we will select objects with an area above the average of all objects using <code>lower_size = 675</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Users can also use the <code>topn _*</code> arguments to select the <code>n</code> objects based on the smallest or largest areas. Let’s see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <code>my_index</code> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <code>my_index = "B /(R + G + B)"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_lower <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                col_background <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"B /(R + G + B)"</span><span class="op">)</span> <span class="co"># normalized blue(NB)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="batch-processing" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="batch-processing">
<span class="header-section-number">3.4</span> Batch processing</h2>
<p>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in the indirect selection of high-yielding plants. In <code>pliman</code>, batch processing can be done when the user declares the <code>pattern</code> argument.</p>
<p>To speed up processing time, especially for large numbers of images, the <code>parallel = TRUE</code> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <code>R</code> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <code>workers</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>,</span>
<span>                              verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                              dir_original <span class="op">=</span> <span class="st">"soja"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     2.05      0.17      2.54 </code></pre>
</div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># parallel processing</span></span>
<span><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>,</span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                    dir_original <span class="op">=</span> <span class="st">"soja"</span>,</span>
<span>                    parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     0.12      0.00     17.77 </code></pre>
</div>
</div>
</section></section><section id="object-coordinates" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Object coordinates</h1>
<p>Users can get the coordinates for all desired objects with <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord()</a></code>. When the <code>id</code> argument is set to <code>NULL</code> (default), a bounding rectangle is drawn including all objects. Use <code>id = "all"</code> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <code>watershed = FALSE</code> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</p>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the id of each object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_id</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     xleft xright ybottom ytop
[1,]    39    701      48  936</code></pre>
</div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get coordinates for all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     xleft xright ybottom ytop
[1,]   378    701      48  602
[2,]    39    424     709  936</code></pre>
</div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span><span class="co"># 20 border pixels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             edge <span class="op">=</span> <span class="fl">20</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-4.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     xleft xright ybottom ytop
[1,]   360    719      30  620</code></pre>
</div>
</div>
</section><section id="isolating-objects" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Isolating objects</h1>
<p>Knowing the coordinates of each object, it is possible to isolate it. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate()</a></code> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 edge <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">id1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/object3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="including-objects-in-a-list" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Including objects in a list</h1>
<p><code><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split()</a></code> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</p>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==============================
Summary of the procedure
==============================
Number of objects: 2 
Average area     : 67935 
Minimum area     : 54096 
Maximum area     : 81774 
Objects created  : 2 
==============================</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ 1:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:326, 1:557, 1:3] 0.427 0.427 0.427 0.431 0.416 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 326 557 3
 $ 2:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:386, 1:230, 1:3] 0.463 0.467 0.478 0.459 0.451 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 386 230 3</code></pre>
</div>
</div>
</section><section id="rgb-values-for-each-object" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> RGB values for each object</h1>
<p>To get the RGB intensity of each object in the image, we use the <code>object_rgb = TRUE</code> argument in the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. In the following example, we will use the R, G and B bands and their normalized values. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes()</a></code> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g.&nbsp;<code>object_index = "B/G+R"</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"flax.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">indx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "R"     "G"     "B"     "NR"    "NG"    "NB"    "GB"    "RB"    "GR"   
[10] "BI"    "BIM"   "SCI"   "GLI"   "HI"    "NGRDI" "NDGBI" "NDRBI" "I"    
[19] "S"     "VARI"  "HUE"   "HUE2"  "BGI"   "L"     "GRAY"  "GLAI"  "CI"   
[28] "SHP"   "RI"    "G-B"   "G-R"   "R-G"   "R-B"   "B-R"   "B-G"   "DGCI" 
[37] "GRAY2" "L*"    "a"     "b*"    "L*-a"  "L*-b"  "b*-a" </code></pre>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flax_leaves</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span> ,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  object_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  pixel_level_index <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PCA with the indices</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">flax_leaves</span>, type <span class="op">=</span><span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Columns GB, RB, HI, SHP, RI with infinite/NA values removed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(eigenvalue): NaNs produzidos</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>R</code> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Now, let’s plot the <code>DGCI</code> (Dark Green Color Index) on each object. The DGCI is based on the HSB (Hue, Saturation, and Brightness) space color and has been used as an indicator of the darkness of the green color <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span>, measure <span class="op">=</span> <span class="st">"DGCI"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>It seems that leaves with an average DGCI value of less than 0.4 can be considered “Yellowish” leaves. Users can then work with this feature and adapt it to their case.</p>
<div class="cell">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>                index <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>                cut_point <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Columns GB, RB, HI, SHP, RI with infinite/NA values removed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(eigenvalue): NaNs produzidos</code></pre>
</div>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">report</span><span class="op">$</span><span class="va">ids</span></span>
<span><span class="va">report</span><span class="op">$</span><span class="va">between_id</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    n nsel      prop mean_index_sel mean_index_nsel
1 156   34 0.2179487      0.3605177       0.6151214</code></pre>
</div>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span><span class="op">[</span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id         x         y n_less n_greater less_ratio greater_ratio
33   33  411.2955  193.0278    567       194      0.745         0.255
46   46 1210.7760  262.1628   1350       121      0.918         0.082
54   54  968.9355  277.1675    588       152      0.795         0.205
82   82  212.8252  403.4821    826        94      0.898         0.102
84   86 1015.7916  439.0643    682       140      0.830         0.170
86   88 1356.2915  444.4434   1011       163      0.861         0.139
91   93 1410.8280  449.3729   1230        22      0.982         0.018
93   95 1211.4498  470.4446    868       214      0.802         0.198
97   99  702.7143  527.2268    872        82      0.914         0.086
102 104  811.2008  554.1447   1156        37      0.969         0.031
105 107 1478.2658  536.0117    571        87      0.868         0.132
107 109  527.7322  575.4593   1380       142      0.907         0.093
108 110 1214.9970  600.8662    866         2      0.998         0.002
109 111 1018.1722  593.1940    981       239      0.804         0.196
110 112 1453.2494  603.1382    856       673      0.560         0.440
114 116 1390.3908  647.5456   1192       225      0.841         0.159
116 119 1319.1235  663.9558    626         3      0.995         0.005
120 123  388.1048  685.2422    863       432      0.666         0.334
122 125  438.4210  713.7525    724       228      0.761         0.239
123 126 1102.7345  701.4443    794       595      0.572         0.428
124 127  225.4042  695.3136    871       205      0.809         0.191
129 132  893.3411  706.0923    545        55      0.908         0.092
132 136 1224.0432  778.8951    626       128      0.830         0.170
134 137  719.3392  796.4026    710        15      0.979         0.021
137 140  770.8562  807.8198   1332        89      0.937         0.063
144 147 1106.1427  869.9452   1300         6      0.995         0.005
146 149  396.4064  904.0924   1277       267      0.827         0.173
148 151  147.2097  870.4569   1270       278      0.820         0.180
151 155  896.3308  918.5319    936       424      0.688         0.312
155 159  220.3641  988.6054    800        18      0.978         0.022
157  84  702.7616 1030.7817   1018        NA         NA            NA
158  85  865.5592 1035.2224    895        NA         NA            NA
159 117  965.9459 1050.1934    756        NA         NA            NA
160 152  483.7303 1054.4670   1004        NA         NA            NA</code></pre>
</div>
</div>
<p>In the following graph, I plot the distribution of the RGB values “Yellowish” and “Greenish” leaves R, G, and B values.</p>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># distribution of RGB values</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">rgbs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">flax_leaves</span><span class="op">$</span><span class="va">object_rgb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">h</span>, <span class="va">s</span>, <span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span>, <span class="st">"Yellowish"</span>, <span class="st">"Greenish"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">rgbs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">type</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 74 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Now, using the ids of each grain, I plot the values only in the “yello” leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>              id <span class="op">=</span> <span class="va">ids</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>              id <span class="op">=</span> <span class="va">flax_leaves</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="op">!</span><span class="va">flax_leaves</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span><span class="op">]</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="leaf-area" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Leaf area</h1>
<section id="known-resolution" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="known-resolution">
<span class="header-section-number">8.1</span> Known resolution</h2>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B-G"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using images with known resolution</span></span>
<span><span class="va">af_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">af</span>, dpi <span class="op">=</span> <span class="fl">45.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" cyan "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># declaring the measure of a known object</span></span>
<span><span class="va">af_cor2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">af</span>,</span>
<span>               id <span class="op">=</span> <span class="fl">18</span>,</span>
<span>               measure <span class="op">=</span> <span class="va">area</span> <span class="op">~</span> <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------
measures corrected with:
object id: 18
area     : 25
-----------------------------------------
Total    : 796.959 
Average  : 36.225 
-----------------------------------------</code></pre>
</div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor2</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">35</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="reference-object-dev-version" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="reference-object-dev-version">
<span class="header-section-number">8.2</span> Reference object (dev version)</h2>
<section id="single-images" class="level3" data-number="8.2.1"><h3 data-number="8.2.1" class="anchored" data-anchor-id="single-images">
<span class="header-section-number">8.2.1</span> Single images</h3>
<p>The <code>reference</code> argument can now be used to correct the object measures even when images with different shooting distances are used. This differs from the previous example (declaring the object with the known area) in a subtle, but crucial aspect: when <code>reference</code> is informed, batch processing can be used! In this example, the leaf area of the <code>ref_leaves</code> image is quantified and corrected considering a 5 x 5 (25 cm<span class="math inline">\(^2\)</span>) red square as the reference object. When <code>reference = TRUE</code> is informed in <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> the function will perform a two-step process of object segmentation; so, the time processing is a bit slower.</p>
<p>The first step consists in segmenting the foreground (leaves and reference object) from the background. To do that, an image index is used and can be declared in the <code>back_fore_index</code>. The default (<code>back_fore_index = "R/(G/B)"</code>) is optimized to segment white backgrounds from green leaves and a blue reference object. Let’s see how this index performs in this example.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"R/(G/B)"</span>, plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Index 'R/(G/B)' is not available. Trying to compute your own index.</code></pre>
</div>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"R/(G/B)"</span>, plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Index 'R/(G/B)' is not available. Trying to compute your own index.</code></pre>
</div>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">ind</span>, <span class="va">bin</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>This index definitively is not the better option in this case. Will some other available index be better?</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The number of layers is too large and plots may not fit well to the
plot area. Consider reducing the number of indexes used.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>B-G</code> index seems to be a good candidate.</p>
<div class="cell">
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"B-G"</span>, plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">seg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"B-G"</span>, plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">ind</span>, <span class="va">seg1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Good job! now, we have the background removed. The next step is to segment the objects and the reference template. We basically need to repeat the previous step isolating the reference.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># see the better index</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">seg1</span>, index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The number of layers is too large and plots may not fit well to the
plot area. Consider reducing the number of indexes used.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>R-G</code> is a good candidate. So, I’ll perform the second segmentation using this index.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">seg2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">seg1</span>,</span>
<span>               index <span class="op">=</span> <span class="st">"R-G"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of pixels in the reference object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">seg2</span><span class="op">$</span><span class="va">`R-G`</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8108</code></pre>
</div>
</div>
<p>Now that we know the indexes to be used for each segmentation, we can use the function <code>analyze_objects</code> to get the corrected measures based on the reference object.</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>, </span>
<span>                  reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  reference_area <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                  back_fore_index <span class="op">=</span> <span class="st">"B-G"</span>,</span>
<span>                  fore_ref_index <span class="op">=</span> <span class="st">"R-G"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the measures corrected by the image resolution</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" cyan "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="multiple-images" class="level3" data-number="8.2.2"><h3 data-number="8.2.2" class="anchored" data-anchor-id="multiple-images">
<span class="header-section-number">8.2.2</span> Multiple images</h3>
<p>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<code>-</code>) or underscore (<code>_</code>). Then, when using <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>, measurements from leaf images called, for example, <code>F1-1.jpeg</code>, <code>F1_2.jpeg</code> and <code>F1-3.jpeg</code> will be combined into a single image (<code>F1</code>), displayed in the <code>merge</code> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</p>
<p>In the following example, 36 images will be analyzed. These images contain flax leaves from 12 evaluation dates, with three replications<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Note that to ensure that all images are processed, all images must share a common pattern, in this case (<code>"A"</code>). Here, I will use the <code>pattern = "A"</code> to indicate that all images with this pattern name should be merged.</p>
<div class="cell">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                  dir_original <span class="op">=</span> <span class="st">"linhaca"</span>,</span>
<span>                  reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  reference_area <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Processing 36 images in multiple sessions (6). Please, wait.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
     Image Objects
   A1_28_1      18
   A1_28_2      29
   A1_28_3      28
  A10_90_1     149
  A10_90_2     116
  A10_90_3      77
  A11_98_1     133
  A11_98_2     154
  A11_98_3     119
 A12_105_1     111
 A12_105_2     127
 A12_105_3     155
   A2_32_1      24
   A2_32_2      25
   A2_32_3      31
   A3_42_1      39
   A3_42_2      47
   A3_42_3      54
   A4_46_1      57
   A4_46_2      38
   A4_46_3      56
   A5_55_1      53
   A5_55_2      74
   A5_55_3      63
   A6_63_1      68
   A6_63_2     105
   A6_63_3      83
   A7_70_1      98
   A7_70_2     111
   A7_70_3     112
   A8_76_1     113
   A8_76_2     116
   A8_76_3     113
   A9_83_1     119
   A9_83_2      89
   A9_83_3     100
--------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Elapsed time: 00:00:40</code></pre>
</div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>merged</code> is a list with three objects:</p>
<ul>
<li>
<code>results</code>: a data frame that contains the measurements of each individual object (in this case, an individual leaf) of each analyzed image.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">results</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1          2          3          4          5         
img                  "A1_28_1"  "A1_28_1"  "A1_28_1"  "A1_28_1"  "A1_28_1" 
id                   "1"        "2"        "3"        "4"        "5"       
x                    "372.0789" "421.4407" "162.9520" "126.3978" "266.4682"
y                    "315.9907" "319.3856" "349.6462" "386.7082" "399.5777"
area                 "0.11514"  "0.15914"  "0.15721"  "0.19485"  "0.20121" 
area_ch              "0.15056"  "0.19042"  "0.15098"  "0.19291"  "0.22515" 
perimeter            "2.09472"  "2.11421"  "1.70686"  "2.29741"  "2.13036" 
radius_mean          "0.24918"  "0.26147"  "0.23023"  "0.30151"  "0.26289" 
radius_min           "0.00981"  "0.06450"  "0.11653"  "0.09891"  "0.11571" 
radius_max           "0.47779"  "0.45243"  "0.36772"  "0.51707"  "0.42928" 
radius_sd            "0.12621"  "0.11123"  "0.07650"  "0.13080"  "0.09084" 
diam_mean            "0.49836"  "0.52294"  "0.46046"  "0.60303"  "0.52578" 
diam_min             "0.01962"  "0.12899"  "0.23307"  "0.19781"  "0.23143" 
diam_max             "0.95558"  "0.90487"  "0.73543"  "1.03413"  "0.85855" 
major_axis           "0.26979"  "0.26867"  "0.21949"  "0.31601"  "0.24862" 
minor_axis           "0.07137"  "0.09192"  "0.10304"  "0.08948"  "0.12441" 
caliper              "0.91076"  "0.87337"  "0.72478"  "1.02769"  "0.80493" 
length               "0.90912"  "0.87174"  "0.72291"  "1.02496"  "0.80212" 
width                "0.23326"  "0.30972"  "0.28295"  "0.23797"  "0.42684" 
radius_ratio         "48.71382" " 7.01490" " 3.15544" " 5.22783" " 3.70981"
theta                "-1.46559" " 1.32218" " 0.08942" "-0.58010" "-1.17190"
eccentricity         "0.96438"  "0.93965"  "0.88296"  "0.95907"  "0.86580" 
form_factor          "0.32974"  "0.44741"  "0.67808"  "0.46390"  "0.55713" 
narrow_factor        "1.00180"  "1.00187"  "1.00259"  "1.00267"  "1.00351" 
asp_ratio            "3.89739"  "2.81464"  "2.55492"  "4.30702"  "1.87920" 
rectangularity       "1.84187"  "1.69655"  "1.30113"  "1.25182"  "1.70157" 
pd_ratio             "2.29997"  "2.42074"  "2.35500"  "2.23550"  "2.64662" 
plw_ratio            "1.83363"  "1.78949"  "1.69693"  "1.81911"  "1.73347" 
solidity             "0.76471"  "0.83576"  "1.04125"  "1.01004"  "0.89367" 
convexity            "0.55229"  "0.55353"  "0.91615"  "0.91475"  "0.74206" 
elongation           "0.74342"  "0.64472"  "0.60860"  "0.76782"  "0.46786" 
circularity          "38.10998" "28.08723" "18.53230" "27.08857" "22.55541"
circularity_haralick "1.97429"  "2.35064"  "3.00944"  "2.30524"  "2.89416" 
circularity_norm     "0.28456"  "0.40228"  "0.62197"  "0.42601"  "0.51422" 
coverage             "0.00113"  "0.00156"  "0.00154"  "0.00191"  "0.00197" </code></pre>
</div>
</div>
<ul>
<li>
<code>summary</code> : a data frame that contains the summary of the results, containing the number of objects in each image (<code>n</code>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">summary</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1            2            3            4            
img                  "imgA1_28_1" "imgA1_28_2" "imgA1_28_3" "imgA10_90_1"
n                    " 18"        " 29"        " 28"        "149"        
area_sum             "  2.56594"  "  6.29361"  "  7.04808"  "171.90417"  
area_mean            "0.14255"    "0.21702"    "0.25172"    "1.15372"    
area_sd              "0.05759"    "0.07495"    "0.09524"    "0.43971"    
area_ch              "0.16279"    "0.21887"    "0.27358"    "1.21400"    
perimeter            "2.00362"    "2.71748"    "2.71511"    "6.54996"    
radius_mean          "0.24832"    "0.34275"    "0.33846"    "0.81144"    
radius_min           "0.07567"    "0.07876"    "0.10713"    "0.18661"    
radius_max           "0.43423"    "0.62526"    "0.60196"    "1.50957"    
radius_sd            "0.10638"    "0.16549"    "0.14840"    "0.40285"    
diam_mean            "0.49665"    "0.68550"    "0.67693"    "1.62288"    
diam_min             "0.15134"    "0.15753"    "0.21426"    "0.37322"    
diam_max             "0.86847"    "1.25052"    "1.20392"    "3.01914"    
major_axis           "0.25413"    "0.37116"    "0.35314"    "0.88572"    
minor_axis           "0.08556"    "0.08191"    "0.10610"    "0.18347"    
caliper              "0.83830"    "1.23288"    "1.17672"    "2.97301"    
length               "0.83666"    "1.23244"    "1.17617"    "2.97448"    
width                "0.26194"    "0.22838"    "0.30106"    "0.51589"    
radius_ratio         " 8.74014"   "10.30621"   " 5.72830"   " 9.70617"   
theta                " 0.02449"   "-0.10613"   " 0.26184"   " 0.07055"   
eccentricity         "0.92820"    "0.97374"    "0.95030"    "0.97749"    
form_factor          "0.46118"    "0.36111"    "0.43781"    "0.33784"    
narrow_factor        "1.00176"    "1.00039"    "1.00069"    "0.99980"    
asp_ratio            "3.88030"    "5.64527"    "4.24631"    "6.23272"    
rectangularity       "1.51394"    "1.32901"    "1.39147"    "1.33923"    
pd_ratio             "2.36860"    "2.20665"    "2.29786"    "2.19253"    
plw_ratio            "1.81024"    "1.86072"    "1.83281"    "1.87284"    
solidity             "0.95496"    "0.98661"    "0.98786"    "1.01775"    
convexity            "0.77426"    "0.77286"    "0.84992"    "0.85640"    
elongation           "0.69142"    "0.81273"    "0.74698"    "0.82959"    
circularity          "30.16456"   "36.25009"   "29.78587"   "38.46601"   
circularity_haralick "2.37631"    "2.08159"    "2.31270"    "2.01769"    
circularity_norm     "0.41143"    "0.32685"    "0.40763"    "0.30386"    
coverage             "0.00140"    "0.00128"    "0.00141"    "0.00076"    
                     5            
img                  "imgA10_90_2"
n                    "116"        
area_sum             "119.06277"  
area_mean            "1.02640"    
area_sd              "0.33712"    
area_ch              "1.13381"    
perimeter            "6.38542"    
radius_mean          "0.77889"    
radius_min           "0.16397"    
radius_max           "1.46491"    
radius_sd            "0.39273"    
diam_mean            "1.55778"    
diam_min             "0.32795"    
diam_max             "2.92982"    
major_axis           "0.85230"    
minor_axis           "0.17488"    
caliper              "2.87974"    
length               "2.87874"    
width                "0.50404"    
radius_ratio         "10.20943"   
theta                " 0.03805"   
eccentricity         "0.97582"    
form_factor          "0.33066"    
narrow_factor        "1.00079"    
asp_ratio            "6.24416"    
rectangularity       "1.39066"    
pd_ratio             "2.20709"    
plw_ratio            "1.88076"    
solidity             "0.99459"    
convexity            "0.85418"    
elongation           "0.82530"    
circularity          "40.13084"   
circularity_haralick "2.00092"    
circularity_norm     "0.29394"    
coverage             "0.00069"    </code></pre>
</div>
</div>
<p>The <code>area_sum</code> of img <code>A1_28_1</code> is the sum of the 18 leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">merged</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.56595</code></pre>
</div>
</div>
<ul>
<li>
<code>merge</code>: a data frame that contains the results merged by image prefix (In this case, A1 to A12).</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">merge</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1           2           3           4          
img                  "imgA1"     "imgA10"    "imgA11"    "imgA12"   
n                    " 75"       "342"       "406"       "393"      
area_sum             " 15.90763" "364.00764" "478.02200" "368.89681"
area_mean            "0.20376"   "1.04290"   "1.20252"   "0.95738"  
area_sd              "0.07593"   "0.29574"   "0.44633"   "0.33975"  
area_ch              "0.21841"   "1.09549"   "1.25403"   "0.98737"  
perimeter            "2.47874"   "6.57315"   "6.76831"   "6.16784"  
radius_mean          "0.30984"   "0.80629"   "0.83100"   "0.76035"  
radius_min           "0.08719"   "0.16293"   "0.18562"   "0.15426"  
radius_max           "0.55382"   "1.52077"   "1.55450"   "1.42725"  
radius_sd            "0.14009"   "0.41090"   "0.41521"   "0.38635"  
diam_mean            "0.61969"   "1.61258"   "1.66199"   "1.52070"  
diam_min             "0.17437"   "0.32586"   "0.37125"   "0.30851"  
diam_max             "1.10764"   "3.04155"   "3.10900"   "2.85450"  
major_axis           "0.32614"   "0.88784"   "0.90842"   "0.83691"  
minor_axis           "0.09119"   "0.16641"   "0.18464"   "0.15716"  
caliper              "1.08263"   "3.00044"   "3.06851"   "2.81646"  
length               "1.08175"   "3.00048"   "3.06880"   "2.81631"  
width                "0.26380"   "0.46698"   "0.51461"   "0.43114"  
radius_ratio         " 8.25822"  "10.63699"  "10.35437"  " 9.96570" 
theta                "0.06007"   "0.02661"   "0.10848"   "0.19753"  
eccentricity         "0.95075"   "0.98051"   "0.97600"   "0.97927"  
form_factor          "0.42003"   "0.30940"   "0.32598"   "0.32386"  
narrow_factor        "1.00095"   "1.00023"   "1.00011"   "1.00023"  
asp_ratio            "4.59062"   "6.92547"   "6.39061"   "6.73768"  
rectangularity       "1.41147"   "1.33254"   "1.33934"   "1.28724"  
pd_ratio             "2.29103"   "2.18462"   "2.20346"   "2.19193"  
plw_ratio            "1.83459"   "1.89170"   "1.88509"   "1.89288"  
solidity             "0.97648"   "1.00830"   "1.00417"   "1.00802"  
convexity            "0.79901"   "0.85295"   "0.84057"   "0.83455"  
elongation           "0.75038"   "0.84453"   "0.83136"   "0.84134"  
circularity          "32.06684"  "42.44614"  "40.09633"  "40.85288" 
circularity_haralick "2.25686"   "1.97161"   "2.01276"   "1.98964"  
circularity_norm     "0.38197"   "0.27674"   "0.29551"   "0.29044"  
coverage             "0.00136"   "0.00070"   "0.00081"   "0.00075"  
                     5          
img                  "imgA2"    
n                    " 80"      
area_sum             " 21.44658"
area_mean            "0.26849"  
area_sd              "0.12016"  
area_ch              "0.30438"  
perimeter            "2.83415"  
radius_mean          "0.35092"  
radius_min           "0.09725"  
radius_max           "0.62590"  
radius_sd            "0.15732"  
diam_mean            "0.70185"  
diam_min             "0.19451"  
diam_max             "1.25180"  
major_axis           "0.36743"  
minor_axis           "0.10928"  
caliper              "1.22042"  
length               "1.21789"  
width                "0.32062"  
radius_ratio         " 9.67376" 
theta                "0.08814"  
eccentricity         "0.94696"  
form_factor          "0.43987"  
narrow_factor        "1.00180"  
asp_ratio            "4.17961"  
rectangularity       "1.43860"  
pd_ratio             "2.30524"  
plw_ratio            "1.82475"  
solidity             "0.96833"  
convexity            "0.83413"  
elongation           "0.73372"  
circularity          "30.65038" 
circularity_haralick "2.29773"  
circularity_norm     "0.40617"  
coverage             "0.00170"  </code></pre>
</div>
</div>
<p>Below, I will fit a non-linear model (Logistic) to model the leaf area evolution across the crop cycle.</p>
<div>
<details><summary>Code</summary><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">merged</span><span class="op">$</span><span class="va">summary</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/separate_col.html">separate_col</a></span><span class="op">(</span><span class="va">img</span>, </span>
<span>               into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"avaliacao"</span>, <span class="st">"das"</span>, <span class="st">"bloco"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>das <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">das</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot </span></span>
<span></span>
<span><span class="va">my_theme</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># leaf area</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">das</span>, <span class="va">area_sum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">248</span>,</span>
<span>                                           b2 <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                           b3 <span class="op">=</span> <span class="fl">0.07</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">$</span><span class="va">das</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days after sowing"</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Área</span><span class="op">~</span><span class="va">foliar</span><span class="op">~</span><span class="va">média</span><span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="fl">2</span><span class="op">~</span><span class="va">planta</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span>
<span><span class="co"># number of leaves</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">das</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">188</span>,</span>
<span>                                           b2 <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                           b3 <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">$</span><span class="va">das</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days after sowing"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of leaves per plant"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="03_analyze_files/figure-html/merge9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="03_analyze_files/figure-html/merge9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section></section><section id="filling-holes" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="filling-holes">
<span class="header-section-number">8.3</span> Filling ‘holes’</h2>
<p>An important aspect to consider in leaf area measures is when leaves present ‘holes’. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</p>
<div class="cell">
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"holes.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>In this case, the missing area will not be computed using the default settings of <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>. To include this area as the leaf area, we can use the argument <code>fill_hull()</code>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</p>
<div class="cell">
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fill the missing area</span></span>
<span><span class="va">af2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  fill_hull <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  plot <span class="op">=</span>  <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  prefix <span class="op">=</span> <span class="st">"proc2_"</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"proc"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can simply use the ratio between <code>proc_img</code> and <code>proc_img2</code> to compute the injured area in this leaflet.</p>
<div class="cell">
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># percent of the injured area</span></span>
<span><span class="fl">100</span> <span class="op">-</span> <span class="fl">86432</span> <span class="op">/</span> <span class="fl">99186</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.85867</code></pre>
</div>
</div>
</section><section id="compound-leaves" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="compound-leaves">
<span class="header-section-number">8.4</span> Compound leaves</h2>
<p>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</p>
<p>The following images by <a href="https://www.florestaombrofilamista.com.br/sidol/?menu=contact">Daniel Saueressig</a> were obtained from the <em>Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista</em><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> and show examples of simple and compound leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imgs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_horizontal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc1-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm<span class="math inline">\(^2\)</span>. With this information, it is possible to obtain the image resolution with <code>dpi(simple)</code>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</p>
<div class="cell">
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simple</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">simple.jpg</span></span>
<span><span class="va">sarea</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <code>object_size = "large"</code> or <code>watershed = FALSE</code>, to omit the watershed segmentation algorithm. The last is used here.</p>
<div class="cell">
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">sarea</span>, dpi <span class="op">=</span> <span class="fl">48.65</span><span class="op">)</span></span>
<span><span class="va">sarea_cor</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             1         2
id                     1.00000   2.00000
x                    182.30988 177.83018
y                     67.65594 183.76066
area                  20.00228  41.39746
area_ch               31.85154  56.24925
perimeter             31.52950  41.28656
radius_mean            3.03137   4.28452
radius_min             1.09831   1.06972
radius_max             5.71519   7.95304
radius_sd              1.21685   1.80229
diam_mean              6.06273   8.56904
diam_min               2.19662   2.13943
diam_max              11.43038  15.90607
major_axis             3.05069   4.36690
minor_axis             1.16636   1.59089
caliper               11.06845  14.95531
length                11.06847  15.47434
width                  4.69925   6.04070
radius_ratio           5.20362   7.43472
theta                 -0.00016  -0.07118
eccentricity           0.92403   0.93128
form_factor            0.25285   0.30519
narrow_factor          1.00000   0.96646
asp_ratio              2.35537   2.56168
rectangularity         2.60038   2.25801
pd_ratio               2.84859   2.76066
plw_ratio              1.99962   1.91896
solidity               0.62798   0.73596
convexity              0.77953   0.67022
elongation             0.57544   0.60963
circularity           49.69980  41.17595
circularity_haralick   2.49116   2.37726
circularity_norm       0.24365   0.29814
coverage               0.08788   0.18188</code></pre>
</div>
</div>
<p>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">compound</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">compound.jpg</span></span>
<span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc4-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Therefore, using <code>watershed = FALSE</code> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</p>
<div class="cell">
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc5-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">carea</span>, dpi <span class="op">=</span> <span class="fl">49.5</span><span class="op">)</span></span>
<span><span class="va">carea_cor</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             3         4
id                     3.00000   4.00000
x                     89.22055 242.57443
y                    111.31761 112.69170
area                  18.84728  15.83509
area_ch               43.16207  33.09070
perimeter             54.54305  48.70669
radius_mean            2.54616   2.24631
radius_min             0.05956   0.02471
radius_max             5.93998   4.94236
radius_sd              1.26133   1.14489
diam_mean              5.09232   4.49263
diam_min               0.11913   0.04943
diam_max              11.87996   9.88471
major_axis             2.20953   2.05408
minor_axis             1.78609   1.46145
caliper                9.27193   7.37643
length                 9.33971   8.10641
width                  7.14337   6.44205
radius_ratio          99.72535 199.98693
theta                 -1.23490   1.29832
eccentricity           0.58869   0.70270
form_factor            0.07961   0.08388
narrow_factor          0.99274   0.90995
asp_ratio              1.30747   1.25836
rectangularity         3.53988   3.29786
pd_ratio               5.88260   6.60302
plw_ratio              3.30903   3.34789
solidity               0.43666   0.47854
convexity              0.38233   0.41166
elongation             0.23516   0.20531
circularity          157.84475 149.81551
circularity_haralick   2.01864   1.96203
circularity_norm       0.07452   0.07817
coverage               0.08572   0.07202</code></pre>
</div>
</div>
</section></section><section id="shapefiles" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Shapefiles</h1>
<p>Orthomosaic kindly provided by Prof.&nbsp;Dr.&nbsp;<a href="https://www.researchgate.net/profile/Ivan-Carvalho-4">Ivan Ricardo Carvalho</a> (UNIJUÍ)</p>
<div class="cell">
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"mosaic.jpg"</span><span class="op">)</span></span>
<span><span class="va">aligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_rotate</a></span><span class="op">(</span><span class="va">shp</span>, angle <span class="op">=</span> <span class="fl">82.591</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cropped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_crop</a></span><span class="op">(</span><span class="va">aligned</span>,</span>
<span>                      width <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">2920</span>,</span>
<span>                      height <span class="op">=</span> <span class="fl">1350</span><span class="op">:</span><span class="fl">1625</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># or using the mapview option</span></span>
<span><span class="co"># cropped &lt;- image_prepare_mv(shp)</span></span>
<span><span class="va">anal</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects_shp.html">analyze_objects_shp</a></span><span class="op">(</span><span class="va">cropped</span>,</span>
<span>                      prepare <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      ncol <span class="op">=</span> <span class="fl">13</span>,</span>
<span>                      index <span class="op">=</span> <span class="st">"HUE"</span>,</span>
<span>                      object_index <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anal</span><span class="op">$</span><span class="va">final_image_masked</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anal</span><span class="op">$</span><span class="va">shapefiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">anal</span>, measure <span class="op">=</span> <span class="st">"coverage"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">160</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">anal</span>, measure <span class="op">=</span> <span class="st">"DGCI"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">185</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="fourier-analyses" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Fourier analyses</h1>
<section id="functions" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="functions">
<span class="header-section-number">10.1</span> Functions</h2>
<p>The functions were adapted from Claude (2088)<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
</section><section id="elliptical-fourier" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="elliptical-fourier">
<span class="header-section-number">10.2</span> Elliptical fourier</h2>
<div class="cell">
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ind"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">conts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">imgs</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier.html">efourier</a></span><span class="op">(</span><span class="va">conts</span>, nharm <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">efi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_inv.html">efourier_inv</a></span><span class="op">(</span><span class="va">ef</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>, nharm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">efi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_inv.html">efourier_inv</a></span><span class="op">(</span><span class="va">ef</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>, nharm <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">efi3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_inv.html">efourier_inv</a></span><span class="op">(</span><span class="va">ef</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>, nharm <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">efi1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">efi2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">efi3</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="rotation-and-size" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="rotation-and-size">
<span class="header-section-number">10.3</span> Rotation and size</h2>
<div class="cell">
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"changes.png"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ef</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier.html">efourier</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_norm.html">efourier_norm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_coefs.html">efourier_coefs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  object A1          A2           A3          A4          A5          A6
1      1  1 -0.02075229 -0.001967149 -0.02243785 -0.01051923 -0.02631046
2      2 -1  0.05347429  0.005280597  0.03800024  0.01186258  0.05128006
3      3  1 -0.01316395 -0.002955584 -0.01750128 -0.01291722 -0.02049034
             A7           A8           A9          A10            B1         B2
1  0.0015605953 -0.006927166 -0.011259484  0.004915726 -3.044942e-17 -0.3949627
2 -0.0005919858  0.014879933  0.009298835 -0.010101305 -2.785724e-16  0.3912420
3  0.0010814994 -0.003907685 -0.010955053  0.004655006  7.638715e-18 -0.3969607
             B3         B4           B5          B6           B7          B8
1 -0.0003923146 -0.1202646 -0.002084410 -0.09945037 -0.002193451 -0.03342269
2  0.0146176740  0.1166273 -0.001846976  0.08874169  0.002321198  0.03056498
3  0.0030213897 -0.1212294 -0.001632096 -0.09895883 -0.001303100 -0.03134100
             B9         B10            C1          C2          C3          C4
1 -0.0002261568  0.01457887  0.000000e+00  0.10442995  0.03222546 -0.06960008
2 -0.0050153344 -0.01110277 -3.482156e-16 -0.09969635 -0.07453366  0.06915561
3 -0.0006675290  0.01620912  3.819357e-18  0.10565086  0.02465100 -0.06874620
           C5          C6           C7          C8           C9          C10
1  0.01617662  0.04154609  0.009682157 -0.04718118 -0.001724962  0.007288867
2 -0.02598072 -0.03852236 -0.019599632  0.04202645  0.006442364 -0.006935145
3  0.01291151  0.04239523  0.006671048 -0.04783110 -0.001079465  0.006609363
          D1          D2         D3           D4          D5           D6
1 -0.9523335 -0.01969877  0.3351972 -0.001506831  0.04915802 -0.003672522
2  0.9531687  0.04780208 -0.3290529 -0.006601458 -0.04505256  0.016706985
3 -0.9502921 -0.01514573  0.3383713 -0.001711505  0.05055679 -0.001177859
           D7          D8           D9          D10
1  0.03955211  0.01431461 -0.010822192 0.0011125890
2 -0.03592838 -0.02672881  0.008299971 0.0010049357
3  0.03811810  0.01118330 -0.011920117 0.0006020825</code></pre>
</div>
</div>
</section><section id="morphological-diversity" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="morphological-diversity">
<span class="header-section-number">10.4</span> Morphological diversity</h2>
<div class="cell">
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">conts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">imgs</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 plot <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier.html">efourier</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_norm.html">efourier_norm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_coefs.html">efourier_coefs</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">conts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">object</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>specie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"specie"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'factoextra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:metan':

    get_dist</code></pre>
</div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'FactoMineR' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">coefs</span>, quali.sup <span class="op">=</span> <span class="fl">1</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">pca</span>, habillage <span class="op">=</span> <span class="fl">1</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-58-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section></section><section id="distance-to-an-ideotype" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Distance to an ideotype</h1>
<div class="cell">
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#| out-width: "100%"</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"distance.png"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 plot <span class="op">=</span>  <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">efs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">cont</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier.html">efourier</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_norm.html">efourier_norm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/efourier_coefs.html">efourier_coefs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">desc_ide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">efs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">desc_objs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">efs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute the differences between each object and the ideotype</span></span>
<span><span class="va">gen_ide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">desc_objs</span>, <span class="fl">2</span>, <span class="va">desc_ide</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">distances</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">gen_ide</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">distances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          2           6           3           5           4 
0.002371749 0.128478398 2.331976897 2.430066643 2.458400351 </code></pre>
</div>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section><div id="quarto-appendix" class="default"><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019–1028. doi: 10.1016/0031-3203(93)90003-F.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed.&nbsp;World Scientific.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Claude, J. 2008. Morphometrics with R. Springer.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Lee, Y., and W. Lim. 2017. Shoelace Formula: Connecting the Area of a Polygon and the Vector Cross Product. The Mathematics Teacher 110(8): 631–636. doi: 10.5951/MATHTEACHER.110.8.0631.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394–396. doi: 10.1109/TSMC.1974.5408463.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610–621. doi: 10.1109/TSMC.1973.4309314<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Karcher, D.E., and M.D.&nbsp;Richardson. 2003. Quantifying Turfgrass Color Using Digital Image Analysis. Crop Science 43(3): 943–951. doi: 10.2135/cropsci2003.9430<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The images come from an experiment evaluating flax cultivars at the Universidade Federal de Santa Catarina - UFSC<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>https://www.florestaombrofilamista.com.br/sidol/?menu=glossary<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Claude, J. 2008. Morphometrics with R. Springer.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></aside></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02_segment.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Segment objects</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_phytopathometry.html" class="pagination-link">
        <span class="nav-page-text">Phytopathometry</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb196" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analyze objects"</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include = FALSE}</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Directory</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Working with polygons</span></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A 'polygon' is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)</span><span class="ot">[^1]</span><span class="at">.</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019--1028. doi: 10.1016/0031-3203(93)90003-F.</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>We can then conclude that image objects can be expressed as polygons with <span class="in">`n`</span> vertices. <span class="in">`pliman`</span> has a set of functions(<span class="in">`draw_*()`</span>) useful for drawing common shapes like circles, squares, triangles, rectangles and <span class="in">`n`</span>- tagons . Another group of <span class="in">`poly_*()`</span> functions can be used to analyze polygons. Let's start with a simple example related to the area and perimeter of a square.</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">draw_square</span>(<span class="at">side =</span> <span class="dv">2</span>)</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(square)</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(square)</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>Now, let's see what happens when we start with a hexagon and increase the number of sides up to 1000.</span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span> </span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">side6 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">6</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">side12 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">8</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">side24 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">12</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">50</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">side500 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">100</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>))</span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(shapes, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(shapes)</span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(shapes)</span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a>Note that when $n \to \infty$, the sum of the sides becomes the circumference of the circle, given by $2 \pi r$, and the area becomes $\pi r^2$. This is fun, but <span class="in">`pliman`</span> is primarily designed for analyzing plant image analysis. So why use polygons? Let's see how we can use these functions to get applicable information.</span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-61"><a href="#cb196-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-62"><a href="#cb196-62" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-63"><a href="#cb196-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-64"><a href="#cb196-64" aria-hidden="true" tabindex="-1"></a><span class="co"># getting the outline of objects</span></span>
<span id="cb196-65"><a href="#cb196-65" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb196-66"><a href="#cb196-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(leaves,</span>
<span id="cb196-67"><a href="#cb196-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B-R"</span>,</span>
<span id="cb196-68"><a href="#cb196-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-69"><a href="#cb196-69" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the polygon</span></span>
<span id="cb196-70"><a href="#cb196-70" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb196-71"><a href="#cb196-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-72"><a href="#cb196-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-73"><a href="#cb196-73" aria-hidden="true" tabindex="-1"></a>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 2, 12, and 23.</span>
<span id="cb196-74"><a href="#cb196-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-77"><a href="#cb196-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-78"><a href="#cb196-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-79"><a href="#cb196-79" aria-hidden="true" tabindex="-1"></a>cont2 <span class="ot">&lt;-</span> cont[<span class="fu">c</span>(<span class="st">"5"</span>, <span class="st">"20"</span>, <span class="st">"27"</span>)]</span>
<span id="cb196-80"><a href="#cb196-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont2)</span>
<span id="cb196-81"><a href="#cb196-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-82"><a href="#cb196-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-83"><a href="#cb196-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-84"><a href="#cb196-84" aria-hidden="true" tabindex="-1"></a>In the current version of <span class="in">`pliman`</span>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)<span class="ot">[^2]</span>, Claude (2008)<span class="ot">[^3]</span>, and Montero et al. (2009)<span class="ot">[^4]</span>.</span>
<span id="cb196-85"><a href="#cb196-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-86"><a href="#cb196-86" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed. World Scientific.</span>
<span id="cb196-87"><a href="#cb196-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-88"><a href="#cb196-88" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>Claude, J. 2008. Morphometrics with R. Springer.</span>
<span id="cb196-89"><a href="#cb196-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-90"><a href="#cb196-90" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305--1335.</span>
<span id="cb196-91"><a href="#cb196-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-92"><a href="#cb196-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Area</span></span>
<span id="cb196-93"><a href="#cb196-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-94"><a href="#cb196-94" aria-hidden="true" tabindex="-1"></a>The area of a shape is calculated using Shoelace's formula (Lee and Lim, 2017)<span class="ot">[^5]</span>, as follows</span>
<span id="cb196-95"><a href="#cb196-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-96"><a href="#cb196-96" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>Lee, Y., and W. Lim. 2017. Shoelace Formula: Connecting the Area of a Polygon and the Vector Cross Product. The Mathematics Teacher 110(8): 631--636. doi: 10.5951/MATHTEACHER.110.8.0631.</span>
<span id="cb196-97"><a href="#cb196-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-98"><a href="#cb196-98" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb196-99"><a href="#cb196-99" aria-hidden="true" tabindex="-1"></a>A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|</span>
<span id="cb196-100"><a href="#cb196-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb196-101"><a href="#cb196-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-104"><a href="#cb196-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-105"><a href="#cb196-105" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(cont)</span>
<span id="cb196-106"><a href="#cb196-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-107"><a href="#cb196-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-108"><a href="#cb196-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter</span></span>
<span id="cb196-109"><a href="#cb196-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-110"><a href="#cb196-110" aria-hidden="true" tabindex="-1"></a>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <span class="in">`poly_distpts()`</span>.</span>
<span id="cb196-111"><a href="#cb196-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-114"><a href="#cb196-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-115"><a href="#cb196-115" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(cont)</span>
<span id="cb196-116"><a href="#cb196-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-117"><a href="#cb196-117" aria-hidden="true" tabindex="-1"></a><span class="co"># perimeter of a circle with radius 2</span></span>
<span id="cb196-118"><a href="#cb196-118" aria-hidden="true" tabindex="-1"></a>circle <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">radius =</span> <span class="dv">2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-119"><a href="#cb196-119" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(circle)</span>
<span id="cb196-120"><a href="#cb196-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-121"><a href="#cb196-121" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result</span></span>
<span id="cb196-122"><a href="#cb196-122" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb196-123"><a href="#cb196-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-124"><a href="#cb196-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-125"><a href="#cb196-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Radius</span></span>
<span id="cb196-126"><a href="#cb196-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-127"><a href="#cb196-127" aria-hidden="true" tabindex="-1"></a>The radius of a pixel on the object's contour is calculated as its distance from the object's centroid(also called 'center of mass'). These distances can be obtained with <span class="in">`poly_centdist()`</span>.</span>
<span id="cb196-128"><a href="#cb196-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-131"><a href="#cb196-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-132"><a href="#cb196-132" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">poly_centdist</span>(cont)</span>
<span id="cb196-133"><a href="#cb196-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-134"><a href="#cb196-134" aria-hidden="true" tabindex="-1"></a><span class="co"># stats for radius</span></span>
<span id="cb196-135"><a href="#cb196-135" aria-hidden="true" tabindex="-1"></a><span class="fu">mean_list</span>(dist)</span>
<span id="cb196-136"><a href="#cb196-136" aria-hidden="true" tabindex="-1"></a><span class="fu">min_list</span>(dist)</span>
<span id="cb196-137"><a href="#cb196-137" aria-hidden="true" tabindex="-1"></a><span class="fu">max_list</span>(dist)</span>
<span id="cb196-138"><a href="#cb196-138" aria-hidden="true" tabindex="-1"></a><span class="fu">sd_list</span>(dist)</span>
<span id="cb196-139"><a href="#cb196-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-140"><a href="#cb196-140" aria-hidden="true" tabindex="-1"></a><span class="co"># average radius of above circle</span></span>
<span id="cb196-141"><a href="#cb196-141" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_centdist</span>(circle) <span class="sc">|&gt;</span> <span class="fu">mean_list</span>()</span>
<span id="cb196-142"><a href="#cb196-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-143"><a href="#cb196-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-144"><a href="#cb196-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Length and width</span></span>
<span id="cb196-145"><a href="#cb196-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-146"><a href="#cb196-146" aria-hidden="true" tabindex="-1"></a>The length and width of an object are calculated with <span class="in">`poly_lw()`</span>, as the difference between the maximum and minimum of the <span class="in">`x`</span> and <span class="in">`y`</span> coordinates after the object has been aligned with <span class="in">`poly_align()`</span>.</span>
<span id="cb196-147"><a href="#cb196-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-148"><a href="#cb196-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =2, fig.width=10}</span></span>
<span id="cb196-149"><a href="#cb196-149" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_lw</span>(cont)</span>
<span id="cb196-150"><a href="#cb196-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-151"><a href="#cb196-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-152"><a href="#cb196-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Circularity, eccentricity, diameter, and elongation</span></span>
<span id="cb196-153"><a href="#cb196-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-154"><a href="#cb196-154" aria-hidden="true" tabindex="-1"></a>Circularity(Montero et al. 2009)<span class="ot">[^6]</span> is also called shape compactness, or measure of roundness of an object. It is given by $C = P^2 / A$, where $P$ is the perimeter and $A$ is the area of the object.</span>
<span id="cb196-155"><a href="#cb196-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-156"><a href="#cb196-156" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305--1335</span>
<span id="cb196-157"><a href="#cb196-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-160"><a href="#cb196-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-161"><a href="#cb196-161" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity</span>(cont)</span>
<span id="cb196-162"><a href="#cb196-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-163"><a href="#cb196-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-164"><a href="#cb196-164" aria-hidden="true" tabindex="-1"></a>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have a circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given $Cn = P^2 / 4 \pi A$</span>
<span id="cb196-165"><a href="#cb196-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-168"><a href="#cb196-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-169"><a href="#cb196-169" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_norm</span>(cont)</span>
<span id="cb196-170"><a href="#cb196-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-171"><a href="#cb196-171" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized circularity for different shapes</span></span>
<span id="cb196-172"><a href="#cb196-172" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_square</span>(<span class="at">plot =</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb196-173"><a href="#cb196-173" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_circle</span>(<span class="at">plot=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb196-174"><a href="#cb196-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-175"><a href="#cb196-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-176"><a href="#cb196-176" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_circularity_haralick()`</span> calculates the Circularity of Haralick, CH (Haralick, 1974)<span class="ot">[^7]</span>. The method is based on calculating all Euclidean distances from the object's centroid to each contour pixel. With this set of distances, the mean($m$) and the standard deviation($s$) are calculated. These statistical parameters are used in a ratio that calculates CH as \$CH = m/ sd \$.</span>
<span id="cb196-177"><a href="#cb196-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-178"><a href="#cb196-178" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span>Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394--396. doi: 10.1109/TSMC.1974.5408463.</span>
<span id="cb196-179"><a href="#cb196-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-182"><a href="#cb196-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-183"><a href="#cb196-183" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_haralick</span>(cont)</span>
<span id="cb196-184"><a href="#cb196-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-185"><a href="#cb196-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-186"><a href="#cb196-186" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_convexity()`</span> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</span>
<span id="cb196-187"><a href="#cb196-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-190"><a href="#cb196-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-191"><a href="#cb196-191" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_convexity</span>(cont)</span>
<span id="cb196-192"><a href="#cb196-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-193"><a href="#cb196-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-194"><a href="#cb196-194" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_eccentricity()`</span> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</span>
<span id="cb196-195"><a href="#cb196-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-198"><a href="#cb196-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-199"><a href="#cb196-199" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_eccentricity</span>(cont)</span>
<span id="cb196-200"><a href="#cb196-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-201"><a href="#cb196-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-202"><a href="#cb196-202" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_elongation()`</span> Calculates the elongation of an object as <span class="in">`1 - width / length`</span></span>
<span id="cb196-203"><a href="#cb196-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-206"><a href="#cb196-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-207"><a href="#cb196-207" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_elongation</span>(cont)</span>
<span id="cb196-208"><a href="#cb196-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-209"><a href="#cb196-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-210"><a href="#cb196-210" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_caliper()`</span> Calculates the gauge(also called Feret's diameter).</span>
<span id="cb196-211"><a href="#cb196-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-214"><a href="#cb196-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-215"><a href="#cb196-215" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_caliper</span>(cont)</span>
<span id="cb196-216"><a href="#cb196-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-217"><a href="#cb196-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-218"><a href="#cb196-218" aria-hidden="true" tabindex="-1"></a>Users can use the <span class="in">`poly_measures()`</span> function to calculate most object measurements in a single call.</span>
<span id="cb196-219"><a href="#cb196-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-222"><a href="#cb196-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-223"><a href="#cb196-223" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">poly_measures</span>(cont) <span class="sc">|&gt;</span> <span class="fu">round_cols</span>()</span>
<span id="cb196-224"><a href="#cb196-224" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(measures)</span>
<span id="cb196-225"><a href="#cb196-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-226"><a href="#cb196-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-227"><a href="#cb196-227" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, the measurements can be corrected with <span class="in">`get_measures()`</span>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <span class="in">`dpi()`</span> the resolution can be obtained. In this case, the dpi is \~50.</span>
<span id="cb196-228"><a href="#cb196-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-231"><a href="#cb196-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-232"><a href="#cb196-232" aria-hidden="true" tabindex="-1"></a>color_measures <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(measures, <span class="at">dpi =</span> <span class="dv">50</span>)</span>
<span id="cb196-233"><a href="#cb196-233" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(color_measures)</span>
<span id="cb196-234"><a href="#cb196-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-235"><a href="#cb196-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-236"><a href="#cb196-236" aria-hidden="true" tabindex="-1"></a>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <span class="in">`pliman`</span>. Just for simplicity, I'll use only one object.</span>
<span id="cb196-237"><a href="#cb196-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-240"><a href="#cb196-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-241"><a href="#cb196-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-242"><a href="#cb196-242" aria-hidden="true" tabindex="-1"></a>o2 <span class="ot">&lt;-</span> cont[[<span class="dv">5</span>]]</span>
<span id="cb196-243"><a href="#cb196-243" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(o2)</span>
<span id="cb196-244"><a href="#cb196-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-245"><a href="#cb196-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-246"><a href="#cb196-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rotate polygons</span></span>
<span id="cb196-247"><a href="#cb196-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-248"><a href="#cb196-248" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_rotate()`</span> can be used to rotate the polygon coordinates by an <span class="in">`angle`</span> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</span>
<span id="cb196-249"><a href="#cb196-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-252"><a href="#cb196-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-253"><a href="#cb196-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-254"><a href="#cb196-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-255"><a href="#cb196-255" aria-hidden="true" tabindex="-1"></a>rot <span class="ot">&lt;-</span> <span class="fu">poly_rotate</span>(o2, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb196-256"><a href="#cb196-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-257"><a href="#cb196-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-258"><a href="#cb196-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Invert polygons</span></span>
<span id="cb196-259"><a href="#cb196-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-260"><a href="#cb196-260" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_flip_x()`</span> and <span class="in">`poly_flip_y()`</span> can be used to flip shapes along the x and y axis, respectively.</span>
<span id="cb196-261"><a href="#cb196-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-264"><a href="#cb196-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-265"><a href="#cb196-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-266"><a href="#cb196-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-267"><a href="#cb196-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-268"><a href="#cb196-268" aria-hidden="true" tabindex="-1"></a>flipped <span class="ot">&lt;-</span> </span>
<span id="cb196-269"><a href="#cb196-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">fx =</span> <span class="fu">poly_flip_x</span>(o2), </span>
<span id="cb196-270"><a href="#cb196-270" aria-hidden="true" tabindex="-1"></a>       <span class="at">fy =</span> <span class="fu">poly_flip_y</span>(o2))</span>
<span id="cb196-271"><a href="#cb196-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-272"><a href="#cb196-272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(flipped, <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-273"><a href="#cb196-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-274"><a href="#cb196-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-275"><a href="#cb196-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter sampling</span></span>
<span id="cb196-276"><a href="#cb196-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-277"><a href="#cb196-277" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_sample()`</span> samples <span class="in">`n`</span> coordinates between existing points, and <span class="in">`poly_sample_prop()`</span> samples a proportion of coordinates between existing ones.</span>
<span id="cb196-278"><a href="#cb196-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-281"><a href="#cb196-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-282"><a href="#cb196-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-283"><a href="#cb196-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-284"><a href="#cb196-284" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 50 coordinates</span></span>
<span id="cb196-285"><a href="#cb196-285" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample</span>(o2, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb196-286"><a href="#cb196-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-287"><a href="#cb196-287" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 10% of coordinates</span></span>
<span id="cb196-288"><a href="#cb196-288" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample_prop</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb196-289"><a href="#cb196-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-290"><a href="#cb196-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-291"><a href="#cb196-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## smoothing</span></span>
<span id="cb196-292"><a href="#cb196-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-293"><a href="#cb196-293" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_smooth()`</span> smooths the contour of a polygon by combining <span class="in">`prop`</span> coordinate point samples and interpolating them using <span class="in">`vertices`</span> vertices(default is 1000) .</span>
<span id="cb196-294"><a href="#cb196-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-297"><a href="#cb196-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-298"><a href="#cb196-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-299"><a href="#cb196-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-300"><a href="#cb196-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-301"><a href="#cb196-301" aria-hidden="true" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span></span>
<span id="cb196-302"><a href="#cb196-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>( <span class="at">original =</span> o2,</span>
<span id="cb196-303"><a href="#cb196-303" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-304"><a href="#cb196-304" aria-hidden="true" tabindex="-1"></a>        <span class="at">s2 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb196-305"><a href="#cb196-305" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.04</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-306"><a href="#cb196-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb196-307"><a href="#cb196-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-308"><a href="#cb196-308" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(smoothed, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb196-309"><a href="#cb196-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-310"><a href="#cb196-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-311"><a href="#cb196-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Noises</span></span>
<span id="cb196-312"><a href="#cb196-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-313"><a href="#cb196-313" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_jitter()`</span> adds a small amount of noise to a set of coordinates. See <span class="in">`base::jitter()`</span> for more details.</span>
<span id="cb196-314"><a href="#cb196-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-317"><a href="#cb196-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-318"><a href="#cb196-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-319"><a href="#cb196-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-320"><a href="#cb196-320" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb196-321"><a href="#cb196-321" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-322"><a href="#cb196-322" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb196-323"><a href="#cb196-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_jitter</span>(<span class="at">noise_x =</span> <span class="dv">100</span>,</span>
<span id="cb196-324"><a href="#cb196-324" aria-hidden="true" tabindex="-1"></a>              <span class="at">noise_y =</span> <span class="dv">100</span>,</span>
<span id="cb196-325"><a href="#cb196-325" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-326"><a href="#cb196-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-327"><a href="#cb196-327" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(<span class="fu">list</span>(c1, c2), <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-328"><a href="#cb196-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-329"><a href="#cb196-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-330"><a href="#cb196-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-331"><a href="#cb196-331" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyzing objects</span></span>
<span id="cb196-332"><a href="#cb196-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-333"><a href="#cb196-333" aria-hidden="true" tabindex="-1"></a>The functions we've seen can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <span class="in">`object_contour()`</span> and <span class="in">`poly_measures()`</span>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <span class="in">`analyze_objects()`</span> function. Let's start with a simple example, using the <span class="in">`object_300dpi.png`</span> image available on <span class="co">[</span><span class="ot">GitHub page</span><span class="co">](https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images)</span>. To facilitate importing images from this folder, an <span class="in">`image_pliman()`</span> helper function is used.</span>
<span id="cb196-334"><a href="#cb196-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-335"><a href="#cb196-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse =TRUE}</span></span>
<span id="cb196-336"><a href="#cb196-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-337"><a href="#cb196-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb196-338"><a href="#cb196-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb196-339"><a href="#cb196-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-340"><a href="#cb196-340" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb196-341"><a href="#cb196-341" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-342"><a href="#cb196-342" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metan)</span>
<span id="cb196-343"><a href="#cb196-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-344"><a href="#cb196-344" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">"objects_300dpi.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-345"><a href="#cb196-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-346"><a href="#cb196-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-347"><a href="#cb196-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-348"><a href="#cb196-348" aria-hidden="true" tabindex="-1"></a>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</span>
<span id="cb196-349"><a href="#cb196-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-350"><a href="#cb196-350" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Larger square: 10 x 10 cm (100 cm$^2$)</span>
<span id="cb196-351"><a href="#cb196-351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Smaller square: 5 x 5 cm(25 cm$^2$)</span>
<span id="cb196-352"><a href="#cb196-352" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rectangle: 4 x 2 cm(8 cm$^2$)</span>
<span id="cb196-353"><a href="#cb196-353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Circle: 3 cm in diameter(\~7.07 cm$^2$)</span>
<span id="cb196-354"><a href="#cb196-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-355"><a href="#cb196-355" aria-hidden="true" tabindex="-1"></a>To count the objects in the image we use <span class="in">`analyze_objects()`</span> and inform the image(the only required argument). By default, the <span class="in">`NB`</span> index is used for object segmentation.</span>
<span id="cb196-356"><a href="#cb196-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-359"><a href="#cb196-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-360"><a href="#cb196-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-361"><a href="#cb196-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-362"><a href="#cb196-362" aria-hidden="true" tabindex="-1"></a>img_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(img, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-363"><a href="#cb196-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-364"><a href="#cb196-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-365"><a href="#cb196-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjusting object measurements</span></span>
<span id="cb196-366"><a href="#cb196-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-367"><a href="#cb196-367" aria-hidden="true" tabindex="-1"></a>The results were stored in <span class="in">`img_res`</span>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm$^2$, only in pixels. In this case, we use <span class="in">`get_measures()`</span> to adjust pixel measurements to metric units.</span>
<span id="cb196-368"><a href="#cb196-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-369"><a href="#cb196-369" aria-hidden="true" tabindex="-1"></a>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area, and radius will be adjusted by the dpi informed.</span>
<span id="cb196-370"><a href="#cb196-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-371"><a href="#cb196-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring a known value</span></span>
<span id="cb196-372"><a href="#cb196-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-373"><a href="#cb196-373" aria-hidden="true" tabindex="-1"></a>Since we know the area of the larger square (object 1), let's adjust the area of the other objects in the image using this.</span>
<span id="cb196-374"><a href="#cb196-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-377"><a href="#cb196-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-378"><a href="#cb196-378" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(img_res ,</span>
<span id="cb196-379"><a href="#cb196-379" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb196-380"><a href="#cb196-380" aria-hidden="true" tabindex="-1"></a>             area <span class="sc">~</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb196-381"><a href="#cb196-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb196-382"><a href="#cb196-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-383"><a href="#cb196-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-384"><a href="#cb196-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-385"><a href="#cb196-385" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring the image resolution</span></span>
<span id="cb196-386"><a href="#cb196-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-387"><a href="#cb196-387" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, all measurements will be adjusted accordingly. Let's see a numerical example with <span class="in">`pixels_to_cm()`</span>. This function converts the number of pixels(<span class="sc">\*</span> px <span class="sc">\*</span>) into cm, considering the image resolution in <span class="in">`dpi`</span>, as follows: $cm = px \times(2.54 / dpi)$. As we know the number of pixels of the larger square, its perimeter in cm is given by</span>
<span id="cb196-388"><a href="#cb196-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-391"><a href="#cb196-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-392"><a href="#cb196-392" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span id="cb196-393"><a href="#cb196-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-394"><a href="#cb196-394" aria-hidden="true" tabindex="-1"></a>ls_px <span class="ot">&lt;-</span> img_res<span class="sc">$</span>results<span class="sc">$</span>perimeter[<span class="dv">1</span>]</span>
<span id="cb196-395"><a href="#cb196-395" aria-hidden="true" tabindex="-1"></a><span class="fu">pixels_to_cm</span>(<span class="at">px =</span> ls_px , <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb196-396"><a href="#cb196-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-397"><a href="#cb196-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-398"><a href="#cb196-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-399"><a href="#cb196-399" aria-hidden="true" tabindex="-1"></a>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <span class="in">`dpi`</span> argument in <span class="in">`get_measures()`</span>.</span>
<span id="cb196-400"><a href="#cb196-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-403"><a href="#cb196-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-404"><a href="#cb196-404" aria-hidden="true" tabindex="-1"></a>img_res_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(img_res, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb196-405"><a href="#cb196-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-406"><a href="#cb196-406" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb196-407"><a href="#cb196-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-408"><a href="#cb196-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-409"><a href="#cb196-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-410"><a href="#cb196-410" aria-hidden="true" tabindex="-1"></a><span class="fu">### Understanding measurements</span></span>
<span id="cb196-411"><a href="#cb196-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-414"><a href="#cb196-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-415"><a href="#cb196-415" aria-hidden="true" tabindex="-1"></a><span class="fu">object_contour</span>(img) <span class="sc">%&gt;%</span> <span class="co"># get the contour of objects</span></span>
<span id="cb196-416"><a href="#cb196-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_mass</span>() <span class="sc">%&gt;%</span> <span class="co"># computes the center of mass and minimum and maximum radii</span></span>
<span id="cb196-417"><a href="#cb196-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_mass</span>() <span class="co"># plot the measurements</span></span>
<span id="cb196-418"><a href="#cb196-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-419"><a href="#cb196-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-420"><a href="#cb196-420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Larger square:</span>
<span id="cb196-421"><a href="#cb196-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The minimum diameter(a = 9.97) can be considered as the side of the square</span>
<span id="cb196-422"><a href="#cb196-422" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The maximum diameter, given by $a \sqrt {2}$ can be considered the diagonal of the square ($9.97 \sqrt {2} = 14,099 \approx 14,105$</span>
<span id="cb196-423"><a href="#cb196-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-426"><a href="#cb196-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-427"><a href="#cb196-427" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb196-428"><a href="#cb196-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-429"><a href="#cb196-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-430"><a href="#cb196-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Texture features</span></span>
<span id="cb196-431"><a href="#cb196-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-432"><a href="#cb196-432" aria-hidden="true" tabindex="-1"></a>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al. 1979)<span class="ot">[^8]</span>. Haralick features depend on the configuration of the parameters <span class="in">`har_nbins`</span> and <span class="in">`har_scales`</span>. <span class="in">`har_nbins`</span> controls the number of bins used to compute the Haralick matrix. A smaller <span class="in">`har_nbins`</span> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <span class="in">`har_scales`</span> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To change this default, use the argument <span class="in">`har_band`</span>. For example, <span class="in">`har_band = 2`</span> will compute the features with the green band.</span>
<span id="cb196-433"><a href="#cb196-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-434"><a href="#cb196-434" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span>Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610--621. doi: 10.1109/TSMC.1973.4309314</span>
<span id="cb196-435"><a href="#cb196-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-436"><a href="#cb196-436" aria-hidden="true" tabindex="-1"></a>The following measures are returned (for more details, see <span class="co">[</span><span class="ot">this post</span><span class="co">](https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html)</span>)</span>
<span id="cb196-437"><a href="#cb196-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-438"><a href="#cb196-438" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`asm`</span>: The angular second-moment feature.</span>
<span id="cb196-439"><a href="#cb196-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`con`</span>: The contrast feature</span>
<span id="cb196-440"><a href="#cb196-440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cor`</span>: Correlation measures the linear dependency of gray levels of neighboring pixels.</span>
<span id="cb196-441"><a href="#cb196-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`var`</span>: The variance of gray levels pixels.</span>
<span id="cb196-442"><a href="#cb196-442" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`idm`</span>: The Inverse Difference Moment (IDM), i.e., the local homogeneity.</span>
<span id="cb196-443"><a href="#cb196-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sav`</span>: The Sum Average.</span>
<span id="cb196-444"><a href="#cb196-444" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sva`</span>: The Sum Variance.</span>
<span id="cb196-445"><a href="#cb196-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sen`</span>: Sum Entropy.</span>
<span id="cb196-446"><a href="#cb196-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dva`</span>: Difference Variance.</span>
<span id="cb196-447"><a href="#cb196-447" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`den`</span>: Difference Entropy</span>
<span id="cb196-448"><a href="#cb196-448" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`f12`</span>: Difference Variance.</span>
<span id="cb196-449"><a href="#cb196-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`f13`</span>: The angular second-moment feature.</span>
<span id="cb196-450"><a href="#cb196-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-451"><a href="#cb196-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Single image processing</span></span>
<span id="cb196-452"><a href="#cb196-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-453"><a href="#cb196-453" aria-hidden="true" tabindex="-1"></a>The <span class="in">`analyze_objects()`</span> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</span>
<span id="cb196-454"><a href="#cb196-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-457"><a href="#cb196-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-458"><a href="#cb196-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-459"><a href="#cb196-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-460"><a href="#cb196-460" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-461"><a href="#cb196-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-462"><a href="#cb196-462" aria-hidden="true" tabindex="-1"></a>leaves_meas <span class="ot">&lt;-</span></span>
<span id="cb196-463"><a href="#cb196-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb196-464"><a href="#cb196-464" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-465"><a href="#cb196-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-466"><a href="#cb196-466" aria-hidden="true" tabindex="-1"></a>leaves_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(leaves_meas, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb196-467"><a href="#cb196-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-468"><a href="#cb196-468" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(leaves_cor)</span>
<span id="cb196-469"><a href="#cb196-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-470"><a href="#cb196-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-471"><a href="#cb196-471" aria-hidden="true" tabindex="-1"></a><span class="co"># plot width and length</span></span>
<span id="cb196-472"><a href="#cb196-472" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"width"</span>)</span>
<span id="cb196-473"><a href="#cb196-473" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"length"</span>, <span class="at">vjust =</span> <span class="dv">50</span>)</span>
<span id="cb196-474"><a href="#cb196-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-475"><a href="#cb196-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-476"><a href="#cb196-476" aria-hidden="true" tabindex="-1"></a>Here, we will count the grains in the <span class="in">`grains.jpg`</span> image. This image has a cyan background and contains 90 soybeans that touch each other. The <span class="in">`analyze_objects()`</span> function segments the image using the normalized blue index by default, as follows $NB =(B /(R + G + B))$, where *R*, *G* and *B* are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <span class="in">`img`</span> argument(e.g., <span class="in">`img = "grains"`</span>).</span>
<span id="cb196-477"><a href="#cb196-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-478"><a href="#cb196-478" aria-hidden="true" tabindex="-1"></a>In this example, objects are counted and segmented objects are colored with random colors using the <span class="in">`show_segmentation = TRUE`</span> argument. Users can set <span class="in">`show_contour = FALSE`</span> to remove the contour line and identify the objects (in this example, the grains) using the <span class="in">`marker = "id"`</span> arguments. The background color can also be changed with <span class="in">`col_background`</span>.</span>
<span id="cb196-479"><a href="#cb196-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-482"><a href="#cb196-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-483"><a href="#cb196-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-484"><a href="#cb196-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-485"><a href="#cb196-485" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span></span>
<span id="cb196-486"><a href="#cb196-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">img =</span> <span class="st">"grains"</span>,</span>
<span id="cb196-487"><a href="#cb196-487" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-488"><a href="#cb196-488" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-489"><a href="#cb196-489" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-490"><a href="#cb196-490" aria-hidden="true" tabindex="-1"></a>count<span class="sc">$</span>statistics</span>
<span id="cb196-491"><a href="#cb196-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-492"><a href="#cb196-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-495"><a href="#cb196-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-496"><a href="#cb196-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the measurements of the object</span></span>
<span id="cb196-497"><a href="#cb196-497" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(count) <span class="sc">|&gt;</span> </span>
<span id="cb196-498"><a href="#cb196-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-499"><a href="#cb196-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb196-500"><a href="#cb196-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-501"><a href="#cb196-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-502"><a href="#cb196-502" aria-hidden="true" tabindex="-1"></a>In the following example, we will select objects with an area above the average of all objects using <span class="in">`lower_size = 675`</span>.</span>
<span id="cb196-503"><a href="#cb196-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-506"><a href="#cb196-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-507"><a href="#cb196-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-508"><a href="#cb196-508" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb196-509"><a href="#cb196-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-510"><a href="#cb196-510" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb196-511"><a href="#cb196-511" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb196-512"><a href="#cb196-512" aria-hidden="true" tabindex="-1"></a>                <span class="at">topn_upper =</span> <span class="dv">5</span>)</span>
<span id="cb196-513"><a href="#cb196-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-514"><a href="#cb196-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-515"><a href="#cb196-515" aria-hidden="true" tabindex="-1"></a>Users can also use the <span class="in">`topn _*`</span> arguments to select the <span class="in">`n`</span> objects based on the smallest or largest areas. Let's see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <span class="in">`my_index`</span> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <span class="in">`my_index = "B /(R + G + B)"`</span>.</span>
<span id="cb196-516"><a href="#cb196-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-519"><a href="#cb196-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-520"><a href="#cb196-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-521"><a href="#cb196-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-522"><a href="#cb196-522" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb196-523"><a href="#cb196-523" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb196-524"><a href="#cb196-524" aria-hidden="true" tabindex="-1"></a>                <span class="at">topn_lower =</span> <span class="dv">5</span>,</span>
<span id="cb196-525"><a href="#cb196-525" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_background =</span> <span class="st">"black"</span>,</span>
<span id="cb196-526"><a href="#cb196-526" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"B /(R + G + B)"</span>) <span class="co"># normalized blue(NB)</span></span>
<span id="cb196-527"><a href="#cb196-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-528"><a href="#cb196-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-529"><a href="#cb196-529" aria-hidden="true" tabindex="-1"></a><span class="fu">## Batch processing</span></span>
<span id="cb196-530"><a href="#cb196-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-531"><a href="#cb196-531" aria-hidden="true" tabindex="-1"></a>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in the indirect selection of high-yielding plants. In <span class="in">`pliman`</span>, batch processing can be done when the user declares the <span class="in">`pattern`</span> argument.</span>
<span id="cb196-532"><a href="#cb196-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-533"><a href="#cb196-533" aria-hidden="true" tabindex="-1"></a>To speed up processing time, especially for large numbers of images, the <span class="in">`parallel = TRUE`</span> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <span class="in">`R`</span> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <span class="in">`workers`</span> argument.</span>
<span id="cb196-534"><a href="#cb196-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-537"><a href="#cb196-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-538"><a href="#cb196-538" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb196-539"><a href="#cb196-539" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>,</span>
<span id="cb196-540"><a href="#cb196-540" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-541"><a href="#cb196-541" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb196-542"><a href="#cb196-542" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dir_original =</span> <span class="st">"soja"</span>)</span>
<span id="cb196-543"><a href="#cb196-543" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-544"><a href="#cb196-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-545"><a href="#cb196-545" aria-hidden="true" tabindex="-1"></a><span class="co"># parallel processing</span></span>
<span id="cb196-546"><a href="#cb196-546" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span id="cb196-547"><a href="#cb196-547" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb196-548"><a href="#cb196-548" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span></span>
<span id="cb196-549"><a href="#cb196-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>,</span>
<span id="cb196-550"><a href="#cb196-550" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-551"><a href="#cb196-551" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb196-552"><a href="#cb196-552" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> <span class="st">"soja"</span>,</span>
<span id="cb196-553"><a href="#cb196-553" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-554"><a href="#cb196-554" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-555"><a href="#cb196-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-556"><a href="#cb196-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-557"><a href="#cb196-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-558"><a href="#cb196-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-559"><a href="#cb196-559" aria-hidden="true" tabindex="-1"></a><span class="fu"># Object coordinates</span></span>
<span id="cb196-560"><a href="#cb196-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-561"><a href="#cb196-561" aria-hidden="true" tabindex="-1"></a>Users can get the coordinates for all desired objects with <span class="in">`object_coord()`</span>. When the <span class="in">`id`</span> argument is set to <span class="in">`NULL`</span> (default), a bounding rectangle is drawn including all objects. Use <span class="in">`id = "all"`</span> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <span class="in">`watershed = FALSE`</span> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</span>
<span id="cb196-562"><a href="#cb196-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-563"><a href="#cb196-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r objec2}</span></span>
<span id="cb196-564"><a href="#cb196-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-565"><a href="#cb196-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-566"><a href="#cb196-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-567"><a href="#cb196-567" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-568"><a href="#cb196-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-569"><a href="#cb196-569" aria-hidden="true" tabindex="-1"></a><span class="co"># get the id of each object</span></span>
<span id="cb196-570"><a href="#cb196-570" aria-hidden="true" tabindex="-1"></a><span class="fu">object_id</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-571"><a href="#cb196-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-572"><a href="#cb196-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span id="cb196-573"><a href="#cb196-573" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-574"><a href="#cb196-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-575"><a href="#cb196-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coordinates for all objects</span></span>
<span id="cb196-576"><a href="#cb196-576" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb196-577"><a href="#cb196-577" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="st">"all"</span>,</span>
<span id="cb196-578"><a href="#cb196-578" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-579"><a href="#cb196-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-580"><a href="#cb196-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span id="cb196-581"><a href="#cb196-581" aria-hidden="true" tabindex="-1"></a><span class="co"># 20 border pixels</span></span>
<span id="cb196-582"><a href="#cb196-582" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb196-583"><a href="#cb196-583" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb196-584"><a href="#cb196-584" aria-hidden="true" tabindex="-1"></a>             <span class="at">edge =</span> <span class="dv">20</span>,</span>
<span id="cb196-585"><a href="#cb196-585" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-586"><a href="#cb196-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-587"><a href="#cb196-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-588"><a href="#cb196-588" aria-hidden="true" tabindex="-1"></a><span class="fu"># Isolating objects</span></span>
<span id="cb196-589"><a href="#cb196-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-590"><a href="#cb196-590" aria-hidden="true" tabindex="-1"></a>Knowing the coordinates of each object, it is possible to isolate it. The <span class="in">`object_isolate()`</span> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</span>
<span id="cb196-591"><a href="#cb196-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-592"><a href="#cb196-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r object3}</span></span>
<span id="cb196-593"><a href="#cb196-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-594"><a href="#cb196-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-595"><a href="#cb196-595" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span></span>
<span id="cb196-596"><a href="#cb196-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_isolate</span>(leaves ,</span>
<span id="cb196-597"><a href="#cb196-597" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-598"><a href="#cb196-598" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb196-599"><a href="#cb196-599" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge =</span> <span class="dv">10</span>)</span>
<span id="cb196-600"><a href="#cb196-600" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(id1)</span>
<span id="cb196-601"><a href="#cb196-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-602"><a href="#cb196-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-603"><a href="#cb196-603" aria-hidden="true" tabindex="-1"></a><span class="fu"># Including objects in a list</span></span>
<span id="cb196-604"><a href="#cb196-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-605"><a href="#cb196-605" aria-hidden="true" tabindex="-1"></a><span class="in">`object_split()`</span> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</span>
<span id="cb196-606"><a href="#cb196-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-609"><a href="#cb196-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-610"><a href="#cb196-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-611"><a href="#cb196-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-612"><a href="#cb196-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-613"><a href="#cb196-613" aria-hidden="true" tabindex="-1"></a>list <span class="ot">&lt;-</span> <span class="fu">object_split</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-614"><a href="#cb196-614" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list)</span>
<span id="cb196-615"><a href="#cb196-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-616"><a href="#cb196-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-617"><a href="#cb196-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-618"><a href="#cb196-618" aria-hidden="true" tabindex="-1"></a><span class="fu"># RGB values for each object</span></span>
<span id="cb196-619"><a href="#cb196-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-620"><a href="#cb196-620" aria-hidden="true" tabindex="-1"></a>To get the RGB intensity of each object in the image, we use the <span class="in">`object_rgb = TRUE`</span> argument in the <span class="in">`analyze_objects()`</span> function. In the following example, we will use the R, G and B bands and their normalized values. The <span class="in">`pliman_indexes()`</span> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g. <span class="in">`object_index = "B/G+R"`</span>).</span>
<span id="cb196-621"><a href="#cb196-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-622"><a href="#cb196-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb2}</span></span>
<span id="cb196-623"><a href="#cb196-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-624"><a href="#cb196-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-625"><a href="#cb196-625" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"flax.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-626"><a href="#cb196-626" aria-hidden="true" tabindex="-1"></a>(indx <span class="ot">&lt;-</span> <span class="fu">pliman_indexes</span>())</span>
<span id="cb196-627"><a href="#cb196-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-628"><a href="#cb196-628" aria-hidden="true" tabindex="-1"></a>flax_leaves <span class="ot">&lt;-</span></span>
<span id="cb196-629"><a href="#cb196-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img ,</span>
<span id="cb196-630"><a href="#cb196-630" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb196-631"><a href="#cb196-631" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-632"><a href="#cb196-632" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb196-633"><a href="#cb196-633" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="fu">pliman_indexes</span>(), </span>
<span id="cb196-634"><a href="#cb196-634" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb196-635"><a href="#cb196-635" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"black"</span>,</span>
<span id="cb196-636"><a href="#cb196-636" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb196-637"><a href="#cb196-637" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pixel_level_index =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-638"><a href="#cb196-638" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-639"><a href="#cb196-639" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA with the indices</span></span>
<span id="cb196-640"><a href="#cb196-640" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">summary_index</span>(flax_leaves, <span class="at">type =</span><span class="st">"var"</span>)</span>
<span id="cb196-641"><a href="#cb196-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-642"><a href="#cb196-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-643"><a href="#cb196-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-644"><a href="#cb196-644" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</span>
<span id="cb196-645"><a href="#cb196-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-648"><a href="#cb196-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-649"><a href="#cb196-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-650"><a href="#cb196-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-651"><a href="#cb196-651" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"var"</span>)</span>
<span id="cb196-652"><a href="#cb196-652" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"ind"</span>)</span>
<span id="cb196-653"><a href="#cb196-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-654"><a href="#cb196-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-655"><a href="#cb196-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-656"><a href="#cb196-656" aria-hidden="true" tabindex="-1"></a>Now, let's plot the <span class="in">`DGCI`</span> (Dark Green Color Index) on each object. The DGCI is based on the HSB (Hue, Saturation, and Brightness) space color and has been used as an indicator of the darkness of the green color <span class="ot">[^9]</span></span>
<span id="cb196-657"><a href="#cb196-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-658"><a href="#cb196-658" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span>Karcher, D.E., and M.D. Richardson. 2003. Quantifying Turfgrass Color Using Digital Image Analysis. Crop Science 43(3): 943--951. doi: 10.2135/cropsci2003.9430</span>
<span id="cb196-659"><a href="#cb196-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-662"><a href="#cb196-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-663"><a href="#cb196-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-664"><a href="#cb196-664" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb196-665"><a href="#cb196-665" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves, <span class="at">measure =</span> <span class="st">"DGCI"</span>)</span>
<span id="cb196-666"><a href="#cb196-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-667"><a href="#cb196-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-668"><a href="#cb196-668" aria-hidden="true" tabindex="-1"></a>It seems that leaves with an average DGCI value of less than 0.4 can be considered "Yellowish" leaves. Users can then work with this feature and adapt it to their case.</span>
<span id="cb196-669"><a href="#cb196-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-670"><a href="#cb196-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb4}</span></span>
<span id="cb196-671"><a href="#cb196-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-672"><a href="#cb196-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-673"><a href="#cb196-673" aria-hidden="true" tabindex="-1"></a>report <span class="ot">&lt;-</span></span>
<span id="cb196-674"><a href="#cb196-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_index</span>(flax_leaves ,</span>
<span id="cb196-675"><a href="#cb196-675" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb196-676"><a href="#cb196-676" aria-hidden="true" tabindex="-1"></a>                <span class="at">cut_point =</span> <span class="fl">0.45</span>,</span>
<span id="cb196-677"><a href="#cb196-677" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-678"><a href="#cb196-678" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> report<span class="sc">$</span>ids</span>
<span id="cb196-679"><a href="#cb196-679" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>between_id</span>
<span id="cb196-680"><a href="#cb196-680" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>within_id[report<span class="sc">$</span>within_id<span class="sc">$</span>id <span class="sc">%in%</span> ids,]</span>
<span id="cb196-681"><a href="#cb196-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-682"><a href="#cb196-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-683"><a href="#cb196-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-684"><a href="#cb196-684" aria-hidden="true" tabindex="-1"></a>In the following graph, I plot the distribution of the RGB values "Yellowish" and "Greenish" leaves R, G, and B values.</span>
<span id="cb196-685"><a href="#cb196-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-688"><a href="#cb196-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-689"><a href="#cb196-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-690"><a href="#cb196-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-691"><a href="#cb196-691" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of RGB values</span></span>
<span id="cb196-692"><a href="#cb196-692" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-693"><a href="#cb196-693" aria-hidden="true" tabindex="-1"></a>rgbs <span class="ot">&lt;-</span></span>
<span id="cb196-694"><a href="#cb196-694" aria-hidden="true" tabindex="-1"></a>  flax_leaves<span class="sc">$</span>object_rgb <span class="sc">|&gt;</span></span>
<span id="cb196-695"><a href="#cb196-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, h, s, b) <span class="sc">|&gt;</span> </span>
<span id="cb196-696"><a href="#cb196-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> ids, <span class="st">"Yellowish"</span>, <span class="st">"Greenish"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb196-697"><a href="#cb196-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span></span>
<span id="cb196-698"><a href="#cb196-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>type)</span>
<span id="cb196-699"><a href="#cb196-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-700"><a href="#cb196-700" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rgbs, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb196-701"><a href="#cb196-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb196-702"><a href="#cb196-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(type <span class="sc">~</span> name)</span>
<span id="cb196-703"><a href="#cb196-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-704"><a href="#cb196-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-705"><a href="#cb196-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-706"><a href="#cb196-706" aria-hidden="true" tabindex="-1"></a>Now, using the ids of each grain, I plot the values only in the "yello" leaves.</span>
<span id="cb196-707"><a href="#cb196-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-710"><a href="#cb196-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-711"><a href="#cb196-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-712"><a href="#cb196-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-713"><a href="#cb196-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-714"><a href="#cb196-714" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb196-715"><a href="#cb196-715" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb196-716"><a href="#cb196-716" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves ,</span>
<span id="cb196-717"><a href="#cb196-717" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> ids,</span>
<span id="cb196-718"><a href="#cb196-718" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb196-719"><a href="#cb196-719" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb196-720"><a href="#cb196-720" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves ,</span>
<span id="cb196-721"><a href="#cb196-721" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> flax_leaves<span class="sc">$</span>results<span class="sc">$</span>id[<span class="sc">!</span>flax_leaves<span class="sc">$</span>results<span class="sc">$</span>id <span class="sc">%in%</span> ids],</span>
<span id="cb196-722"><a href="#cb196-722" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb196-723"><a href="#cb196-723" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb196-724"><a href="#cb196-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-725"><a href="#cb196-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-726"><a href="#cb196-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-727"><a href="#cb196-727" aria-hidden="true" tabindex="-1"></a><span class="fu"># Leaf area</span></span>
<span id="cb196-728"><a href="#cb196-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-729"><a href="#cb196-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## Known resolution</span></span>
<span id="cb196-730"><a href="#cb196-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-733"><a href="#cb196-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-734"><a href="#cb196-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-735"><a href="#cb196-735" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-736"><a href="#cb196-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-737"><a href="#cb196-737" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb196-738"><a href="#cb196-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb196-739"><a href="#cb196-739" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B-G"</span>,</span>
<span id="cb196-740"><a href="#cb196-740" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-741"><a href="#cb196-741" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"black"</span>,</span>
<span id="cb196-742"><a href="#cb196-742" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-743"><a href="#cb196-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-744"><a href="#cb196-744" aria-hidden="true" tabindex="-1"></a><span class="co"># using images with known resolution</span></span>
<span id="cb196-745"><a href="#cb196-745" aria-hidden="true" tabindex="-1"></a>af_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(af, <span class="at">dpi =</span> <span class="fl">45.8</span>)</span>
<span id="cb196-746"><a href="#cb196-746" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor ,</span>
<span id="cb196-747"><a href="#cb196-747" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb196-748"><a href="#cb196-748" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">20</span>,</span>
<span id="cb196-749"><a href="#cb196-749" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" cyan "</span>)</span>
<span id="cb196-750"><a href="#cb196-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-751"><a href="#cb196-751" aria-hidden="true" tabindex="-1"></a><span class="co"># declaring the measure of a known object</span></span>
<span id="cb196-752"><a href="#cb196-752" aria-hidden="true" tabindex="-1"></a>af_cor2 <span class="ot">&lt;-</span> </span>
<span id="cb196-753"><a href="#cb196-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_measures</span>(af,</span>
<span id="cb196-754"><a href="#cb196-754" aria-hidden="true" tabindex="-1"></a>               <span class="at">id =</span> <span class="dv">18</span>,</span>
<span id="cb196-755"><a href="#cb196-755" aria-hidden="true" tabindex="-1"></a>               <span class="at">measure =</span> area <span class="sc">~</span> <span class="dv">25</span>)</span>
<span id="cb196-756"><a href="#cb196-756" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor2 ,</span>
<span id="cb196-757"><a href="#cb196-757" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb196-758"><a href="#cb196-758" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">35</span>,</span>
<span id="cb196-759"><a href="#cb196-759" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"salmon"</span>)</span>
<span id="cb196-760"><a href="#cb196-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-761"><a href="#cb196-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-762"><a href="#cb196-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-763"><a href="#cb196-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-764"><a href="#cb196-764" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference object (dev version)</span></span>
<span id="cb196-765"><a href="#cb196-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-766"><a href="#cb196-766" aria-hidden="true" tabindex="-1"></a><span class="fu">### Single images</span></span>
<span id="cb196-767"><a href="#cb196-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-768"><a href="#cb196-768" aria-hidden="true" tabindex="-1"></a>The <span class="in">`reference`</span> argument can now be used to correct the object measures even when images with different shooting distances are used. This differs from the previous example (declaring the object with the known area) in a subtle, but crucial aspect: when <span class="in">`reference`</span> is informed, batch processing can be used! In this example, the leaf area of the <span class="in">`ref_leaves`</span> image is quantified and corrected considering a 5 x 5 (25 cm$^2$) red square as the reference object. When <span class="in">`reference = TRUE`</span> is informed in <span class="in">`analyze_objects()`</span> the function will perform a two-step process of object segmentation; so, the time processing is a bit slower.</span>
<span id="cb196-769"><a href="#cb196-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-770"><a href="#cb196-770" aria-hidden="true" tabindex="-1"></a>The first step consists in segmenting the foreground (leaves and reference object) from the background. To do that, an image index is used and can be declared in the <span class="in">`back_fore_index`</span>. The default (<span class="in">`back_fore_index = "R/(G/B)"`</span>) is optimized to segment white backgrounds from green leaves and a blue reference object. Let's see how this index performs in this example.</span>
<span id="cb196-771"><a href="#cb196-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-774"><a href="#cb196-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-775"><a href="#cb196-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-776"><a href="#cb196-776" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-777"><a href="#cb196-777" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"R/(G/B)"</span>, <span class="at">plot =</span>  <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb196-778"><a href="#cb196-778" aria-hidden="true" tabindex="-1"></a>bin <span class="ot">&lt;-</span> <span class="fu">image_binary</span>(img, <span class="at">index =</span> <span class="st">"R/(G/B)"</span>, <span class="at">plot =</span>  <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb196-779"><a href="#cb196-779" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(ind, bin)</span>
<span id="cb196-780"><a href="#cb196-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-781"><a href="#cb196-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-782"><a href="#cb196-782" aria-hidden="true" tabindex="-1"></a>This index definitively is not the better option in this case. Will some other available index be better?</span>
<span id="cb196-783"><a href="#cb196-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-786"><a href="#cb196-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-787"><a href="#cb196-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-788"><a href="#cb196-788" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"all"</span>)</span>
<span id="cb196-789"><a href="#cb196-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-790"><a href="#cb196-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-791"><a href="#cb196-791" aria-hidden="true" tabindex="-1"></a>The <span class="in">`B-G`</span> index seems to be a good candidate.</span>
<span id="cb196-792"><a href="#cb196-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-795"><a href="#cb196-795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-796"><a href="#cb196-796" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-797"><a href="#cb196-797" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"B-G"</span>, <span class="at">plot =</span>  <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb196-798"><a href="#cb196-798" aria-hidden="true" tabindex="-1"></a>seg1 <span class="ot">&lt;-</span> <span class="fu">image_segment</span>(img, <span class="at">index =</span> <span class="st">"B-G"</span>, <span class="at">plot =</span>  <span class="cn">FALSE</span>)</span>
<span id="cb196-799"><a href="#cb196-799" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(ind, seg1)</span>
<span id="cb196-800"><a href="#cb196-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-801"><a href="#cb196-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-802"><a href="#cb196-802" aria-hidden="true" tabindex="-1"></a>Good job! now, we have the background removed. The next step is to segment the objects and the reference template. We basically need to repeat the previous step isolating the reference.</span>
<span id="cb196-803"><a href="#cb196-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-806"><a href="#cb196-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-807"><a href="#cb196-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-808"><a href="#cb196-808" aria-hidden="true" tabindex="-1"></a><span class="co"># see the better index</span></span>
<span id="cb196-809"><a href="#cb196-809" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(seg1, <span class="at">index =</span> <span class="st">"all"</span>)</span>
<span id="cb196-810"><a href="#cb196-810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-811"><a href="#cb196-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-812"><a href="#cb196-812" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R-G`</span> is a good candidate. So, I'll perform the second segmentation using this index.</span>
<span id="cb196-813"><a href="#cb196-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-816"><a href="#cb196-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-817"><a href="#cb196-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-818"><a href="#cb196-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-819"><a href="#cb196-819" aria-hidden="true" tabindex="-1"></a>seg2 <span class="ot">&lt;-</span> </span>
<span id="cb196-820"><a href="#cb196-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_binary</span>(seg1,</span>
<span id="cb196-821"><a href="#cb196-821" aria-hidden="true" tabindex="-1"></a>               <span class="at">index =</span> <span class="st">"R-G"</span>)</span>
<span id="cb196-822"><a href="#cb196-822" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pixels in the reference object</span></span>
<span id="cb196-823"><a href="#cb196-823" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(seg2<span class="sc">$</span><span class="st">`</span><span class="at">R-G</span><span class="st">`</span> <span class="sc">!=</span> <span class="dv">1</span>))</span>
<span id="cb196-824"><a href="#cb196-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-825"><a href="#cb196-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-826"><a href="#cb196-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-827"><a href="#cb196-827" aria-hidden="true" tabindex="-1"></a>Now that we know the indexes to be used for each segmentation, we can use the function <span class="in">`analyze_objects`</span> to get the corrected measures based on the reference object.</span>
<span id="cb196-828"><a href="#cb196-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-831"><a href="#cb196-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-832"><a href="#cb196-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-833"><a href="#cb196-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb196-834"><a href="#cb196-834" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> </span>
<span id="cb196-835"><a href="#cb196-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img, </span>
<span id="cb196-836"><a href="#cb196-836" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-837"><a href="#cb196-837" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference_area =</span> <span class="dv">25</span>,</span>
<span id="cb196-838"><a href="#cb196-838" aria-hidden="true" tabindex="-1"></a>                  <span class="at">back_fore_index =</span> <span class="st">"B-G"</span>,</span>
<span id="cb196-839"><a href="#cb196-839" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fore_ref_index =</span> <span class="st">"R-G"</span>,</span>
<span id="cb196-840"><a href="#cb196-840" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-841"><a href="#cb196-841" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>)</span>
<span id="cb196-842"><a href="#cb196-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-843"><a href="#cb196-843" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the measures corrected by the image resolution</span></span>
<span id="cb196-844"><a href="#cb196-844" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor ,</span>
<span id="cb196-845"><a href="#cb196-845" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb196-846"><a href="#cb196-846" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">20</span>,</span>
<span id="cb196-847"><a href="#cb196-847" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" cyan "</span>)</span>
<span id="cb196-848"><a href="#cb196-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-849"><a href="#cb196-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-850"><a href="#cb196-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-851"><a href="#cb196-851" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple images</span></span>
<span id="cb196-852"><a href="#cb196-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-853"><a href="#cb196-853" aria-hidden="true" tabindex="-1"></a>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<span class="in">`-`</span>) or underscore (<span class="in">`_`</span>). Then, when using <span class="in">`get_measures()`</span>, measurements from leaf images called, for example, <span class="in">`F1-1.jpeg`</span>, <span class="in">`F1_2.jpeg`</span> and <span class="in">`F1-3.jpeg`</span> will be combined into a single image (<span class="in">`F1`</span>), displayed in the <span class="in">`merge`</span> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</span>
<span id="cb196-854"><a href="#cb196-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-855"><a href="#cb196-855" aria-hidden="true" tabindex="-1"></a>In the following example, 36 images will be analyzed. These images contain flax leaves from 12 evaluation dates, with three replications<span class="ot">[^10]</span>. Note that to ensure that all images are processed, all images must share a common pattern, in this case (<span class="in">`"A"`</span>). Here, I will use the <span class="in">`pattern = "A"`</span> to indicate that all images with this pattern name should be merged.</span>
<span id="cb196-856"><a href="#cb196-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-857"><a href="#cb196-857" aria-hidden="true" tabindex="-1"></a><span class="ot">[^10]: </span>The images come from an experiment evaluating flax cultivars at the Universidade Federal de Santa Catarina - UFSC</span>
<span id="cb196-858"><a href="#cb196-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-861"><a href="#cb196-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-862"><a href="#cb196-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-863"><a href="#cb196-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-864"><a href="#cb196-864" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span></span>
<span id="cb196-865"><a href="#cb196-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"A"</span>,</span>
<span id="cb196-866"><a href="#cb196-866" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">"linhaca"</span>,</span>
<span id="cb196-867"><a href="#cb196-867" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-868"><a href="#cb196-868" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference_area =</span> <span class="dv">20</span>,</span>
<span id="cb196-869"><a href="#cb196-869" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-870"><a href="#cb196-870" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb196-871"><a href="#cb196-871" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-872"><a href="#cb196-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-873"><a href="#cb196-873" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(res)</span>
<span id="cb196-874"><a href="#cb196-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-875"><a href="#cb196-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-876"><a href="#cb196-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-877"><a href="#cb196-877" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`merged`</span> is a list with three objects:</span>
<span id="cb196-878"><a href="#cb196-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-879"><a href="#cb196-879" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`results`</span>: a data frame that contains the measurements of each individual object (in this case, an individual leaf) of each analyzed image.</span>
<span id="cb196-880"><a href="#cb196-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-881"><a href="#cb196-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge3}</span></span>
<span id="cb196-882"><a href="#cb196-882" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>results <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb196-883"><a href="#cb196-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-884"><a href="#cb196-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-885"><a href="#cb196-885" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summary`</span> : a data frame that contains the summary of the results, containing the number of objects in each image (<span class="in">`n`</span>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</span>
<span id="cb196-886"><a href="#cb196-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-887"><a href="#cb196-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge4}</span></span>
<span id="cb196-888"><a href="#cb196-888" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>summary <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb196-889"><a href="#cb196-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-890"><a href="#cb196-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-891"><a href="#cb196-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-892"><a href="#cb196-892" aria-hidden="true" tabindex="-1"></a>The <span class="in">`area_sum`</span> of img <span class="in">`A1_28_1`</span> is the sum of the 18 leaves.</span>
<span id="cb196-893"><a href="#cb196-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-894"><a href="#cb196-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge6}</span></span>
<span id="cb196-895"><a href="#cb196-895" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged<span class="sc">$</span>results<span class="sc">$</span>area[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>])</span>
<span id="cb196-896"><a href="#cb196-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-897"><a href="#cb196-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-898"><a href="#cb196-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-899"><a href="#cb196-899" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`merge`</span>: a data frame that contains the results merged by image prefix (In this case, A1 to A12).</span>
<span id="cb196-900"><a href="#cb196-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-901"><a href="#cb196-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge5}</span></span>
<span id="cb196-902"><a href="#cb196-902" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>merge <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb196-903"><a href="#cb196-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-904"><a href="#cb196-904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-905"><a href="#cb196-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-906"><a href="#cb196-906" aria-hidden="true" tabindex="-1"></a>Below, I will fit a non-linear model (Logistic) to model the leaf area evolution across the crop cycle.</span>
<span id="cb196-907"><a href="#cb196-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-908"><a href="#cb196-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge9}</span></span>
<span id="cb196-909"><a href="#cb196-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb196-910"><a href="#cb196-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb196-911"><a href="#cb196-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb196-912"><a href="#cb196-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb196-913"><a href="#cb196-913" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-914"><a href="#cb196-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-915"><a href="#cb196-915" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> </span>
<span id="cb196-916"><a href="#cb196-916" aria-hidden="true" tabindex="-1"></a>  merged<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb196-917"><a href="#cb196-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_col</span>(img, </span>
<span id="cb196-918"><a href="#cb196-918" aria-hidden="true" tabindex="-1"></a>               <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"avaliacao"</span>, <span class="st">"das"</span>, <span class="st">"bloco"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb196-919"><a href="#cb196-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">das =</span> <span class="fu">as.numeric</span>(das))</span>
<span id="cb196-920"><a href="#cb196-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-921"><a href="#cb196-921" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb196-922"><a href="#cb196-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-923"><a href="#cb196-923" aria-hidden="true" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span> </span>
<span id="cb196-924"><a href="#cb196-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb196-925"><a href="#cb196-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())</span>
<span id="cb196-926"><a href="#cb196-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-927"><a href="#cb196-927" aria-hidden="true" tabindex="-1"></a><span class="co"># leaf area</span></span>
<span id="cb196-928"><a href="#cb196-928" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> b1<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b2 <span class="sc">-</span> b3 <span class="sc">*</span> x))</span>
<span id="cb196-929"><a href="#cb196-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-930"><a href="#cb196-930" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(das, area_sum)) <span class="sc">+</span> </span>
<span id="cb196-931"><a href="#cb196-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"nls"</span>,</span>
<span id="cb196-932"><a href="#cb196-932" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">formula =</span> formula,</span>
<span id="cb196-933"><a href="#cb196-933" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b1 =</span> <span class="dv">248</span>,</span>
<span id="cb196-934"><a href="#cb196-934" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b2 =</span> <span class="dv">6</span>,</span>
<span id="cb196-935"><a href="#cb196-935" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b3 =</span> <span class="fl">0.07</span>)),</span>
<span id="cb196-936"><a href="#cb196-936" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-937"><a href="#cb196-937" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb196-938"><a href="#cb196-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se,</span>
<span id="cb196-939"><a href="#cb196-939" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb196-940"><a href="#cb196-940" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb196-941"><a href="#cb196-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb196-942"><a href="#cb196-942" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb196-943"><a href="#cb196-943" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb196-944"><a href="#cb196-944" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb196-945"><a href="#cb196-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df_plot<span class="sc">$</span>das)) <span class="sc">+</span></span>
<span id="cb196-946"><a href="#cb196-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb196-947"><a href="#cb196-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Days after sowing"</span>,</span>
<span id="cb196-948"><a href="#cb196-948" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Área<span class="sc">~</span>foliar<span class="sc">~</span>média<span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>planta<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}))) <span class="sc">+</span></span>
<span id="cb196-949"><a href="#cb196-949" aria-hidden="true" tabindex="-1"></a>  my_theme</span>
<span id="cb196-950"><a href="#cb196-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-951"><a href="#cb196-951" aria-hidden="true" tabindex="-1"></a><span class="co"># number of leaves</span></span>
<span id="cb196-952"><a href="#cb196-952" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> b1<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b2 <span class="sc">-</span> b3 <span class="sc">*</span> x))</span>
<span id="cb196-953"><a href="#cb196-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-954"><a href="#cb196-954" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(das, n)) <span class="sc">+</span> </span>
<span id="cb196-955"><a href="#cb196-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"nls"</span>,</span>
<span id="cb196-956"><a href="#cb196-956" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">formula =</span> formula,</span>
<span id="cb196-957"><a href="#cb196-957" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b1 =</span> <span class="dv">188</span>,</span>
<span id="cb196-958"><a href="#cb196-958" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b2 =</span> <span class="dv">3</span>,</span>
<span id="cb196-959"><a href="#cb196-959" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b3 =</span> <span class="fl">0.05</span>)),</span>
<span id="cb196-960"><a href="#cb196-960" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-961"><a href="#cb196-961" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb196-962"><a href="#cb196-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se,</span>
<span id="cb196-963"><a href="#cb196-963" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb196-964"><a href="#cb196-964" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb196-965"><a href="#cb196-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb196-966"><a href="#cb196-966" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb196-967"><a href="#cb196-967" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb196-968"><a href="#cb196-968" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb196-969"><a href="#cb196-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df_plot<span class="sc">$</span>das)) <span class="sc">+</span></span>
<span id="cb196-970"><a href="#cb196-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb196-971"><a href="#cb196-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Days after sowing"</span>,</span>
<span id="cb196-972"><a href="#cb196-972" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of leaves per plant"</span>) <span class="sc">+</span></span>
<span id="cb196-973"><a href="#cb196-973" aria-hidden="true" tabindex="-1"></a>  my_theme</span>
<span id="cb196-974"><a href="#cb196-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-975"><a href="#cb196-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-976"><a href="#cb196-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-977"><a href="#cb196-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-978"><a href="#cb196-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-979"><a href="#cb196-979" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filling 'holes'</span></span>
<span id="cb196-980"><a href="#cb196-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-981"><a href="#cb196-981" aria-hidden="true" tabindex="-1"></a>An important aspect to consider in leaf area measures is when leaves present 'holes'. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</span>
<span id="cb196-982"><a href="#cb196-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-983"><a href="#cb196-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10}</span></span>
<span id="cb196-984"><a href="#cb196-984" aria-hidden="true" tabindex="-1"></a>holes <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"holes.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-985"><a href="#cb196-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-986"><a href="#cb196-986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-987"><a href="#cb196-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-988"><a href="#cb196-988" aria-hidden="true" tabindex="-1"></a>In this case, the missing area will not be computed using the default settings of <span class="in">`analyze_objects()`</span>. To include this area as the leaf area, we can use the argument <span class="in">`fill_hull()`</span>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</span>
<span id="cb196-989"><a href="#cb196-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-990"><a href="#cb196-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10,}</span></span>
<span id="cb196-991"><a href="#cb196-991" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb196-992"><a href="#cb196-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb196-993"><a href="#cb196-993" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-994"><a href="#cb196-994" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb196-995"><a href="#cb196-995" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb196-996"><a href="#cb196-996" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb196-997"><a href="#cb196-997" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb196-998"><a href="#cb196-998" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb196-999"><a href="#cb196-999" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1000"><a href="#cb196-1000" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb196-1001"><a href="#cb196-1001" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb196-1002"><a href="#cb196-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1003"><a href="#cb196-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># fill the missing area</span></span>
<span id="cb196-1004"><a href="#cb196-1004" aria-hidden="true" tabindex="-1"></a>af2 <span class="ot">&lt;-</span></span>
<span id="cb196-1005"><a href="#cb196-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb196-1006"><a href="#cb196-1006" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span id="cb196-1007"><a href="#cb196-1007" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1008"><a href="#cb196-1008" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb196-1009"><a href="#cb196-1009" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb196-1010"><a href="#cb196-1010" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb196-1011"><a href="#cb196-1011" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb196-1012"><a href="#cb196-1012" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb196-1013"><a href="#cb196-1013" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1014"><a href="#cb196-1014" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prefix =</span> <span class="st">"proc2_"</span>,</span>
<span id="cb196-1015"><a href="#cb196-1015" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb196-1016"><a href="#cb196-1016" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb196-1017"><a href="#cb196-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1018"><a href="#cb196-1018" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"proc"</span>, <span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb196-1019"><a href="#cb196-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb196-1020"><a href="#cb196-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1021"><a href="#cb196-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1022"><a href="#cb196-1022" aria-hidden="true" tabindex="-1"></a>We can simply use the ratio between <span class="in">`proc_img`</span> and <span class="in">`proc_img2`</span> to compute the injured area in this leaflet.</span>
<span id="cb196-1023"><a href="#cb196-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1026"><a href="#cb196-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1027"><a href="#cb196-1027" aria-hidden="true" tabindex="-1"></a><span class="co"># percent of the injured area</span></span>
<span id="cb196-1028"><a href="#cb196-1028" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">-</span> <span class="dv">86432</span> <span class="sc">/</span> <span class="dv">99186</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb196-1029"><a href="#cb196-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1030"><a href="#cb196-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1031"><a href="#cb196-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1032"><a href="#cb196-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compound leaves</span></span>
<span id="cb196-1033"><a href="#cb196-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1034"><a href="#cb196-1034" aria-hidden="true" tabindex="-1"></a>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <span class="in">`analyze_objects()`</span>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</span>
<span id="cb196-1035"><a href="#cb196-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1036"><a href="#cb196-1036" aria-hidden="true" tabindex="-1"></a>The following images by <span class="co">[</span><span class="ot">Daniel Saueressig</span><span class="co">](https://www.florestaombrofilamista.com.br/sidol/?menu=contact)</span> were obtained from the *Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista*<span class="ot">[^11]</span> and show examples of simple and compound leaves.</span>
<span id="cb196-1037"><a href="#cb196-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1038"><a href="#cb196-1038" aria-hidden="true" tabindex="-1"></a><span class="ot">[^11]: https://www.florestaombrofilamista.com.br/sidol/?menu=glossary</span></span>
<span id="cb196-1039"><a href="#cb196-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1040"><a href="#cb196-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc1}</span></span>
<span id="cb196-1041"><a href="#cb196-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1042"><a href="#cb196-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1043"><a href="#cb196-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1044"><a href="#cb196-1044" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> </span>
<span id="cb196-1045"><a href="#cb196-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="fu">c</span>(<span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb196-1046"><a href="#cb196-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_horizontal</span>()</span>
<span id="cb196-1047"><a href="#cb196-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb196-1048"><a href="#cb196-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1049"><a href="#cb196-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1050"><a href="#cb196-1050" aria-hidden="true" tabindex="-1"></a>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm$^2$. With this information, it is possible to obtain the image resolution with <span class="in">`dpi(simple)`</span>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</span>
<span id="cb196-1051"><a href="#cb196-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1052"><a href="#cb196-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc2}</span></span>
<span id="cb196-1053"><a href="#cb196-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1054"><a href="#cb196-1054" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> imgs<span class="sc">$</span>simple.jpg</span>
<span id="cb196-1055"><a href="#cb196-1055" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(simple, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-1056"><a href="#cb196-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1057"><a href="#cb196-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1058"><a href="#cb196-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1059"><a href="#cb196-1059" aria-hidden="true" tabindex="-1"></a>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <span class="in">`object_size = "large"`</span> or <span class="in">`watershed = FALSE`</span>, to omit the watershed segmentation algorithm. The last is used here.</span>
<span id="cb196-1060"><a href="#cb196-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1061"><a href="#cb196-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc3}</span></span>
<span id="cb196-1062"><a href="#cb196-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1063"><a href="#cb196-1063" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> </span>
<span id="cb196-1064"><a href="#cb196-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(simple,</span>
<span id="cb196-1065"><a href="#cb196-1065" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1066"><a href="#cb196-1066" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb196-1067"><a href="#cb196-1067" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1068"><a href="#cb196-1068" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">6</span>)</span>
<span id="cb196-1069"><a href="#cb196-1069" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(sarea, <span class="at">dpi =</span> <span class="fl">48.65</span>)</span>
<span id="cb196-1070"><a href="#cb196-1070" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb196-1071"><a href="#cb196-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1072"><a href="#cb196-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1073"><a href="#cb196-1073" aria-hidden="true" tabindex="-1"></a>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</span>
<span id="cb196-1074"><a href="#cb196-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1075"><a href="#cb196-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc4}</span></span>
<span id="cb196-1076"><a href="#cb196-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1077"><a href="#cb196-1077" aria-hidden="true" tabindex="-1"></a>compound <span class="ot">&lt;-</span> imgs<span class="sc">$</span>compound.jpg</span>
<span id="cb196-1078"><a href="#cb196-1078" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb196-1079"><a href="#cb196-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb196-1080"><a href="#cb196-1080" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1081"><a href="#cb196-1081" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1082"><a href="#cb196-1082" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-1083"><a href="#cb196-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1084"><a href="#cb196-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1085"><a href="#cb196-1085" aria-hidden="true" tabindex="-1"></a>Therefore, using <span class="in">`watershed = FALSE`</span> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</span>
<span id="cb196-1086"><a href="#cb196-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1087"><a href="#cb196-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc5}</span></span>
<span id="cb196-1088"><a href="#cb196-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1089"><a href="#cb196-1089" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb196-1090"><a href="#cb196-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb196-1091"><a href="#cb196-1091" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1092"><a href="#cb196-1092" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1093"><a href="#cb196-1093" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1094"><a href="#cb196-1094" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-1095"><a href="#cb196-1095" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb196-1096"><a href="#cb196-1096" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(carea, <span class="at">dpi =</span> <span class="fl">49.5</span>)</span>
<span id="cb196-1097"><a href="#cb196-1097" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb196-1098"><a href="#cb196-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1099"><a href="#cb196-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1100"><a href="#cb196-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1101"><a href="#cb196-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1102"><a href="#cb196-1102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Shapefiles</span></span>
<span id="cb196-1103"><a href="#cb196-1103" aria-hidden="true" tabindex="-1"></a>Orthomosaic kindly provided by Prof. Dr. <span class="co">[</span><span class="ot">Ivan Ricardo Carvalho</span><span class="co">](https://www.researchgate.net/profile/Ivan-Carvalho-4)</span> (UNIJUÍ)</span>
<span id="cb196-1104"><a href="#cb196-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1105"><a href="#cb196-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1108"><a href="#cb196-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1109"><a href="#cb196-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1110"><a href="#cb196-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1111"><a href="#cb196-1111" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"mosaic.jpg"</span>)</span>
<span id="cb196-1112"><a href="#cb196-1112" aria-hidden="true" tabindex="-1"></a>aligned <span class="ot">&lt;-</span> <span class="fu">image_rotate</span>(shp, <span class="at">angle =</span> <span class="fl">82.591</span>)</span>
<span id="cb196-1113"><a href="#cb196-1113" aria-hidden="true" tabindex="-1"></a>cropped <span class="ot">&lt;-</span> <span class="fu">image_crop</span>(aligned,</span>
<span id="cb196-1114"><a href="#cb196-1114" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width =</span> <span class="dv">1900</span><span class="sc">:</span><span class="dv">2920</span>,</span>
<span id="cb196-1115"><a href="#cb196-1115" aria-hidden="true" tabindex="-1"></a>                      <span class="at">height =</span> <span class="dv">1350</span><span class="sc">:</span><span class="dv">1625</span>,</span>
<span id="cb196-1116"><a href="#cb196-1116" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-1117"><a href="#cb196-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1118"><a href="#cb196-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># or using the mapview option</span></span>
<span id="cb196-1119"><a href="#cb196-1119" aria-hidden="true" tabindex="-1"></a><span class="co"># cropped &lt;- image_prepare_mv(shp)</span></span>
<span id="cb196-1120"><a href="#cb196-1120" aria-hidden="true" tabindex="-1"></a>anal <span class="ot">&lt;-</span> </span>
<span id="cb196-1121"><a href="#cb196-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects_shp</span>(cropped,</span>
<span id="cb196-1122"><a href="#cb196-1122" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prepare =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1123"><a href="#cb196-1123" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">13</span>,</span>
<span id="cb196-1124"><a href="#cb196-1124" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index =</span> <span class="st">"HUE"</span>,</span>
<span id="cb196-1125"><a href="#cb196-1125" aria-hidden="true" tabindex="-1"></a>                      <span class="at">object_index =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb196-1126"><a href="#cb196-1126" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1127"><a href="#cb196-1127" aria-hidden="true" tabindex="-1"></a>                      <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-1128"><a href="#cb196-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(anal<span class="sc">$</span>final_image_masked)</span>
<span id="cb196-1129"><a href="#cb196-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(anal<span class="sc">$</span>shapefiles)</span>
<span id="cb196-1130"><a href="#cb196-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(anal, <span class="at">measure =</span> <span class="st">"coverage"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">160</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb196-1131"><a href="#cb196-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(anal, <span class="at">measure =</span> <span class="st">"DGCI"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">185</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb196-1132"><a href="#cb196-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1133"><a href="#cb196-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1134"><a href="#cb196-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1135"><a href="#cb196-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1136"><a href="#cb196-1136" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fourier analyses</span></span>
<span id="cb196-1137"><a href="#cb196-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Functions</span></span>
<span id="cb196-1138"><a href="#cb196-1138" aria-hidden="true" tabindex="-1"></a>The functions were adapted from Claude (2088)^[Claude, J. 2008. Morphometrics with R. Springer.</span>
<span id="cb196-1139"><a href="#cb196-1139" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb196-1140"><a href="#cb196-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1141"><a href="#cb196-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">## Elliptical fourier</span></span>
<span id="cb196-1142"><a href="#cb196-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1145"><a href="#cb196-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1146"><a href="#cb196-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1147"><a href="#cb196-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1148"><a href="#cb196-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1149"><a href="#cb196-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb196-1150"><a href="#cb196-1150" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"img"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb196-1151"><a href="#cb196-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(imgs) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ind"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb196-1152"><a href="#cb196-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1153"><a href="#cb196-1153" aria-hidden="true" tabindex="-1"></a>conts <span class="ot">&lt;-</span> </span>
<span id="cb196-1154"><a href="#cb196-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(imgs,</span>
<span id="cb196-1155"><a href="#cb196-1155" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb196-1156"><a href="#cb196-1156" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1157"><a href="#cb196-1157" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot =</span>  <span class="cn">FALSE</span>)</span>
<span id="cb196-1158"><a href="#cb196-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1159"><a href="#cb196-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1160"><a href="#cb196-1160" aria-hidden="true" tabindex="-1"></a>ef <span class="ot">&lt;-</span> <span class="fu">efourier</span>(conts, <span class="at">nharm =</span> <span class="dv">30</span>)</span>
<span id="cb196-1161"><a href="#cb196-1161" aria-hidden="true" tabindex="-1"></a>efi1 <span class="ot">&lt;-</span> <span class="fu">efourier_inv</span>(ef[[<span class="dv">8</span>]], <span class="at">nharm =</span> <span class="dv">5</span>)</span>
<span id="cb196-1162"><a href="#cb196-1162" aria-hidden="true" tabindex="-1"></a>efi2 <span class="ot">&lt;-</span> <span class="fu">efourier_inv</span>(ef[[<span class="dv">8</span>]], <span class="at">nharm =</span> <span class="dv">10</span>)</span>
<span id="cb196-1163"><a href="#cb196-1163" aria-hidden="true" tabindex="-1"></a>efi3 <span class="ot">&lt;-</span> <span class="fu">efourier_inv</span>(ef[[<span class="dv">8</span>]], <span class="at">nharm =</span> <span class="dv">30</span>)</span>
<span id="cb196-1164"><a href="#cb196-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1165"><a href="#cb196-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imgs[[<span class="dv">8</span>]])</span>
<span id="cb196-1166"><a href="#cb196-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(efi1)</span>
<span id="cb196-1167"><a href="#cb196-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(efi2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb196-1168"><a href="#cb196-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(efi3, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb196-1169"><a href="#cb196-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1170"><a href="#cb196-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1171"><a href="#cb196-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1172"><a href="#cb196-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rotation and size</span></span>
<span id="cb196-1173"><a href="#cb196-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1176"><a href="#cb196-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1177"><a href="#cb196-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1178"><a href="#cb196-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1179"><a href="#cb196-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb196-1180"><a href="#cb196-1180" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"changes.png"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb196-1181"><a href="#cb196-1181" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb196-1182"><a href="#cb196-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img,</span>
<span id="cb196-1183"><a href="#cb196-1183" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb196-1184"><a href="#cb196-1184" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1185"><a href="#cb196-1185" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot =</span>  <span class="cn">FALSE</span>)</span>
<span id="cb196-1186"><a href="#cb196-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1187"><a href="#cb196-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1188"><a href="#cb196-1188" aria-hidden="true" tabindex="-1"></a>ef <span class="ot">&lt;-</span> </span>
<span id="cb196-1189"><a href="#cb196-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier</span>(cont) <span class="sc">|&gt;</span> </span>
<span id="cb196-1190"><a href="#cb196-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_norm</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1191"><a href="#cb196-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_coefs</span>()</span>
<span id="cb196-1192"><a href="#cb196-1192" aria-hidden="true" tabindex="-1"></a>ef</span>
<span id="cb196-1193"><a href="#cb196-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1194"><a href="#cb196-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1195"><a href="#cb196-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1196"><a href="#cb196-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1197"><a href="#cb196-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Morphological diversity</span></span>
<span id="cb196-1198"><a href="#cb196-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1201"><a href="#cb196-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1202"><a href="#cb196-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1203"><a href="#cb196-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1204"><a href="#cb196-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1205"><a href="#cb196-1205" aria-hidden="true" tabindex="-1"></a>conts <span class="ot">&lt;-</span> </span>
<span id="cb196-1206"><a href="#cb196-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(imgs,</span>
<span id="cb196-1207"><a href="#cb196-1207" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb196-1208"><a href="#cb196-1208" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1209"><a href="#cb196-1209" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot =</span>  <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb196-1210"><a href="#cb196-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1211"><a href="#cb196-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_norm</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1212"><a href="#cb196-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_coefs</span>()</span>
<span id="cb196-1213"><a href="#cb196-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1214"><a href="#cb196-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1215"><a href="#cb196-1215" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> </span>
<span id="cb196-1216"><a href="#cb196-1216" aria-hidden="true" tabindex="-1"></a>  conts <span class="sc">|&gt;</span> </span>
<span id="cb196-1217"><a href="#cb196-1217" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>object) <span class="sc">|&gt;</span> </span>
<span id="cb196-1218"><a href="#cb196-1218" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">specie =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"specie"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each =</span> <span class="dv">3</span>)), <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb196-1219"><a href="#cb196-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1220"><a href="#cb196-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1221"><a href="#cb196-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb196-1222"><a href="#cb196-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb196-1223"><a href="#cb196-1223" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(coefs, <span class="at">quali.sup =</span> <span class="dv">1</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-1224"><a href="#cb196-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca, <span class="at">habillage =</span> <span class="dv">1</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-1225"><a href="#cb196-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1226"><a href="#cb196-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb196-1227"><a href="#cb196-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1228"><a href="#cb196-1228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1229"><a href="#cb196-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1230"><a href="#cb196-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1231"><a href="#cb196-1231" aria-hidden="true" tabindex="-1"></a><span class="fu"># Distance to an ideotype</span></span>
<span id="cb196-1232"><a href="#cb196-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1235"><a href="#cb196-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb196-1236"><a href="#cb196-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb196-1237"><a href="#cb196-1237" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"distance.png"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb196-1238"><a href="#cb196-1238" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb196-1239"><a href="#cb196-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img,</span>
<span id="cb196-1240"><a href="#cb196-1240" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb196-1241"><a href="#cb196-1241" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-1242"><a href="#cb196-1242" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot =</span>  <span class="cn">TRUE</span>)</span>
<span id="cb196-1243"><a href="#cb196-1243" aria-hidden="true" tabindex="-1"></a>efs <span class="ot">&lt;-</span> </span>
<span id="cb196-1244"><a href="#cb196-1244" aria-hidden="true" tabindex="-1"></a>  cont <span class="sc">|&gt;</span> </span>
<span id="cb196-1245"><a href="#cb196-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1246"><a href="#cb196-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_norm</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1247"><a href="#cb196-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efourier_coefs</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-1248"><a href="#cb196-1248" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>object)</span>
<span id="cb196-1249"><a href="#cb196-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1250"><a href="#cb196-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1251"><a href="#cb196-1251" aria-hidden="true" tabindex="-1"></a>desc_ide <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(efs[<span class="dv">1</span>, ])</span>
<span id="cb196-1252"><a href="#cb196-1252" aria-hidden="true" tabindex="-1"></a>desc_objs <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(efs[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb196-1253"><a href="#cb196-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1254"><a href="#cb196-1254" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the differences between each object and the ideotype</span></span>
<span id="cb196-1255"><a href="#cb196-1255" aria-hidden="true" tabindex="-1"></a>gen_ide <span class="ot">&lt;-</span> <span class="fu">sweep</span>(desc_objs, <span class="dv">2</span>, desc_ide, <span class="st">"-"</span>)</span>
<span id="cb196-1256"><a href="#cb196-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1257"><a href="#cb196-1257" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> </span>
<span id="cb196-1258"><a href="#cb196-1258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(gen_ide, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))}) <span class="sc">%&gt;%</span> </span>
<span id="cb196-1259"><a href="#cb196-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb196-1260"><a href="#cb196-1260" aria-hidden="true" tabindex="-1"></a>distances</span>
<span id="cb196-1261"><a href="#cb196-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1262"><a href="#cb196-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb196-1263"><a href="#cb196-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>The {pliman} R package</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Prof.&nbsp;Dr.&nbsp;Tiago Olivoto FIT/CCA/UFSC</p>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>