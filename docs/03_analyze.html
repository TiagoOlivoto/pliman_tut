<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R package {pliman} - Analyze objects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_phytopathometry.html" rel="next">
<link href="./02_segment.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R package {pliman}</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./00_about.html">About</a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto"><i class="bi bi-fab fa-researchgate fa" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TiagoOlivoto/pliman"><i class="bi bi-bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tolivoto"><i class="bi bi-bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><i class="bi bi-fab fa-mendeley fa" role="img">
</i> 
 </a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Analyze objects</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_manipulate.html" class="sidebar-item-text sidebar-link">Import and manipulate</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_segment.html" class="sidebar-item-text sidebar-link">Segment objects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_analyze.html" class="sidebar-item-text sidebar-link active">Analyze objects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_phytopathometry.html" class="sidebar-item-text sidebar-link">Phytopathometry</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">In this page</h2>
   
  <ul>
<li><a href="#directory" id="toc-directory" class="nav-link active" data-scroll-target="#directory"> <span class="header-section-number">1</span> Directory</a></li>
  <li>
<a href="#working-with-polygons" id="toc-working-with-polygons" class="nav-link" data-scroll-target="#working-with-polygons"> <span class="header-section-number">2</span> Working with polygons</a>
  <ul class="collapse">
<li><a href="#area" id="toc-area" class="nav-link" data-scroll-target="#area"> <span class="header-section-number">2.1</span> Area</a></li>
  <li><a href="#perimeter" id="toc-perimeter" class="nav-link" data-scroll-target="#perimeter"> <span class="header-section-number">2.2</span> Perimeter</a></li>
  <li><a href="#radius" id="toc-radius" class="nav-link" data-scroll-target="#radius"> <span class="header-section-number">2.3</span> Radius</a></li>
  <li><a href="#length-and-width" id="toc-length-and-width" class="nav-link" data-scroll-target="#length-and-width"> <span class="header-section-number">2.4</span> Length and width</a></li>
  <li><a href="#circularity-eccentricity-diameter-and-elongation" id="toc-circularity-eccentricity-diameter-and-elongation" class="nav-link" data-scroll-target="#circularity-eccentricity-diameter-and-elongation"> <span class="header-section-number">2.5</span> Circularity, eccentricity, diameter, and elongation</a></li>
  <li><a href="#rotate-polygons" id="toc-rotate-polygons" class="nav-link" data-scroll-target="#rotate-polygons"> <span class="header-section-number">2.6</span> Rotate polygons</a></li>
  <li><a href="#invert-polygons" id="toc-invert-polygons" class="nav-link" data-scroll-target="#invert-polygons"> <span class="header-section-number">2.7</span> Invert polygons</a></li>
  <li><a href="#perimeter-sampling" id="toc-perimeter-sampling" class="nav-link" data-scroll-target="#perimeter-sampling"> <span class="header-section-number">2.8</span> Perimeter sampling</a></li>
  <li><a href="#smoothing" id="toc-smoothing" class="nav-link" data-scroll-target="#smoothing"> <span class="header-section-number">2.9</span> smoothing</a></li>
  <li><a href="#noises" id="toc-noises" class="nav-link" data-scroll-target="#noises"> <span class="header-section-number">2.10</span> Noises</a></li>
  </ul>
</li>
  <li>
<a href="#analyzing-objects" id="toc-analyzing-objects" class="nav-link" data-scroll-target="#analyzing-objects"> <span class="header-section-number">3</span> Analyzing objects</a>
  <ul class="collapse">
<li>
<a href="#adjusting-object-measurements" id="toc-adjusting-object-measurements" class="nav-link" data-scroll-target="#adjusting-object-measurements"> <span class="header-section-number">3.1</span> Adjusting object measurements</a>
  <ul class="collapse">
<li><a href="#declaring-a-known-value" id="toc-declaring-a-known-value" class="nav-link" data-scroll-target="#declaring-a-known-value"> <span class="header-section-number">3.1.1</span> Declaring a known value</a></li>
  <li><a href="#declaring-the-image-resolution" id="toc-declaring-the-image-resolution" class="nav-link" data-scroll-target="#declaring-the-image-resolution"> <span class="header-section-number">3.1.2</span> Declaring the image resolution</a></li>
  <li><a href="#understanding-measurements" id="toc-understanding-measurements" class="nav-link" data-scroll-target="#understanding-measurements"> <span class="header-section-number">3.1.3</span> Understanding measurements</a></li>
  </ul>
</li>
  <li><a href="#texture-features" id="toc-texture-features" class="nav-link" data-scroll-target="#texture-features"> <span class="header-section-number">3.2</span> Texture features</a></li>
  <li><a href="#single-image-processing" id="toc-single-image-processing" class="nav-link" data-scroll-target="#single-image-processing"> <span class="header-section-number">3.3</span> Single image processing</a></li>
  <li><a href="#batch-processing" id="toc-batch-processing" class="nav-link" data-scroll-target="#batch-processing"> <span class="header-section-number">3.4</span> Batch processing</a></li>
  </ul>
</li>
  <li><a href="#object-coordinates" id="toc-object-coordinates" class="nav-link" data-scroll-target="#object-coordinates"> <span class="header-section-number">4</span> Object coordinates</a></li>
  <li><a href="#isolating-objects" id="toc-isolating-objects" class="nav-link" data-scroll-target="#isolating-objects"> <span class="header-section-number">5</span> Isolating objects</a></li>
  <li><a href="#including-objects-in-a-list" id="toc-including-objects-in-a-list" class="nav-link" data-scroll-target="#including-objects-in-a-list"> <span class="header-section-number">6</span> Including objects in a list</a></li>
  <li><a href="#rgb-values-for-each-object" id="toc-rgb-values-for-each-object" class="nav-link" data-scroll-target="#rgb-values-for-each-object"> <span class="header-section-number">7</span> RGB values for each object</a></li>
  <li>
<a href="#leaf-area" id="toc-leaf-area" class="nav-link" data-scroll-target="#leaf-area"> <span class="header-section-number">8</span> Leaf area</a>
  <ul class="collapse">
<li><a href="#known-resolution" id="toc-known-resolution" class="nav-link" data-scroll-target="#known-resolution"> <span class="header-section-number">8.1</span> Known resolution</a></li>
  <li>
<a href="#reference-object-dev-version" id="toc-reference-object-dev-version" class="nav-link" data-scroll-target="#reference-object-dev-version"> <span class="header-section-number">8.2</span> Reference object (dev version)</a>
  <ul class="collapse">
<li><a href="#single-images" id="toc-single-images" class="nav-link" data-scroll-target="#single-images"> <span class="header-section-number">8.2.1</span> Single images</a></li>
  <li><a href="#multiple-images" id="toc-multiple-images" class="nav-link" data-scroll-target="#multiple-images"> <span class="header-section-number">8.2.2</span> Multiple images</a></li>
  </ul>
</li>
  <li><a href="#filling-holes" id="toc-filling-holes" class="nav-link" data-scroll-target="#filling-holes"> <span class="header-section-number">8.3</span> Filling ‘holes’</a></li>
  <li><a href="#compound-leaves" id="toc-compound-leaves" class="nav-link" data-scroll-target="#compound-leaves"> <span class="header-section-number">8.4</span> Compound leaves</a></li>
  </ul>
</li>
  <li><a href="#shapefiles" id="toc-shapefiles" class="nav-link" data-scroll-target="#shapefiles"> <span class="header-section-number">9</span> Shapefiles</a></li>
  <li>
<a href="#fourier-analyses" id="toc-fourier-analyses" class="nav-link" data-scroll-target="#fourier-analyses"> <span class="header-section-number">10</span> Fourier analyses</a>
  <ul class="collapse">
<li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions"> <span class="header-section-number">10.1</span> Functions</a></li>
  <li><a href="#elliptical-fourier" id="toc-elliptical-fourier" class="nav-link" data-scroll-target="#elliptical-fourier"> <span class="header-section-number">10.2</span> Elliptical fourier</a></li>
  <li><a href="#rotation-and-size" id="toc-rotation-and-size" class="nav-link" data-scroll-target="#rotation-and-size"> <span class="header-section-number">10.3</span> Rotation and size</a></li>
  <li><a href="#morphological-diversity" id="toc-morphological-diversity" class="nav-link" data-scroll-target="#morphological-diversity"> <span class="header-section-number">10.4</span> Morphological diversity</a></li>
  </ul>
</li>
  <li>
<a href="#distance-to-an-ideotype" id="toc-distance-to-an-ideotype" class="nav-link" data-scroll-target="#distance-to-an-ideotype"> <span class="header-section-number">11</span> Distance to an ideotype</a>
  <ul class="collapse">
<li><a href="#cluster-objects" id="toc-cluster-objects" class="nav-link" data-scroll-target="#cluster-objects"> <span class="header-section-number">11.1</span> Cluster objects</a></li>
  <li><a href="#distance-to-an-ideotype-1" id="toc-distance-to-an-ideotype-1" class="nav-link" data-scroll-target="#distance-to-an-ideotype-1"> <span class="header-section-number">11.2</span> Distance to an ideotype</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Analyze objects</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><section id="directory" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Directory</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="working-with-polygons" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Working with polygons</h1>
<blockquote class="blockquote">
<p>A ‘polygon’ is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
</blockquote>
<p>We can then conclude that image objects can be expressed as polygons with <code>n</code> vertices. <code>pliman</code> has a set of functions(<code>draw_*()</code>) useful for drawing common shapes like circles, squares, triangles, rectangles and <code>n</code>- tagons . Another group of <code>poly_*()</code> functions can be used to analyze polygons. Let’s start with a simple example related to the area and perimeter of a square.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Tools for Plant Image Analysis (pliman 1.2.0)            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Author: Tiago Olivoto                                    |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'citation('pliman')' to know how to cite pliman     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'vignette('pliman_start')' for a short tutorial     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Visit 'http://bit.ly/pkg_pliman' for a complete tutorial |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>|==========================================================|</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">square</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">square</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>Now, let’s see what happens when we start with a hexagon and increase the number of sides up to 1000.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shapes</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>side6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side12 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">8</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side24 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">12</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">50</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side500 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">100</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       side100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_n_tagon</a></span><span class="op">(</span><span class="fl">1000</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">shapes</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   side6   side12   side24  side100  side500  side100 
2.598076 2.828427 3.000000 3.133331 3.139526 3.141572 </code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   side6   side12   side24  side100  side500  side100 
6.000000 6.122935 6.211657 6.279052 6.282152 6.283175 </code></pre>
</div>
</div>
<p>Note that when <span class="math inline">\(n \to \infty\)</span>, the sum of the sides becomes the circumference of the circle, given by <span class="math inline">\(2 \pi r\)</span>, and the area becomes <span class="math inline">\(\pi r^2\)</span>. This is fun, but <code>pliman</code> is primarily designed for analyzing plant image analysis. So why use polygons? Let’s see how we can use these functions to get applicable information.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># getting the outline of objects</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B-R"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plotting the polygon</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 2, 12, and 23.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cont</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"12"</span>, <span class="st">"23"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>In the current version of <code>pliman</code>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, Claude (2008)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and Montero et al.&nbsp;(2009)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<section id="area" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="area">
<span class="header-section-number">2.1</span> Area</h2>
<p>The area of a shape is calculated using Shoelace’s formula (Lee and Lim, 2017)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, as follows</p>
<p><span class="math display">\[
A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_area</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1       2      12      23 
18379.0 36412.5  8294.0  1750.0 </code></pre>
</div>
</div>
</section><section id="perimeter" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="perimeter">
<span class="header-section-number">2.2</span> Perimeter</h2>
<p>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_distpts()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
 615.0143 1122.8448  469.5584  555.0833 </code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># perimeter of a circle with radius 2</span></span>
<span><span class="va">circle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_perimeter</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.56635</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check the result</span></span>
<span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.56637</code></pre>
</div>
</div>
</section><section id="radius" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="radius">
<span class="header-section-number">2.3</span> Radius</h2>
<p>The radius of a pixel on the object’s contour is calculated as its distance from the object’s centroid(also called ‘center of mass’). These distances can be obtained with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stats for radius</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
 81.52730 107.18736  61.76413  68.00845 </code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">min_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2       12       23 
56.16876 62.37804 29.40537  3.44969 </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">max_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2       12       23 
126.9367 152.4562 106.8634 135.5301 </code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">sd_list</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2       12       23 
17.40508 18.44772 23.15230 38.91780 </code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># average radius of above circle</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_centdist</a></span><span class="op">(</span><span class="va">circle</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_stats.html">mean_list</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.999998</code></pre>
</div>
</div>
</section><section id="length-and-width" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="length-and-width">
<span class="header-section-number">2.4</span> Length and width</h2>
<p>The length and width of an object are calculated with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw()</a></code>, as the difference between the maximum and minimum of the <code>x</code> and <code>y</code> coordinates after the object has been aligned with <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_align()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_lw</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     length     width
1  238.5645 125.11629
2  280.5703 237.69880
12 208.3183  68.91907
23 269.2557  10.63356</code></pre>
</div>
</div>
</section><section id="circularity-eccentricity-diameter-and-elongation" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="circularity-eccentricity-diameter-and-elongation">
<span class="header-section-number">2.5</span> Circularity, eccentricity, diameter, and elongation</h2>
<p>Circularity(Montero et al.&nbsp;2009)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is also called shape compactness, or measure of roundness of an object. It is given by <span class="math inline">\(C = P^2 / A\)</span>, where <span class="math inline">\(P\)</span> is the perimeter and <span class="math inline">\(A\)</span> is the area of the object.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
 20.58015  34.62494  26.58369 176.06710 </code></pre>
</div>
</div>
<p>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have a circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given <span class="math inline">\(Cn = P^2 / 4 \pi A\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
 1.637716  2.755365  2.115463 14.010975 </code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># normalized circularity for different shapes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_square</a></span><span class="op">(</span>plot <span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.27324</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_norm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.000003</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick()</a></code> calculates the Circularity of Haralick, CH (Haralick, 1974)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. The method is based on calculating all Euclidean distances from the object’s centroid to each contour pixel. With this set of distances, the mean(<span class="math inline">\(m\)</span>) and the standard deviation(<span class="math inline">\(s\)</span>) are calculated. These statistical parameters are used in a ratio that calculates CH as $CH = m/ sd $.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_circularity_haralick</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2       12       23 
4.684109 5.810331 2.667732 1.747489 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity()</a></code> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_convexity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
0.8795792 0.6891546 0.9133513 0.7703550 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity()</a></code> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_eccentricity</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2         12         23 
0.34777030 0.84355337 0.12747908 0.00205374 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation()</a></code> Calculates the elongation of an object as <code>1 - width / length</code></p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_elongation</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2        12        23 
0.4755452 0.1528012 0.6691646 0.9605076 </code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper()</a></code> Calculates the gauge(also called Feret’s diameter).</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_caliper</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2       12       23 
238.6064 284.5083 208.4322 269.2675 </code></pre>
</div>
</div>
<p>Users can use the <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code> function to calculate most object measurements in a single call.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures</a></span><span class="op">(</span><span class="va">cont</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_rows_cols.html">round_cols</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            1        2      12      23
id                       1.00     2.00    3.00    4.00
x                      472.94   808.90  443.60  412.66
y                      144.26   168.36  512.17  657.39
area                 18379.00 36412.50 8294.00 1750.00
area_ch              19558.00 45900.50 8815.50 2110.50
perimeter              615.01  1122.84  469.56  555.08
radius_mean             81.53   107.19   61.76   68.01
radius_min              56.17    62.38   29.41    3.45
radius_max             126.94   152.46  106.86  135.53
radius_sd               17.41    18.45   23.15   38.92
radius_ratio             2.26     2.44    3.63   39.29
diam_mean              163.05   214.37  123.53  136.02
diam_min               112.34   124.76   58.81    6.90
diam_max               253.87   304.91  213.73  271.06
caliper                238.61   284.51  208.43  269.27
length                 238.56   280.57  208.32  269.26
width                  125.12   237.70   68.92   10.63
solidity                 0.94     0.79    0.94    0.83
convexity                0.88     0.69    0.91    0.77
elongation               0.48     0.15    0.67    0.96
circularity             20.58    34.62   26.58  176.07
circularity_haralick     3.23     3.38    1.27    0.09
circularity_norm         1.64     2.76    2.12   14.01
eccentricity             0.35     0.84    0.13    0.00</code></pre>
</div>
</div>
<p>If the image resolution is known, the measurements can be corrected with <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">dpi()</a></code> the resolution can be obtained. In this case, the dpi is ~50.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">color_measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">measures</span>, dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">color_measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           1       2      12      23
id                     1.000   2.000   3.000   4.000
x                    472.940 808.900 443.600 412.660
y                    144.260 168.360 512.170 657.390
area                  47.430  93.968  21.404   4.516
area_ch               50.472 118.453  22.750   5.446
perimeter             31.243  57.040  23.854  28.198
radius_mean            4.142   5.445   3.137   3.455
radius_min             2.853   3.169   1.494   0.175
radius_max             6.449   7.745   5.428   6.885
radius_sd              0.884   0.937   1.176   1.977
radius_ratio           0.115   0.124   0.184   1.996
diam_mean              8.283  10.890   6.275   6.910
diam_min               5.707   6.338   2.988   0.351
diam_max              12.897  15.489  10.857  13.770
caliper               12.121  14.453  10.588  13.679
length                12.119  14.253  10.583  13.678
width                  6.356  12.075   3.501   0.540
solidity               0.940   0.790   0.940   0.830
convexity              0.880   0.690   0.910   0.770
elongation             0.480   0.150   0.670   0.960
circularity           20.580  34.620  26.580 176.070
circularity_haralick   3.230   3.380   1.270   0.090
circularity_norm       1.640   2.760   2.120  14.010
eccentricity           0.350   0.840   0.130   0.000</code></pre>
</div>
</div>
<p>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <code>pliman</code>. Just for simplicity, I’ll use only one object.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="va">cont</span><span class="op">[[</span><span class="st">"12"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="rotate-polygons" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="rotate-polygons">
<span class="header-section-number">2.6</span> Rotate polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate()</a></code> can be used to rotate the polygon coordinates by an <code>angle</code> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_rotate</a></span><span class="op">(</span><span class="va">o2</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="invert-polygons" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="invert-polygons">
<span class="header-section-number">2.7</span> Invert polygons</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y()</a></code> can be used to flip shapes along the x and y axis, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flipped</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_x</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span>, </span>
<span>       fy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_flip_y</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">flipped</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="perimeter-sampling" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="perimeter-sampling">
<span class="header-section-number">2.8</span> Perimeter sampling</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample()</a></code> samples <code>n</code> coordinates between existing points, and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop()</a></code> samples a proportion of coordinates between existing ones.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 50 coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample</a></span><span class="op">(</span><span class="va">o2</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># sample 10% of coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_sample_prop</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="smoothing" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="smoothing">
<span class="header-section-number">2.9</span> smoothing</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth()</a></code> smooths the contour of a polygon by combining <code>prop</code> coordinate point samples and interpolating them using <code>vertices</code> vertices(default is 1000) .</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> original <span class="op">=</span> <span class="va">o2</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_smooth</a></span><span class="op">(</span><span class="va">o2</span>, prop <span class="op">=</span> <span class="fl">0.04</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">smoothed</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="noises" class="level2" data-number="2.10"><h2 data-number="2.10" class="anchored" data-anchor-id="noises">
<span class="header-section-number">2.10</span> Noises</h2>
<p><code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter()</a></code> adds a small amount of noise to a set of coordinates. See <code><a href="https://rdrr.io/r/base/jitter.html">base::jitter()</a></code> for more details.</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_shapes.html">draw_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_jitter</a></span><span class="op">(</span>noise_x <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              noise_y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section></section><section id="analyzing-objects" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Analyzing objects</h1>
<p>The functions we’ve seen can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour()</a></code> and <code><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_measures()</a></code>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. Let’s start with a simple example, using the <code>object_300dpi.png</code> image available on <a href="https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images">GitHub page</a>. To facilitate importing images from this folder, an <code><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman()</a></code> helper function is used.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_pliman</a></span><span class="op">(</span><span class="st">"objects_300dpi.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</p>
<ul>
<li>Larger square: 10 x 10 cm (100 cm<span class="math inline">\(^2\)</span>)</li>
<li>Smaller square: 5 x 5 cm(25 cm<span class="math inline">\(^2\)</span>)</li>
<li>Rectangle: 4 x 2 cm(8 cm<span class="math inline">\(^2\)</span>)</li>
<li>Circle: 3 cm in diameter(~7.07 cm<span class="math inline">\(^2\)</span>)</li>
</ul>
<p>To count the objects in the image we use <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> and inform the image(the only required argument). By default, the <code>NB</code> index is used for object segmentation.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="adjusting-object-measurements" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="adjusting-object-measurements">
<span class="header-section-number">3.1</span> Adjusting object measurements</h2>
<p>The results were stored in <code>img_res</code>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm<span class="math inline">\(^2\)</span>, only in pixels. In this case, we use <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code> to adjust pixel measurements to metric units.</p>
<p>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area, and radius will be adjusted by the dpi informed.</p>
<section id="declaring-a-known-value" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="declaring-a-known-value">
<span class="header-section-number">3.1.1</span> Declaring a known value</h3>
<p>Since we know the area of the larger square (object 1), let’s adjust the area of the other objects in the image using this.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             <span class="va">area</span> <span class="op">~</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------
measures corrected with:
object id: 1
area     : 100
-----------------------------------------
Total    : 40.009 
Average  : 13.336 
-----------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                            2        3        4
id                      2.000    3.000    4.000
x                    1737.518 1737.571 1737.966
y                     452.998 1296.354  939.007
area                   25.041    7.019    7.949
area_ch                24.958    7.022    7.907
perimeter              19.983   10.093   11.913
radius_mean             2.866    1.491    1.668
radius_min              2.492    1.479    0.988
radius_max              3.531    1.504    2.224
radius_sd               0.314    0.004    0.423
diam_mean               5.732    2.982    3.335
diam_min                4.983    2.957    1.976
diam_max                7.062    3.008    4.449
major_axis              5.783    2.990    4.609
minor_axis              5.773    2.989    2.299
length                  6.520    2.996    3.994
width                   6.509    2.999    1.987
radius_ratio            1.417    1.017    2.252
eccentricity            0.996    0.994    0.348
theta                   1.563   -1.547    0.000
solidity                1.003    1.000    1.005
convexity               0.749    0.905    0.836
elongation              0.002   -0.001    0.502
circularity            15.946   14.512   17.854
circularity_haralick    9.127  423.369    3.947
circularity_norm        1.273    1.161    1.430
coverage                0.107    0.030    0.034
asm                     0.913    0.829    0.853
con                     0.051    0.078    0.069
cor                     0.731    0.781    0.786
var                     1.095    1.178    1.161
idm                     0.987    0.975    0.979
sav                    21.901   21.821   21.828
sva                   475.312  468.297  470.245
sen                     0.106    0.196    0.156
ent                     0.116    0.220    0.176
dva                     0.051    0.078    0.069
den                     0.054    0.090    0.076
f12                     0.518    0.523    0.555
f13                     0.279    0.380    0.356</code></pre>
</div>
</div>
</section><section id="declaring-the-image-resolution" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="declaring-the-image-resolution">
<span class="header-section-number">3.1.2</span> Declaring the image resolution</h3>
<p>If the image resolution is known, all measurements will be adjusted accordingly. Let’s see a numerical example with <code><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm()</a></code>. This function converts the number of pixels(* px *) into cm, considering the image resolution in <code>dpi</code>, as follows: <span class="math inline">\(cm = px \times(2.54 / dpi)\)</span>. As we know the number of pixels of the larger square, its perimeter in cm is given by</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span></span>
<span><span class="va">ls_px</span> <span class="op">&lt;-</span> <span class="va">img_res</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">perimeter</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_dpi.html">pixels_to_cm</a></span><span class="op">(</span>px <span class="op">=</span> <span class="va">ls_px</span> , dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.9265</code></pre>
</div>
</div>
<p>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <code>dpi</code> argument in <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img_res_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">img_res</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           1        2        3        4
id                     1.000    2.000    3.000    4.000
x                    668.995 1737.518 1737.571 1737.966
y                    797.992  452.998 1296.354  939.007
area                  99.812   24.994    7.006    7.934
area_ch               99.686   24.911    7.008    7.892
perimeter             39.926   19.964   10.083   11.902
radius_mean            5.728    2.863    1.489    1.666
radius_min             4.984    2.489    1.477    0.987
radius_max             7.057    3.528    1.502    2.222
radius_sd              0.629    0.314    0.004    0.422
diam_mean             11.456    5.726    2.979    3.332
diam_min               9.967    4.978    2.955    1.974
diam_max              14.114    7.055    3.005    4.445
major_axis            11.546    5.778    2.987    4.604
minor_axis            11.526    5.768    2.986    2.297
length                11.121    6.514    2.994    3.990
width                 11.107    6.503    2.996    1.985
radius_ratio           1.416    1.417    1.017    2.252
eccentricity           0.997    0.996    0.994    0.348
theta                 -0.007    1.563   -1.547    0.000
solidity               1.001    1.003    1.000    1.005
convexity              0.750    0.749    0.905    0.836
elongation             0.001    0.002   -0.001    0.502
circularity           15.971   15.946   14.512   17.854
circularity_haralick   9.111    9.127  423.369    3.947
circularity_norm       1.273    1.273    1.161    1.430
coverage               0.427    0.107    0.030    0.034
asm                    0.949    0.913    0.829    0.853
con                    0.016    0.051    0.078    0.069
cor                    0.797    0.731    0.781    0.786
var                    1.040    1.095    1.178    1.161
idm                    0.995    0.987    0.975    0.979
sav                   21.946   21.901   21.821   21.828
sva                  478.992  475.312  468.297  470.245
sen                    0.063    0.106    0.196    0.156
ent                    0.069    0.116    0.220    0.176
dva                    0.016    0.051    0.078    0.069
den                    0.024    0.054    0.090    0.076
f12                    0.674    0.518    0.523    0.555
f13                    0.260    0.279    0.380    0.356</code></pre>
</div>
</div>
</section><section id="understanding-measurements" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="understanding-measurements">
<span class="header-section-number">3.1.3</span> Understanding measurements</h3>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># get the contour of objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> <span class="co"># computes the center of mass and minimum and maximum radii</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_mass</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot the measurements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Larger square:</li>
<li>The minimum diameter(a = 9.97) can be considered as the side of the square</li>
<li>The maximum diameter, given by <span class="math inline">\(a \sqrt {2}\)</span> can be considered the diagonal of the square (<span class="math inline">\(9.97 \sqrt {2} = 14,099 \approx 14,105\)</span>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">img_res_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           1        2        3        4
id                     1.000    2.000    3.000    4.000
x                    668.995 1737.518 1737.571 1737.966
y                    797.992  452.998 1296.354  939.007
area                  99.812   24.994    7.006    7.934
area_ch               99.686   24.911    7.008    7.892
perimeter             39.926   19.964   10.083   11.902
radius_mean            5.728    2.863    1.489    1.666
radius_min             4.984    2.489    1.477    0.987
radius_max             7.057    3.528    1.502    2.222
radius_sd              0.629    0.314    0.004    0.422
diam_mean             11.456    5.726    2.979    3.332
diam_min               9.967    4.978    2.955    1.974
diam_max              14.114    7.055    3.005    4.445
major_axis            11.546    5.778    2.987    4.604
minor_axis            11.526    5.768    2.986    2.297
length                11.121    6.514    2.994    3.990
width                 11.107    6.503    2.996    1.985
radius_ratio           1.416    1.417    1.017    2.252
eccentricity           0.997    0.996    0.994    0.348
theta                 -0.007    1.563   -1.547    0.000
solidity               1.001    1.003    1.000    1.005
convexity              0.750    0.749    0.905    0.836
elongation             0.001    0.002   -0.001    0.502
circularity           15.971   15.946   14.512   17.854
circularity_haralick   9.111    9.127  423.369    3.947
circularity_norm       1.273    1.273    1.161    1.430
coverage               0.427    0.107    0.030    0.034
asm                    0.949    0.913    0.829    0.853
con                    0.016    0.051    0.078    0.069
cor                    0.797    0.731    0.781    0.786
var                    1.040    1.095    1.178    1.161
idm                    0.995    0.987    0.975    0.979
sav                   21.946   21.901   21.821   21.828
sva                  478.992  475.312  468.297  470.245
sen                    0.063    0.106    0.196    0.156
ent                    0.069    0.116    0.220    0.176
dva                    0.016    0.051    0.078    0.069
den                    0.024    0.054    0.090    0.076
f12                    0.674    0.518    0.523    0.555
f13                    0.260    0.279    0.380    0.356</code></pre>
</div>
</div>
</section></section><section id="texture-features" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="texture-features">
<span class="header-section-number">3.2</span> Texture features</h2>
<p>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al.&nbsp;1979)<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Haralick features depend on the configuration of the parameters <code>har_nbins</code> and <code>har_scales</code>. <code>har_nbins</code> controls the number of bins used to compute the Haralick matrix. A smaller <code>har_nbins</code> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <code>har_scales</code> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To change this default, use the argument <code>har_band</code>. For example, <code>har_band = 2</code> will compute the features with the green band.</p>
<p>The following measures are returned (for more details, see <a href="https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html">this post</a>)</p>
<ul>
<li>
<code>asm</code>: The angular second-moment feature.</li>
<li>
<code>con</code>: The contrast feature</li>
<li>
<code>cor</code>: Correlation measures the linear dependency of gray levels of neighboring pixels.</li>
<li>
<code>var</code>: The variance of gray levels pixels.</li>
<li>
<code>idm</code>: The Inverse Difference Moment (IDM), i.e., the local homogeneity.</li>
<li>
<code>sav</code>: The Sum Average.</li>
<li>
<code>sva</code>: The Sum Variance.</li>
<li>
<code>sen</code>: Sum Entropy.</li>
<li>
<code>dva</code>: Difference Variance.</li>
<li>
<code>den</code>: Difference Entropy</li>
<li>
<code>f12</code>: Difference Variance.</li>
<li>
<code>f13</code>: The angular second-moment feature.</li>
</ul></section><section id="single-image-processing" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="single-image-processing">
<span class="header-section-number">3.3</span> Single image processing</h2>
<p>The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leaves_meas</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leaves_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">leaves_meas</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">leaves_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            1       2
id                      1.000   2.000
x                     528.542 234.020
y                     299.984 825.798
area                    5.862   3.879
area_ch                 5.946   4.227
perimeter              12.157   9.942
radius_mean             1.591   1.145
radius_min              0.735   0.838
radius_max              2.683   1.677
radius_sd               0.582   0.219
diam_mean               3.181   2.290
diam_min                1.470   1.675
diam_max                5.366   3.353
major_axis              4.843   2.864
minor_axis              1.563   1.744
length                  5.241   3.210
width                   1.602   1.883
radius_ratio            3.650   2.002
eccentricity            0.136   0.425
theta                  -1.057  -0.087
solidity                0.986   0.918
convexity               0.913   0.791
elongation              0.694   0.413
circularity            25.209  25.478
circularity_haralick    2.735   5.219
circularity_norm        2.021   2.047
coverage                0.104   0.069
asm                     0.044   0.172
con                     1.120   0.495
cor                     0.942   0.814
var                    10.687   2.328
idm                     0.778   0.814
sav                    38.905  28.391
sva                  1449.029 763.014
sen                     1.337   0.856
ent                     1.573   1.002
dva                     1.120   0.495
den                     0.407   0.328
f12                     0.526   0.352
f13                     0.822   0.590</code></pre>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot width and length</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"width"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">leaves_cor</span> , measure <span class="op">=</span> <span class="st">"length"</span>, vjust <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Here, we will count the grains in the <code>grains.jpg</code> image. This image has a cyan background and contains 90 soybeans that touch each other. The <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function segments the image using the normalized blue index by default, as follows <span class="math inline">\(NB =(B /(R + G + B))\)</span>, where <em>R</em>, <em>G</em> and <em>B</em> are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <code>img</code> argument(e.g., <code>img = "grains"</code>).</p>
<p>In this example, objects are counted and segmented objects are colored with random colors using the <code>show_segmentation = TRUE</code> argument. Users can set <code>show_contour = FALSE</code> to remove the contour line and identify the objects (in this example, the grains) using the <code>marker = "id"</code> arguments. The background color can also be changed with <code>col_background</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>img <span class="op">=</span> <span class="st">"grains"</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">count</span><span class="op">$</span><span class="va">statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       stat       value
1         n    90.00000
2  min_area   446.00000
3 mean_area   675.45556
4  max_area   842.00000
5   sd_area    71.65494
6  sum_area 60791.00000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the measurements of the object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            1        2        3        4       5       6
id                      1.000    2.000    3.000    4.000   5.000   6.000
x                     351.890  824.970  811.263  710.004 807.122 818.892
y                     411.183  264.736  198.825  262.800 341.979 714.864
area                  842.000  822.000  738.000  761.000 757.000 742.000
area_ch               810.000  801.000  712.000  733.000 724.000 714.000
perimeter             104.497  107.083   98.497  100.255  98.841  98.841
radius_mean            15.911   15.740   14.876   15.112  15.072  14.906
radius_min             14.847   13.563   14.129   12.886  13.745  13.775
radius_max             16.897   17.782   15.379   17.048  16.714  16.272
radius_sd               0.465    1.201    0.309    1.175   0.771   0.635
diam_mean              31.822   31.480   29.752   30.224  30.144  29.812
diam_min               29.695   27.126   28.258   25.773  27.489  27.550
diam_max               33.793   35.565   30.759   34.097  33.428  32.543
major_axis             33.506   35.775   30.739   34.365  33.056  32.191
minor_axis             32.027   29.288   30.581   28.228  29.186  29.373
length                 33.480   35.413   30.445   33.818  33.005  31.766
width                  32.195   29.731   30.323   27.708  29.399  29.094
radius_ratio            1.138    1.311    1.088    1.323   1.216   1.181
eccentricity            0.938    0.742    0.975    0.749   0.812   0.864
theta                   1.224   -0.327   -1.283   -0.261   0.544  -1.197
solidity                1.040    1.026    1.037    1.038   1.046   1.039
convexity               0.936    0.923    0.904    0.882   0.867   0.886
elongation              0.038    0.160    0.004    0.181   0.109   0.084
circularity            12.969   13.950   13.146   13.208  12.906  13.166
circularity_haralick   34.181   13.107   48.152   12.857  19.539  23.486
circularity_norm        1.092    1.179    1.112    1.117   1.091   1.115
coverage                0.001    0.001    0.001    0.001   0.001   0.001
asm                     0.066    0.080    0.059    0.053   0.065   0.058
con                     0.850    0.975    0.888    0.917   0.855   0.847
cor                     0.912    0.883    0.920    0.911   0.909   0.924
var                     5.837    5.179    6.566    6.166   5.681   6.564
idm                     0.733    0.746    0.706    0.724   0.727   0.720
sav                    32.747   33.476   34.419   33.375  32.003  30.684
sva                  1014.530 1061.010 1121.793 1052.364 967.498 889.380
sen                     1.187    1.145    1.247    1.241   1.187   1.223
ent                     1.418    1.356    1.482    1.478   1.407   1.446
dva                     0.850    0.975    0.888    0.917   0.855   0.847
den                     0.421    0.429    0.428    0.429   0.416   0.419
f12                     0.445    0.445    0.461    0.456   0.447   0.465
f13                     0.745    0.735    0.767    0.763   0.745   0.764</code></pre>
</div>
</div>
<p>In the following example, we will select objects with an area above the average of all objects using <code>lower_size = 675</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Users can also use the <code>topn _*</code> arguments to select the <code>n</code> objects based on the smallest or largest areas. Let’s see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <code>my_index</code> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <code>my_index = "B /(R + G + B)"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="st">"grains"</span>,</span>
<span>                marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                topn_lower <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                col_background <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                index <span class="op">=</span> <span class="st">"B /(R + G + B)"</span><span class="op">)</span> <span class="co"># normalized blue(NB)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Index 'B /(R + G + B)' is not available. Trying to compute your own index.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="batch-processing" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="batch-processing">
<span class="header-section-number">3.4</span> Batch processing</h2>
<p>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in the indirect selection of high-yielding plants. In <code>pliman</code>, batch processing can be done when the user declares the <code>pattern</code> argument.</p>
<p>To speed up processing time, especially for large numbers of images, the <code>parallel = TRUE</code> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <code>R</code> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <code>workers</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processing image img_sb_50_1 |===                                | 8% 00:00:00 
Processing image img_sb_50_10 |=====                             | 15% 00:00:01 
Processing image img_sb_50_11 |========                          | 23% 00:00:01 
Processing image img_sb_50_12 |==========                        | 31% 00:00:02 
Processing image img_sb_50_13 |=============                     | 38% 00:00:02 
Processing image img_sb_50_2 |================                   | 46% 00:00:03 
Processing image img_sb_50_3 |===================                | 54% 00:00:04 
Processing image img_sb_50_4 |======================             | 62% 00:00:05 
Processing image img_sb_50_5 |========================           | 69% 00:00:06 
Processing image img_sb_50_6 |===========================        | 77% 00:00:07 
Processing image img_sb_50_7 |==============================     | 85% 00:00:08 
Processing image img_sb_50_8 |================================   | 92% 00:00:09 
Processing image img_sb_50_9 |===================================| 100% 00:00:09 
--------------------------------------------
        Image Objects
  img_sb_50_1     100
 img_sb_50_10      29
 img_sb_50_11      23
 img_sb_50_12      15
 img_sb_50_13       7
  img_sb_50_2      90
  img_sb_50_3      83
  img_sb_50_4      75
  img_sb_50_5      70
  img_sb_50_6      60
  img_sb_50_7      57
  img_sb_50_8      48
  img_sb_50_9      36
--------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     9.83      0.70     10.53 </code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># parallel processing</span></span>
<span><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">list_res</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img_sb"</span>,</span>
<span>                    show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
        Image Objects
  img_sb_50_1     100
 img_sb_50_10      29
 img_sb_50_11      23
 img_sb_50_12      15
 img_sb_50_13       7
  img_sb_50_2      90
  img_sb_50_3      83
  img_sb_50_4      75
  img_sb_50_5      70
  img_sb_50_6      60
  img_sb_50_7      57
  img_sb_50_8      48
  img_sb_50_9      36
--------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  usuário   sistema decorrido 
     0.06      0.00     14.76 </code></pre>
</div>
</div>
</section></section><section id="object-coordinates" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Object coordinates</h1>
<p>Users can get the coordinates for all desired objects with <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord()</a></code>. When the <code>id</code> argument is set to <code>NULL</code> (default), a bounding rectangle is drawn including all objects. Use <code>id = "all"</code> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <code>watershed = FALSE</code> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"folhas.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the id of each object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_id</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$col_min
[1] 49

$col_max
[1] 937

$row_min
[1] 40

$row_max
[1] 702</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get coordinates for all objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$col_min
[1]  49 710

$col_max
[1] 603 937

$row_min
[1] 379  40

$row_max
[1] 702 425</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span><span class="co"># 20 border pixels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_coord</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>             id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             edge <span class="op">=</span> <span class="fl">20</span>,</span>
<span>             watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/objec2-4.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$col_min
[1] 31

$col_max
[1] 621

$row_min
[1] 361

$row_max
[1] 720</code></pre>
</div>
</div>
</section><section id="isolating-objects" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Isolating objects</h1>
<p>Knowing the coordinates of each object, it is possible to isolate it. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate()</a></code> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_isolate</a></span><span class="op">(</span><span class="va">leaves</span> ,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 edge <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">id1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/object3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="including-objects-in-a-list" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Including objects in a list</h1>
<p><code><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split()</a></code> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/object_split.html">object_split</a></span><span class="op">(</span><span class="va">leaves</span>, watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==============================
Summary of the procedure
==============================
Number of objects: 2 
Average area     : 67935 
Minimum area     : 54096 
Maximum area     : 81774 
Objects created  : 2 
==============================</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ 1:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:330, 1:558, 1:3] 1 1 1 1 1 1 1 1 1 1 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 330 558 3
 $ 2:Formal class 'Image' [package "EBImage"] with 2 slots
  .. ..@ .Data    : num [1:389, 1:232, 1:3] 1 1 1 1 1 1 1 1 1 1 ...
  .. ..@ colormode: int 2
  .. ..$ dim: int [1:3] 389 232 3</code></pre>
</div>
</div>
</section><section id="rgb-values-for-each-object" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> RGB values for each object</h1>
<p>To get the RGB intensity of each object in the image, we use the <code>object_rgb = TRUE</code> argument in the <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> function. In the following example, we will use the R, G and B bands and their normalized values. The <code><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes()</a></code> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g.&nbsp;<code>object_index = "B/G+R"</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"flax.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">indx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "R"     "G"     "B"     "NR"    "NG"    "NB"    "GB"    "RB"    "GR"   
[10] "BI"    "BIM"   "SCI"   "GLI"   "HI"    "NGRDI" "NDGBI" "NDRBI" "I"    
[19] "S"     "VARI"  "HUE"   "HUE2"  "BGI"   "L"     "GRAY"  "GLAI"  "SAT"  
[28] "CI"    "SHP"   "RI"    "G-B"   "G-R"   "R-G"   "R-B"   "B-R"   "B-G"  
[37] "DGCI" </code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flax_leaves</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span> ,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  object_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_file.html">pliman_indexes</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="co"># PCA with the indices</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">flax_leaves</span>, type <span class="op">=</span><span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Columns GB, RB, HI, SHP, RI with infinite/NA values removed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(eigenvalue): NaNs produzidos</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/rgb2-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>R</code> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_pca.html">get_biplot</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">pca_res</span>, show <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Now, let’s plot the <code>DGCI</code> (Dark Green Color Index) on each object. The DGCI is based on the HSB (Hue, Saturation, and Brightness) space color and has been used as an indicator of the darkness of the green color <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span>, measure <span class="op">=</span> <span class="st">"DGCI"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>It seems that leaves with an average DGCI value of less than 0.4 can be considered “Yellowish” leaves. Users can then work with this feature and adapt it to their case.</p>
<div class="cell">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>                index <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>                cut_point <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Columns GB, RB, HI, SHP, RI with infinite/NA values removed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(eigenvalue): NaNs produzidos</code></pre>
</div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">report</span><span class="op">$</span><span class="va">ids</span></span>
<span><span class="va">report</span><span class="op">$</span><span class="va">between_id</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    n nsel      prop mean_index_sel mean_index_nsel
1 156   19 0.1217949      0.3111329        0.594094</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span><span class="op">[</span><span class="va">report</span><span class="op">$</span><span class="va">within_id</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id         x         y n_less n_greater less_ratio greater_ratio
46   46 1211.7940  263.1747   1250       221      0.850         0.150
82   82  213.8652  404.4598    720       200      0.783         0.217
84   84 1016.6994  440.0766   1016         2      0.998         0.002
87   88  808.6027  459.9216    862       312      0.734         0.266
92   93  753.3018  503.7922   1202        50      0.960         0.040
98   99  926.3478  495.3064    791       163      0.829         0.171
103 104 1182.2266  536.9925   1088       105      0.912         0.088
106 107 1327.1343  553.1377    501       157      0.761         0.239
108 109 1215.9287  601.9581   1252       270      0.823         0.177
109 110 1019.2076  594.2668    824        44      0.949         0.051
117 119  740.5159  645.0529    623         6      0.990         0.010
130 132  344.7508  793.9547    463       137      0.772         0.228
135 137  941.9922  788.2445    664        61      0.916         0.084
138 140  381.4860  822.8149   1194       227      0.840         0.160
145 147  244.2355  877.7158   1297         9      0.993         0.007
150 152  696.5520  906.0921   1000         4      0.996         0.004
157 159  703.7492 1031.8150    768        50      0.939         0.061
159  85  966.9768 1051.2005    895        NA         NA            NA
160 117  484.7518 1055.4428    756        NA         NA            NA</code></pre>
</div>
</div>
<p>In the following graph, I plot the distribution of the RGB values “Yellowish” and “Greenish” leaves R, G, and B values.</p>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># distribution of RGB values</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">rgbs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">flax_leaves</span><span class="op">$</span><span class="va">object_rgb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">h</span>, <span class="va">s</span>, <span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span>, <span class="st">"Yellowish"</span>, <span class="st">"Greenish"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">rgbs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">type</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 74 rows containing non-finite values (stat_density).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Now, using the ids of each grain, I plot the values only in the “yello” leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>              id <span class="op">=</span> <span class="va">ids</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">flax_leaves</span> ,</span>
<span>              id <span class="op">=</span> <span class="va">flax_leaves</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="op">!</span><span class="va">flax_leaves</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ids</span><span class="op">]</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When there are many objects, the <code>parallel = TRUE</code> argument will speed up extracting the RGB values. In the following example, an image with 1343 grains of <em>Vicia cracca</em> is analyzed. The indices <code>"R"</code> and <code>"R/G"</code> are computed. Grains with an average red value greater than 0.25 are highlighted.</p>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"vicia.jpg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vicia</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img2</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                  object_index <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_index</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/summary_index.html">summary_index</a></span><span class="op">(</span><span class="va">vicia</span> ,</span>
<span>                index <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>                cut_point <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                select_higher <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">count2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img2</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ids2</span> <span class="op">&lt;-</span> <span class="va">summary_index</span><span class="op">$</span><span class="va">ids</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">count2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="leaf-area" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Leaf area</h1>
<section id="known-resolution" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="known-resolution">
<span class="header-section-number">8.1</span> Known resolution</h2>
<div class="cell">
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">leaves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>image <span class="op">=</span> <span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  index <span class="op">=</span> <span class="st">"B-G"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using images with known resolution</span></span>
<span><span class="va">af_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">af</span>, dpi <span class="op">=</span> <span class="fl">45.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" cyan "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># declaring the measure of a known object</span></span>
<span><span class="va">af_cor2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">af</span>,</span>
<span>               id <span class="op">=</span> <span class="fl">18</span>,</span>
<span>               measure <span class="op">=</span> <span class="va">area</span> <span class="op">~</span> <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------
measures corrected with:
object id: 18
area     : 25
-----------------------------------------
Total    : 796.214 
Average  : 36.192 
-----------------------------------------</code></pre>
</div>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor2</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">35</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="reference-object-dev-version" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="reference-object-dev-version">
<span class="header-section-number">8.2</span> Reference object (dev version)</h2>
<section id="single-images" class="level3" data-number="8.2.1"><h3 data-number="8.2.1" class="anchored" data-anchor-id="single-images">
<span class="header-section-number">8.2.1</span> Single images</h3>
<p>The <code>reference</code> argument can now be used to correct the object measures even when images with different shooting distances are used. This differs from the previous example (declaring the object with the known area) in a subtle, but crucial aspect: when <code>reference</code> is informed, batch processing can be used! In this example, the leaf area of the <code>ref_leaves</code> image is quantified and corrected considering a 5 x 5 (25 cm<span class="math inline">\(^2\)</span>) red square as the reference object. When <code>reference = TRUE</code> is informed in <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code> the function will perform a two-step process of object segmentation; so, the time processing is a bit slower.</p>
<p>The first step consists in segmenting the foreground (leaves and reference object) from the background. To do that, an image index is used and can be declared in the <code>back_fore_index</code>. The default (<code>back_fore_index = "R/(G/B)"</code>) is optimized to segment white backgrounds from green leaves and a blue reference object. Let’s see how this index performs in this example.</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"ref_leaves.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"R/(G/B)"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Index 'R/(G/B)' is not available. Trying to compute your own index.</code></pre>
</div>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"R/(G/B)"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Index 'R/(G/B)' is not available. Trying to compute your own index.</code></pre>
</div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">ind</span>, <span class="va">bin</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>This index definitively is not the better option in this case. Will some other available index be better?</p>
<div class="cell">
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>B-G</code> index seems to be a good candidate.</p>
<div class="cell">
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"B-G"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">seg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">img</span>, index <span class="op">=</span> <span class="st">"B-G"</span>, show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">ind</span>, <span class="va">seg1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Good job! now, we have the background removed. The next step is to segment the objects and the reference template. We basically need to repeat the previous step isolating the reference.</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># see the better index</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_index.html">image_index</a></span><span class="op">(</span><span class="va">seg1</span>, index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The <code>R-G</code> is a good candidate. So, I’ll perform the second segmentation using this index.</p>
<div class="cell">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">seg2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_binary.html">image_binary</a></span><span class="op">(</span><span class="va">seg1</span>,</span>
<span>               index <span class="op">=</span> <span class="st">"R-G"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of pixels in the reference object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">seg2</span><span class="op">$</span><span class="va">`R-G`</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8147</code></pre>
</div>
</div>
<p>Now that we know the indexes to be used for each segmentation, we can use the function <code>analyze_objects</code> to get the corrected measures based on the reference object.</p>
<div class="cell">
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">img</span>, </span>
<span>                  reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  reference_area <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                  back_fore_index <span class="op">=</span> <span class="st">"B-G"</span>,</span>
<span>                  fore_ref_index <span class="op">=</span> <span class="st">"R-G"</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the measures corrected by the image resolution</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">af_cor</span> ,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>,</span>
<span>              col <span class="op">=</span> <span class="st">" cyan "</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="multiple-images" class="level3" data-number="8.2.2"><h3 data-number="8.2.2" class="anchored" data-anchor-id="multiple-images">
<span class="header-section-number">8.2.2</span> Multiple images</h3>
<p>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<code>-</code>) or underscore (<code>_</code>). Then, when using <code><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures()</a></code>, measurements from leaf images called, for example, <code>F1-1.jpeg</code>, <code>F1_2.jpeg</code> and <code>F1-3.jpeg</code> will be combined into a single image (<code>F1</code>), displayed in the <code>merge</code> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</p>
<p>In the following example, 36 images will be analyzed. These images contain flax leaves from 12 evaluation dates, with three replications<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Note that to ensure that all images are processed, all images must share a common pattern, in this case (<code>"A"</code>). Here, I will use the <code>pattern = "A"</code> to indicate that all images with this pattern name should be merged.</p>
<div class="cell">
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                  dir_original <span class="op">=</span> <span class="st">"linhaca"</span>,</span>
<span>                  reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  reference_area <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  filter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Image processing using multiple sessions (6). Please wait.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
     Image Objects
   A1_28_1      18
   A1_28_2      29
   A1_28_3      28
  A10_90_1     149
  A10_90_2     116
  A10_90_3      77
  A11_98_1     133
  A11_98_2     154
  A11_98_3     119
 A12_105_1     111
 A12_105_2     127
 A12_105_3     155
   A2_32_1      24
   A2_32_2      25
   A2_32_3      31
   A3_42_1      39
   A3_42_2      47
   A3_42_3      54
   A4_46_1      57
   A4_46_2      38
   A4_46_3      56
   A5_55_1      53
   A5_55_2      74
   A5_55_3      63
   A6_63_1      68
   A6_63_2     105
   A6_63_3      83
   A7_70_1      98
   A7_70_2     111
   A7_70_3     112
   A8_76_1     113
   A8_76_2     116
   A8_76_3     113
   A9_83_1     119
   A9_83_2      89
   A9_83_3     100
--------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done!</code></pre>
</div>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>merged</code> is a list with three objects:</p>
<ul>
<li>
<code>results</code>: a data frame that contains the measurements of each individual object (in this case, an individual leaf) of each analyzed image.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">results</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1         2         3         4         5        
img                  "A1_28_1" "A1_28_1" "A1_28_1" "A1_28_1" "A1_28_1"
id                   "1"       "2"       "3"       "4"       "5"      
x                    "373.184" "422.529" "163.995" "127.295" "267.451"
y                    "316.718" "320.344" "350.678" "387.751" "400.642"
area                 "0.116"   "0.159"   "0.157"   "0.195"   "0.202"  
area_ch              "0.151"   "0.190"   "0.151"   "0.193"   "0.226"  
perimeter            "2.095"   "2.115"   "1.707"   "2.298"   "2.131"  
radius_mean          "0.249"   "0.262"   "0.230"   "0.302"   "0.263"  
radius_min           "0.010"   "0.065"   "0.117"   "0.099"   "0.116"  
radius_max           "0.478"   "0.453"   "0.368"   "0.517"   "0.430"  
radius_sd            "0.126"   "0.111"   "0.076"   "0.130"   "0.091"  
diam_mean            "0.499"   "0.523"   "0.461"   "0.603"   "0.526"  
diam_min             "0.019"   "0.129"   "0.233"   "0.198"   "0.231"  
diam_max             "0.956"   "0.905"   "0.736"   "1.034"   "0.859"  
major_axis           "0.981"   "0.908"   "0.727"   "1.046"   "0.838"  
minor_axis           "0.221"   "0.264"   "0.281"   "0.243"   "0.341"  
length               "0.909"   "0.872"   "0.723"   "1.025"   "0.802"  
width                "0.233"   "0.310"   "0.283"   "0.238"   "0.427"  
radius_ratio         "49.553"  " 7.015"  " 3.155"  " 5.228"  " 3.716" 
eccentricity         "0.070"   "0.117"   "0.220"   "0.080"   "0.250"  
theta                "-1.485"  " 1.345"  " 0.064"  "-0.582"  "-1.202" 
solidity             "0.768"   "0.836"   "1.042"   "1.010"   "0.893"  
convexity            "0.552"   "0.554"   "0.916"   "0.915"   "0.743"  
elongation           "0.744"   "0.645"   "0.609"   "0.768"   "0.468"  
circularity          "37.928"  "28.087"  "18.532"  "27.089"  "22.494" 
circularity_haralick "1.985"   "2.361"   "3.026"   "2.316"   "2.901"  
circularity_norm     "3.495"   "2.486"   "1.608"   "2.347"   "1.939"  
coverage             "0.001"   "0.002"   "0.002"   "0.002"   "0.002"  
asm                  "0.083"   "0.132"   "0.214"   "0.161"   "0.136"  
con                  "2.799"   "2.712"   "1.913"   "2.177"   "2.307"  
cor                  "0.658"   "0.500"   "0.494"   "0.578"   "0.679"  
var                  "5.087"   "3.714"   "2.889"   "3.581"   "4.597"  
idm                  "0.660"   "0.736"   "0.799"   "0.743"   "0.739"  
sav                  " 9.204"  " 8.431"  "10.223"  "10.163"  "11.343" 
sva                  " 79.651" " 64.489" " 94.518" " 93.948" "119.774"
sen                  "1.073"   "0.924"   "0.795"   "0.900"   "0.965"  
ent                  "1.466"   "1.196"   "0.993"   "1.135"   "1.242"  
dva                  "2.799"   "2.712"   "1.913"   "2.177"   "2.307"  
den                  "0.586"   "0.503"   "0.429"   "0.498"   "0.499"  
f12                  "0.246"   "0.242"   "0.263"   "0.235"   "0.270"  
f13                  "0.580"   "0.529"   "0.509"   "0.511"   "0.567"  </code></pre>
</div>
</div>
<ul>
<li>
<code>summary</code> : a data frame that contains the summary of the results, containing the number of objects in each image (<code>n</code>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">summary</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1            2            3            4            
img                  "imgA1_28_1" "imgA1_28_2" "imgA1_28_3" "imgA10_90_1"
n                    " 18"        " 29"        " 28"        "149"        
area_sum             "  2.571"    "  6.294"    "  7.048"    "172.420"    
area_mean            "0.143"      "0.217"      "0.252"      "1.157"      
area_sd              "0.058"      "0.075"      "0.095"      "0.441"      
area_ch              "0.163"      "0.219"      "0.274"      "1.217"      
perimeter            "2.005"      "2.717"      "2.715"      "6.558"      
radius_mean          "0.248"      "0.343"      "0.338"      "0.812"      
radius_min           "0.076"      "0.079"      "0.107"      "0.187"      
radius_max           "0.434"      "0.625"      "0.602"      "1.511"      
radius_sd            "0.106"      "0.165"      "0.148"      "0.402"      
diam_mean            "0.497"      "0.685"      "0.677"      "1.625"      
diam_min             "0.152"      "0.158"      "0.214"      "0.374"      
diam_max             "0.869"      "1.251"      "1.204"      "3.023"      
major_axis           "0.872"      "1.278"      "1.188"      "3.070"      
minor_axis           "0.250"      "0.225"      "0.294"      "0.511"      
length               "0.837"      "1.232"      "1.176"      "2.978"      
width                "0.263"      "0.228"      "0.301"      "0.517"      
radius_ratio         " 8.777"     "10.306"     " 5.729"     " 9.602"     
eccentricity         "0.132"      "0.052"      "0.096"      "0.044"      
theta                " 0.011"     "-0.105"     " 0.261"     " 0.070"     
solidity             "0.954"      "0.987"      "0.988"      "1.018"      
convexity            "0.769"      "0.773"      "0.850"      "0.858"      
elongation           "0.690"      "0.813"      "0.747"      "0.830"      
circularity          "30.133"     "36.250"     "29.783"     "38.436"     
circularity_haralick "2.391"      "2.090"      "2.320"      "2.025"      
circularity_norm     "2.725"      "3.221"      "2.547"      "3.410"      
coverage             "0.001"      "0.001"      "0.001"      "0.001"      
asm                  "0.141"      "0.165"      "0.144"      "0.208"      
con                  "2.407"      "2.376"      "2.175"      "2.664"      
cor                  "0.547"      "0.564"      "0.579"      "0.361"      
var                  "3.784"      "3.829"      "3.795"      "3.346"      
idm                  "0.711"      "0.717"      "0.730"      "0.737"      
sav                  "11.336"     "11.796"     "11.258"     " 9.961"     
sva                  "120.987"    "130.715"    "117.729"    " 99.047"    
sen                  "0.935"      "0.915"      "0.924"      "0.820"      
ent                  "1.240"      "1.210"      "1.197"      "1.088"      
dva                  "2.407"      "2.376"      "2.175"      "2.664"      
den                  "0.518"      "0.519"      "0.495"      "0.499"      
f12                  "0.228"      "0.220"      "0.225"      "0.166"      
f13                  "0.512"      "0.501"      "0.506"      "0.416"      
                     5            
img                  "imgA10_90_2"
n                    "116"        
area_sum             "119.335"    
area_mean            "1.029"      
area_sd              "0.338"      
area_ch              "1.136"      
perimeter            "6.390"      
radius_mean          "0.780"      
radius_min           "0.164"      
radius_max           "1.466"      
radius_sd            "0.392"      
diam_mean            "1.559"      
diam_min             "0.329"      
diam_max             "2.932"      
major_axis           "2.997"      
minor_axis           "0.497"      
length               "2.881"      
width                "0.505"      
radius_ratio         "10.337"     
eccentricity         "0.047"      
theta                " 0.037"     
solidity             "0.995"      
convexity            "0.855"      
elongation           "0.825"      
circularity          "40.106"     
circularity_haralick "2.009"      
circularity_norm     "3.593"      
coverage             "0.001"      
asm                  "0.180"      
con                  "2.563"      
cor                  "0.327"      
var                  "3.034"      
idm                  "0.723"      
sav                  " 9.046"     
sva                  " 75.195"    
sen                  "0.824"      
ent                  "1.104"      
dva                  "2.563"      
den                  "0.510"      
f12                  "0.146"      
f13                  "0.395"      </code></pre>
</div>
</div>
<p>The <code>area_sum</code> of img <code>A1_28_1</code> is the sum of the 18 leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">merged</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.57</code></pre>
</div>
</div>
<ul>
<li>
<code>merge</code>: a data frame that contains the results merged by image prefix (In this case, A1 to A12).</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">merged</span><span class="op">$</span><span class="va">merge</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     1         2         3         4         5        
img                  "imgA1"   "imgA10"  "imgA11"  "imgA12"  "imgA2"  
n                    " 75"     "342"     "406"     "393"     " 80"    
area_sum             " 15.913" "364.917" "479.003" "370.213" " 21.485"
area_mean            "0.204"   "1.045"   "1.205"   "0.961"   "0.269"  
area_sd              "0.076"   "0.296"   "0.447"   "0.341"   "0.120"  
area_ch              "0.218"   "1.098"   "1.256"   "0.991"   "0.305"  
perimeter            "2.479"   "6.578"   "6.773"   "6.175"   "2.836"  
radius_mean          "0.310"   "0.807"   "0.832"   "0.761"   "0.351"  
radius_min           "0.087"   "0.163"   "0.186"   "0.155"   "0.097"  
radius_max           "0.554"   "1.522"   "1.556"   "1.429"   "0.626"  
radius_sd            "0.140"   "0.410"   "0.414"   "0.385"   "0.157"  
diam_mean            "0.620"   "1.614"   "1.663"   "1.523"   "0.702"  
diam_min             "0.175"   "0.327"   "0.372"   "0.309"   "0.194"  
diam_max             "1.108"   "3.044"   "3.111"   "2.857"   "1.253"  
major_axis           "1.113"   "3.108"   "3.149"   "2.948"   "1.253"  
minor_axis           "0.256"   "0.464"   "0.509"   "0.431"   "0.304"  
length               "1.082"   "3.003"   "3.071"   "2.819"   "1.218"  
width                "0.264"   "0.468"   "0.515"   "0.432"   "0.321"  
radius_ratio         " 8.271"  "10.634"  "10.306"  " 9.934"  "10.012" 
eccentricity         "0.093"   "0.038"   "0.047"   "0.041"   "0.102"  
theta                "0.055"   "0.026"   "0.102"   "0.197"   "0.090"  
solidity             "0.976"   "1.009"   "1.004"   "1.008"   "0.969"  
convexity            "0.797"   "0.853"   "0.840"   "0.834"   "0.831"  
elongation           "0.750"   "0.844"   "0.831"   "0.841"   "0.733"  
circularity          "32.055"  "42.404"  "40.067"  "40.807"  "30.634" 
circularity_haralick "2.267"   "1.979"   "2.020"   "1.998"   "2.307"  
circularity_norm     "2.831"   "3.777"   "3.531"   "3.618"   "2.642"  
coverage             "0.001"   "0.001"   "0.001"   "0.001"   "0.002"  
asm                  "0.150"   "0.170"   "0.156"   "0.134"   "0.150"  
con                  "2.320"   "2.464"   "2.395"   "2.643"   "2.646"  
cor                  "0.563"   "0.394"   "0.504"   "0.546"   "0.543"  
var                  "3.803"   "3.213"   "3.635"   "4.226"   "4.120"  
idm                  "0.719"   "0.718"   "0.720"   "0.691"   "0.724"  
sav                  "11.463"  " 9.342"  " 9.938"  "11.514"  "10.155" 
sva                  "123.144" " 85.159" "104.154" "125.472" " 98.704"
sen                  "0.924"   "0.856"   "0.901"   "0.949"   "0.927"  
ent                  "1.216"   "1.142"   "1.183"   "1.272"   "1.207"  
dva                  "2.320"   "2.464"   "2.395"   "2.643"   "2.646"  
den                  "0.510"   "0.510"   "0.508"   "0.543"   "0.511"  
f12                  "0.224"   "0.164"   "0.201"   "0.196"   "0.222"  
f13                  "0.506"   "0.422"   "0.473"   "0.484"   "0.505"  </code></pre>
</div>
</div>
<p>Below, I will fit a non-linear model (Logistic) to model the leaf area evolution across the crop cycle.</p>
<div>
<details><summary>Code</summary><div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">merged</span><span class="op">$</span><span class="va">summary</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/separate_col.html">separate_col</a></span><span class="op">(</span><span class="va">img</span>, </span>
<span>               into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"avaliacao"</span>, <span class="st">"das"</span>, <span class="st">"bloco"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>das <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">das</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot </span></span>
<span></span>
<span><span class="va">my_theme</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># leaf area</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">das</span>, <span class="va">area_sum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">248</span>,</span>
<span>                                           b2 <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                           b3 <span class="op">=</span> <span class="fl">0.07</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">$</span><span class="va">das</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days after sowing"</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Área</span><span class="op">~</span><span class="va">foliar</span><span class="op">~</span><span class="va">média</span><span class="op">~</span><span class="op">(</span><span class="va">cm</span><span class="op">^</span><span class="fl">2</span><span class="op">~</span><span class="va">planta</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span>
<span><span class="co"># number of leaves</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">das</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">188</span>,</span>
<span>                                           b2 <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                           b3 <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">$</span><span class="va">das</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Days after sowing"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of leaves per plant"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="03_analyze_files/figure-html/merge9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="03_analyze_files/figure-html/merge9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section></section><section id="filling-holes" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="filling-holes">
<span class="header-section-number">8.3</span> Filling ‘holes’</h2>
<p>An important aspect to consider in leaf area measures is when leaves present ‘holes’. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</p>
<div class="cell">
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"holes.jpg"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>In this case, the missing area will not be computed using the default settings of <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>. To include this area as the leaf area, we can use the argument <code>fill_hull()</code>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</p>
<div class="cell">
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">af</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fill the missing area</span></span>
<span><span class="va">af2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">holes</span>,</span>
<span>                  fill_hull <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  col_background <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>                  marker_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                  marker_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  show_image <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  save_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  prefix <span class="op">=</span> <span class="st">"proc2_"</span>,</span>
<span>                  dir_processed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"proc"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We can simply use the ratio between <code>proc_img</code> and <code>proc_img2</code> to compute the injured area in this leaflet.</p>
<div class="cell">
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># percent of the injured area</span></span>
<span><span class="fl">100</span> <span class="op">-</span> <span class="fl">86432</span> <span class="op">/</span> <span class="fl">99186</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.85867</code></pre>
</div>
</div>
</section><section id="compound-leaves" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="compound-leaves">
<span class="header-section-number">8.4</span> Compound leaves</h2>
<p>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <code><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects()</a></code>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</p>
<p>The following images by <a href="https://www.florestaombrofilamista.com.br/sidol/?menu=contact">Daniel Saueressig</a> were obtained from the <em>Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista</em><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> and show examples of simple and compound leaves.</p>
<div class="cell">
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imgs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_horizontal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc1-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm<span class="math inline">\(^2\)</span>. With this information, it is possible to obtain the image resolution with <code>dpi(simple)</code>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</p>
<div class="cell">
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simple</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">simple.jpg</span></span>
<span><span class="va">sarea</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <code>object_size = "large"</code> or <code>watershed = FALSE</code>, to omit the watershed segmentation algorithm. The last is used here.</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">simple</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  contour_size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc3-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sarea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">sarea</span>, dpi <span class="op">=</span> <span class="fl">48.65</span><span class="op">)</span></span>
<span><span class="va">sarea_cor</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           2       3
id                     2.000   3.000
x                    183.241 178.843
y                     68.637 184.643
area                  20.035  41.417
area_ch               31.852  56.267
perimeter             31.560  41.287
radius_mean            3.030   4.285
radius_min             1.095   1.070
radius_max             5.717   7.953
radius_sd              1.215   1.801
diam_mean              6.060   8.570
diam_min               2.190   2.139
diam_max              11.433  15.906
major_axis             9.237  13.661
minor_axis             3.194   4.225
length                11.068  15.474
width                  4.698   6.041
radius_ratio           5.220   7.435
eccentricity           0.147   0.133
theta                 -0.018  -0.082
solidity               0.629   0.736
convexity              0.779   0.675
elongation             0.576   0.610
circularity           49.715  41.157
circularity_haralick   2.493   2.379
circularity_norm       4.106   3.353
coverage               0.088   0.182
asm                    0.048   0.043
con                    3.761   1.671
cor                    0.811   0.845
var                   10.970   6.401
idm                    0.647   0.663
sav                   22.952  23.134
sva                  507.260 499.010
sen                    1.246   1.246
ent                    1.663   1.618
dva                    3.761   1.671
den                    0.603   0.516
f12                    0.287   0.319
f13                    0.654   0.677</code></pre>
</div>
</div>
<p>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</p>
<div class="cell">
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">compound</span> <span class="op">&lt;-</span> <span class="va">imgs</span><span class="op">$</span><span class="va">compound.jpg</span></span>
<span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc4-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Therefore, using <code>watershed = FALSE</code> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</p>
<div class="cell">
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">compound</span>,</span>
<span>                  watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_segmentation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  show_contour <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  show_chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/sc5-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">carea_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">carea</span>, dpi <span class="op">=</span> <span class="fl">49.5</span><span class="op">)</span></span>
<span><span class="va">carea_cor</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           3       4
id                     3.000   4.000
x                     90.218 243.787
y                    113.124 114.593
area                  18.895  15.890
area_ch               43.161  33.168
perimeter             54.501  48.779
radius_mean            2.548   2.254
radius_min             0.056   0.018
radius_max             5.940   4.964
radius_sd              1.260   1.148
diam_mean              5.097   4.509
diam_min               0.112   0.035
diam_max              11.879   9.929
major_axis             8.404   6.954
minor_axis             6.577   5.552
length                 9.339   8.135
width                  7.142   6.435
radius_ratio         105.791 280.481
eccentricity           0.656   0.506
theta                 -0.862   1.308
solidity               0.438   0.479
convexity              0.383   0.412
elongation             0.235   0.209
circularity          157.203 149.739
circularity_haralick   2.023   1.964
circularity_norm      13.363  12.783
coverage               0.086   0.072
asm                    0.054   0.047
con                    1.100   2.223
cor                    0.838   0.753
var                    4.386   5.507
idm                    0.711   0.666
sav                   18.751  27.342
sva                  322.551 700.322
sen                    1.141   1.179
ent                    1.448   1.559
dva                    1.100   2.223
den                    0.456   0.543
f12                    0.328   0.279
f13                    0.658   0.630</code></pre>
</div>
</div>
</section></section><section id="shapefiles" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> Shapefiles</h1>
<p>Orthomosaic kindly provided by Prof.&nbsp;Dr.&nbsp;<a href="https://www.researchgate.net/profile/Ivan-Carvalho-4">Ivan Ricardo Carvalho</a> (UNIJUÍ)</p>
<div class="cell">
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"mosaic.tif"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># aligned &lt;- image_align(shp)</span></span>
<span><span class="va">aligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_rotate</a></span><span class="op">(</span><span class="va">shp</span>, angle <span class="op">=</span> <span class="fl">82.591</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cropped &lt;- image_crop(aligned, plot = TRUE)</span></span>
<span><span class="va">cropped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_transform.html">image_crop</a></span><span class="op">(</span><span class="va">aligned</span>,</span>
<span>                      width <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">3953</span>,</span>
<span>                      height <span class="op">=</span> <span class="fl">1350</span><span class="op">:</span><span class="fl">1625</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">anal</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/analyze_objects_shp.html">analyze_objects_shp</a></span><span class="op">(</span><span class="va">cropped</span>,</span>
<span>                      cols <span class="op">=</span> <span class="fl">26</span>,</span>
<span>                      index <span class="op">=</span> <span class="st">"HUE"</span>,</span>
<span>                      object_index <span class="op">=</span> <span class="st">"DGCI"</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cropped</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anal</span><span class="op">$</span><span class="va">shapefiles</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">anal</span>, measure <span class="op">=</span> <span class="st">"DGCI"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-55-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="fourier-analyses" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> Fourier analyses</h1>
<section id="functions" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="functions">
<span class="header-section-number">10.1</span> Functions</h2>
<p>The functions were adapted from Claude (2088)<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="cell">
<details><summary>Show functions</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Core function for elliptical Fourier analyses</span></span>
<span><span class="co"># Elliptical Fourier transform (and its normalization)</span></span>
<span><span class="co"># adapted from https://momx.github.io/Momocs/reference/fourier.html</span></span>
<span><span class="va">fourier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nhm</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">coo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_check</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon.html">poly_unclose</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coo</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">nhm</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">&gt;</span> <span class="va">nr</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">nhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">nr</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">.is_verbose</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"'nhm' must be lower than half the number of points, and has been set to "</span>, <span class="va">nhm</span>, <span class="st">"harmonics"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">nhm</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">nhm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">nr</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">.is_verbose</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"the number of harmonics used has been set to: "</span>, <span class="va">nhm</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">Dx</span> <span class="op">&lt;-</span> <span class="va">coo</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">coo</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">nr</span>, <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">nr</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">Dy</span> <span class="op">&lt;-</span> <span class="va">coo</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">coo</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">nr</span>, <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">nr</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">Dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Dx</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">Dy</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">Dt</span><span class="op">[</span><span class="va">Dt</span> <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1e-10</span>  <span class="co"># to avoid Nan</span></span>
<span>  <span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Dt</span><span class="op">)</span></span>
<span>  <span class="va">t1m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">t1</span><span class="op">[</span><span class="op">-</span><span class="va">nr</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Dt</span><span class="op">)</span></span>
<span>  <span class="va">an</span> <span class="op">&lt;-</span> <span class="va">bn</span> <span class="op">&lt;-</span> <span class="va">cn</span> <span class="op">&lt;-</span> <span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">nhm</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nhm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ti</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="cn">T</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">i</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">i</span> <span class="op">*</span> <span class="va">pi</span></span>
<span>    <span class="va">an</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Ti</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dx</span><span class="op">/</span><span class="va">Dt</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1m1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">bn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Ti</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dx</span><span class="op">/</span><span class="va">Dt</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1m1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">cn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Ti</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dy</span><span class="op">/</span><span class="va">Dt</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1m1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Ti</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dy</span><span class="op">/</span><span class="va">Dt</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">r</span> <span class="op">*</span> <span class="va">t1m1</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">ao</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">coo</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Dt</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">co</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">coo</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">Dt</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>an <span class="op">=</span> <span class="va">an</span>, bn <span class="op">=</span> <span class="va">bn</span>, cn <span class="op">=</span> <span class="va">cn</span>, dn <span class="op">=</span> <span class="va">dn</span>, ao <span class="op">=</span> <span class="va">ao</span>,</span>
<span>              co <span class="op">=</span> <span class="va">co</span>,</span>
<span>              nr <span class="op">=</span> <span class="va">nr</span>,</span>
<span>              coords <span class="op">=</span> <span class="va">coo</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Normalized coefficients</span></span>
<span><span class="va">fourier_norm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ef</span>, <span class="va">start</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">A1</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">an</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">B1</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">bn</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">C1</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">cn</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">D1</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">dn</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">nhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ef</span><span class="op">$</span><span class="va">an</span><span class="op">)</span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">A1</span> <span class="op">*</span> <span class="va">B1</span> <span class="op">+</span> <span class="va">C1</span> <span class="op">*</span> <span class="va">D1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">A1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">C1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span></span>
<span>                                                 <span class="va">B1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">D1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="va">pi</span></span>
<span>  <span class="va">phaseshift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A1</span>, <span class="va">C1</span>, <span class="va">B1</span>, <span class="va">D1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">phaseshift</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">M2</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">v</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">+</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">theta</span> <span class="op">+</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="va">pi</span> <span class="op">-</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="va">Aa</span> <span class="op">&lt;-</span> <span class="va">A1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">+</span> <span class="va">B1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="va">Cc</span> <span class="op">&lt;-</span> <span class="va">C1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">+</span> <span class="va">D1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="va">scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Aa</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">Cc</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Cc</span><span class="op">/</span><span class="va">Aa</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="va">pi</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">Aa</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">psi</span> <span class="op">&lt;-</span> <span class="va">psi</span> <span class="op">+</span> <span class="va">pi</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">scale</span></span>
<span>  <span class="va">rotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">A</span> <span class="op">&lt;-</span> <span class="va">B</span> <span class="op">&lt;-</span> <span class="va">C</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">nhm</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">start</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nhm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">size</span> <span class="op">*</span> <span class="va">rotation</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ef</span><span class="op">$</span><span class="va">an</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ef</span><span class="op">$</span><span class="va">cn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>               <span class="va">ef</span><span class="op">$</span><span class="va">bn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ef</span><span class="op">$</span><span class="va">dn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span>,</span>
<span>               <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">A</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">B</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">C</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">D</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">lnef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">B</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">C</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">D</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">B</span>, C <span class="op">=</span> <span class="va">C</span>, D <span class="op">=</span> <span class="va">D</span>, size <span class="op">=</span> <span class="va">scale</span>, theta <span class="op">=</span> <span class="va">theta</span>,</span>
<span>       psi <span class="op">=</span> <span class="va">psi</span>, ao <span class="op">=</span> <span class="va">ef</span><span class="op">$</span><span class="va">ao</span>, co <span class="op">=</span> <span class="va">ef</span><span class="op">$</span><span class="va">co</span>, lnef <span class="op">=</span> <span class="va">lnef</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># inverse fourier</span></span>
<span><span class="va">fourier_inv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ef</span>, <span class="va">nhm</span>, <span class="va">nb.pts</span> <span class="op">=</span> <span class="fl">120</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">ef</span><span class="op">$</span><span class="va">ao</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ef</span><span class="op">$</span><span class="va">ao</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">ef</span><span class="op">$</span><span class="va">co</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ef</span><span class="op">$</span><span class="va">co</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">an</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">an</span></span>
<span>  <span class="va">bn</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">bn</span></span>
<span>  <span class="va">cn</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">cn</span></span>
<span>  <span class="va">dn</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">dn</span></span>
<span>  <span class="va">ao</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">ao</span></span>
<span>  <span class="va">co</span> <span class="op">&lt;-</span> <span class="va">ef</span><span class="op">$</span><span class="va">co</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">nhm</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">nhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">an</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, length <span class="op">=</span> <span class="va">nb.pts</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="va">nb.pts</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">hx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nhm</span>, <span class="va">nb.pts</span><span class="op">)</span></span>
<span>  <span class="va">hy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nhm</span>, <span class="va">nb.pts</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nhm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">hx</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">an</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span> <span class="op">+</span> <span class="va">bn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span></span>
<span>    <span class="va">hy</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span> <span class="op">+</span> <span class="va">dn</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">i</span> <span class="op">*</span> <span class="va">theta</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ao</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">hx</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">co</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">hy</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span></span>
<span>  <span class="va">coo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">coo</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">coo</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="elliptical-fourier" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="elliptical-fourier">
<span class="header-section-number">10.2</span> Elliptical fourier</h2>
<div class="cell">
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"img"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ind"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">conts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">imgs</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">fourier</span><span class="op">(</span><span class="va">conts</span><span class="op">$</span><span class="va">ind1</span><span class="op">$</span><span class="va">`2`</span>, nhm <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">$</span><span class="va">ind1</span><span class="op">)</span></span>
<span><span class="co"># 10 harmônicas</span></span>
<span><span class="va">d_i</span> <span class="op">&lt;-</span> <span class="fu">fourier_inv</span><span class="op">(</span><span class="va">d</span>, <span class="fl">10</span>, nb.pts <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">d_i</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># 20 harmônicas</span></span>
<span><span class="va">d_i</span> <span class="op">&lt;-</span> <span class="fu">fourier_inv</span><span class="op">(</span><span class="va">d</span>, <span class="fl">20</span>, nb.pts <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">d_i</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="co"># 40 harmônicas</span></span>
<span><span class="va">d_i</span> <span class="op">&lt;-</span> <span class="fu">fourier_inv</span><span class="op">(</span><span class="va">d</span>, <span class="fl">80</span>, nb.pts <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_contour</a></span><span class="op">(</span><span class="va">d_i</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="rotation-and-size" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="rotation-and-size">
<span class="header-section-number">10.3</span> Rotation and size</h2>
<div class="cell">
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/pliman">pliman</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"changes.png"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">fourier</span><span class="op">(</span><span class="va">cont</span><span class="op">$</span><span class="va">`1`</span>, nhm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">fourier</span><span class="op">(</span><span class="va">cont</span><span class="op">$</span><span class="va">`2`</span>, nhm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">fourier</span><span class="op">(</span><span class="va">cont</span><span class="op">$</span><span class="va">`3`</span>, nhm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">f1</span><span class="op">$</span><span class="va">an</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.0989673  0.3642945  2.3491815 -1.3170290 -1.0623448</code></pre>
</div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f2</span><span class="op">$</span><span class="va">an</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 167.329018  45.411721 -47.133350  12.902906  -8.440965</code></pre>
</div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f3</span><span class="op">$</span><span class="va">an</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6.5592562  0.3521776  1.2573074 -0.6858838 -0.5661625</code></pre>
</div>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f1n</span> <span class="op">&lt;-</span> <span class="fu">fourier_norm</span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span>
<span><span class="va">f2n</span> <span class="op">&lt;-</span> <span class="fu">fourier_norm</span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span>
<span><span class="va">f3n</span> <span class="op">&lt;-</span> <span class="fu">fourier_norm</span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span>
<span><span class="va">f1n</span><span class="op">$</span><span class="va">A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.000000000 -0.020752286 -0.001967149 -0.022437848 -0.010519230</code></pre>
</div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f2n</span><span class="op">$</span><span class="va">A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.000000000  0.053474289  0.005280597  0.038000242  0.011862582</code></pre>
</div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f3n</span><span class="op">$</span><span class="va">A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.000000000 -0.013163949 -0.002955584 -0.017501282 -0.012917222</code></pre>
</div>
</div>
</section><section id="morphological-diversity" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="morphological-diversity">
<span class="header-section-number">10.4</span> Morphological diversity</h2>
<div class="cell">
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">conts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">imgs</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">conts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">fourier</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, nhm <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fourier_norm</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">an</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">eff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"A"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">eff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"B"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">eff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"C"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">eff</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">an</span>, <span class="va">bn</span>, <span class="va">cn</span>, <span class="va">dn</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span>specie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"specie"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'factoextra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:metan':

    get_dist</code></pre>
</div>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'FactoMineR' was built under R version 4.2.1</code></pre>
</div>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">coefs</span>, quali.sup <span class="op">=</span> <span class="fl">61</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">pca</span>, habillage <span class="op">=</span> <span class="fl">61</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/image_combine.html">image_combine</a></span><span class="op">(</span><span class="va">imgs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section></section><section id="distance-to-an-ideotype" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> Distance to an ideotype</h1>
<section id="cluster-objects" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="cluster-objects">
<span class="header-section-number">11.1</span> Cluster objects</h2>
<div class="cell">
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"distance.png"</span>, path <span class="op">=</span> <span class="st">"fourier"</span><span class="op">)</span></span>
<span><span class="va">cont</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_objects.html">object_contour</a></span><span class="op">(</span><span class="va">img</span>,</span>
<span>                 index <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                 watershed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 show_image <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pliman/man/utils_polygon_plot.html">plot_polygon</a></span><span class="op">(</span><span class="va">cont</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dfour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">cont</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">fourier</span><span class="op">(</span><span class="va">x</span>, nhm <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">fourier_norm</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">an</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dfour</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"A"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dfour</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"B"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dfour</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"C"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dfour</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">an</span>, <span class="va">bn</span>, <span class="va">cn</span>, <span class="va">dn</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sites.google.com/site/malikacharrad/research/nbclust-package">NbClust</a></span><span class="op">)</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">coefs</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">pca</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># distance</span></span>
<span><span class="va">distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">fviz_dend</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
"none")` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_analyze_files/figure-html/unnamed-chunk-60-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section><section id="distance-to-an-ideotype-1" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="distance-to-an-ideotype-1">
<span class="header-section-number">11.2</span> Distance to an ideotype</h2>
<div class="cell">
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">desc_ide</span> <span class="op">&lt;-</span> <span class="va">coefs</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">desc_objs</span> <span class="op">&lt;-</span> <span class="va">coefs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># compute the differences between each object and the ideotype</span></span>
<span><span class="va">gen_ide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">desc_objs</span>, <span class="fl">2</span>, <span class="va">desc_ide</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">distances</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">gen_ide</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/pliman/man/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">distances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          2           6           3           5           4 
0.002405437 0.130426948 2.332612482 2.429309481 2.458666804 </code></pre>
</div>
</div>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1" role="doc-endnote"><p>Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019–1028. doi: 10.1016/0031-3203(93)90003-F.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed.&nbsp;World Scientific.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Claude, J. 2008. Morphometrics with R. Springer.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Lee, Y., and W. Lim. 2017. Shoelace Formula: Connecting the Area of a Polygon and the Vector Cross Product. The Mathematics Teacher 110(8): 631–636. doi: 10.5951/MATHTEACHER.110.8.0631.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305–1335<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394–396. doi: 10.1109/TSMC.1974.5408463.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610–621. doi: 10.1109/TSMC.1973.4309314<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>Karcher, D.E., and M.D.&nbsp;Richardson. 2003. Quantifying Turfgrass Color Using Digital Image Analysis. Crop Science 43(3): 943–951. doi: 10.2135/cropsci2003.9430<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>The images come from an experiment evaluating flax cultivars at the Universidade Federal de Santa Catarina - UFSC<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p>https://www.florestaombrofilamista.com.br/sidol/?menu=glossary<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12" role="doc-endnote"><p>Claude, J. 2008. Morphometrics with R. Springer.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02_segment.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Segment objects</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_phytopathometry.html" class="pagination-link">
        <span class="nav-page-text">Phytopathometry</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb212" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analyze objects"</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include = FALSE}</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Directory</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"E:/Desktop/UFSC/cursos/pliman_tut/imgs"</span>)</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Working with polygons</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A 'polygon' is a plane figure that is described by a finite number of straight line segments connected to form a closed polygonal chain (Singer, 1993)</span><span class="ot">[^1]</span><span class="at">.</span></span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Singer, M.H. 1993. A general approach to moment calculation for polygons and line segments. Pattern Recognition 26(7): 1019--1028. doi: 10.1016/0031-3203(93)90003-F.</span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>We can then conclude that image objects can be expressed as polygons with <span class="in">`n`</span> vertices. <span class="in">`pliman`</span> has a set of functions(<span class="in">`draw_*()`</span>) useful for drawing common shapes like circles, squares, triangles, rectangles and <span class="in">`n`</span>- tagons . Another group of <span class="in">`poly_*()`</span> functions can be used to analyze polygons. Let's start with a simple example related to the area and perimeter of a square.</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">draw_square</span>(<span class="at">side =</span> <span class="dv">2</span>)</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(square)</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(square)</span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>Now, let's see what happens when we start with a hexagon and increase the number of sides up to 1000.</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span> </span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">side6 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">6</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">side12 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">8</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">side24 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">12</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">50</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">side500 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">100</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">side100 =</span> <span class="fu">draw_n_tagon</span>(<span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>))</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(shapes, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(shapes)</span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(shapes)</span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>Note that when $n \to \infty$, the sum of the sides becomes the circumference of the circle, given by $2 \pi r$, and the area becomes $\pi r^2$. This is fun, but <span class="in">`pliman`</span> is primarily designed for analyzing plant image analysis. So why use polygons? Let's see how we can use these functions to get applicable information.</span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-64"><a href="#cb212-64" aria-hidden="true" tabindex="-1"></a><span class="co"># getting the outline of objects</span></span>
<span id="cb212-65"><a href="#cb212-65" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb212-66"><a href="#cb212-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(leaves,</span>
<span id="cb212-67"><a href="#cb212-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B-R"</span>,</span>
<span id="cb212-68"><a href="#cb212-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-69"><a href="#cb212-69" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the polygon</span></span>
<span id="cb212-70"><a href="#cb212-70" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb212-71"><a href="#cb212-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-72"><a href="#cb212-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-73"><a href="#cb212-73" aria-hidden="true" tabindex="-1"></a>Nice! We can use the contours of any object to get useful information related to its shape. To reduce the amount of output, I will only use five samples: 1, 2, 12, and 23.</span>
<span id="cb212-74"><a href="#cb212-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-77"><a href="#cb212-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-78"><a href="#cb212-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-79"><a href="#cb212-79" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> cont[<span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"12"</span>, <span class="st">"23"</span>)]</span>
<span id="cb212-80"><a href="#cb212-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont)</span>
<span id="cb212-81"><a href="#cb212-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-82"><a href="#cb212-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-83"><a href="#cb212-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-84"><a href="#cb212-84" aria-hidden="true" tabindex="-1"></a>In the current version of <span class="in">`pliman`</span>, you can calculate the following measurements. For more details, see Chen &amp; Wang (2005)<span class="ot">[^2]</span>, Claude (2008)<span class="ot">[^3]</span>, and Montero et al. (2009)<span class="ot">[^4]</span>.</span>
<span id="cb212-85"><a href="#cb212-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-86"><a href="#cb212-86" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Chen, C.H., and P.S.P. Wang. 2005. Handbook of Pattern Recognition and Computer Vision. 3rd ed. World Scientific.</span>
<span id="cb212-87"><a href="#cb212-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-88"><a href="#cb212-88" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>Claude, J. 2008. Morphometrics with R. Springer.</span>
<span id="cb212-89"><a href="#cb212-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-90"><a href="#cb212-90" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305--1335.</span>
<span id="cb212-91"><a href="#cb212-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-92"><a href="#cb212-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Area</span></span>
<span id="cb212-93"><a href="#cb212-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-94"><a href="#cb212-94" aria-hidden="true" tabindex="-1"></a>The area of a shape is calculated using Shoelace's formula (Lee and Lim, 2017)<span class="ot">[^5]</span>, as follows</span>
<span id="cb212-95"><a href="#cb212-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-96"><a href="#cb212-96" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>Lee, Y., and W. Lim. 2017. Shoelace Formula: Connecting the Area of a Polygon and the Vector Cross Product. The Mathematics Teacher 110(8): 631--636. doi: 10.5951/MATHTEACHER.110.8.0631.</span>
<span id="cb212-97"><a href="#cb212-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-98"><a href="#cb212-98" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb212-99"><a href="#cb212-99" aria-hidden="true" tabindex="-1"></a>A=\frac{1}{2}\left |\sum_{i=1}^{n}\left(x_{i} y_{i+1}-x_{i+1}y_{i}\right)\right|</span>
<span id="cb212-100"><a href="#cb212-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb212-101"><a href="#cb212-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-104"><a href="#cb212-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-105"><a href="#cb212-105" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_area</span>(cont)</span>
<span id="cb212-106"><a href="#cb212-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-107"><a href="#cb212-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-108"><a href="#cb212-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter</span></span>
<span id="cb212-109"><a href="#cb212-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-110"><a href="#cb212-110" aria-hidden="true" tabindex="-1"></a>The perimeter is calculated as the sum of the Euclidean distance between all points on a shape. Distances can be obtained with <span class="in">`poly_distpts()`</span>.</span>
<span id="cb212-111"><a href="#cb212-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-114"><a href="#cb212-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-115"><a href="#cb212-115" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(cont)</span>
<span id="cb212-116"><a href="#cb212-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-117"><a href="#cb212-117" aria-hidden="true" tabindex="-1"></a><span class="co"># perimeter of a circle with radius 2</span></span>
<span id="cb212-118"><a href="#cb212-118" aria-hidden="true" tabindex="-1"></a>circle <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">radius =</span> <span class="dv">2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-119"><a href="#cb212-119" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_perimeter</span>(circle)</span>
<span id="cb212-120"><a href="#cb212-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-121"><a href="#cb212-121" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result</span></span>
<span id="cb212-122"><a href="#cb212-122" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb212-123"><a href="#cb212-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-124"><a href="#cb212-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-125"><a href="#cb212-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Radius</span></span>
<span id="cb212-126"><a href="#cb212-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-127"><a href="#cb212-127" aria-hidden="true" tabindex="-1"></a>The radius of a pixel on the object's contour is calculated as its distance from the object's centroid(also called 'center of mass'). These distances can be obtained with <span class="in">`poly_centdist()`</span>.</span>
<span id="cb212-128"><a href="#cb212-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-131"><a href="#cb212-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-132"><a href="#cb212-132" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">poly_centdist</span>(cont)</span>
<span id="cb212-133"><a href="#cb212-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-134"><a href="#cb212-134" aria-hidden="true" tabindex="-1"></a><span class="co"># stats for radius</span></span>
<span id="cb212-135"><a href="#cb212-135" aria-hidden="true" tabindex="-1"></a><span class="fu">mean_list</span>(dist)</span>
<span id="cb212-136"><a href="#cb212-136" aria-hidden="true" tabindex="-1"></a><span class="fu">min_list</span>(dist)</span>
<span id="cb212-137"><a href="#cb212-137" aria-hidden="true" tabindex="-1"></a><span class="fu">max_list</span>(dist)</span>
<span id="cb212-138"><a href="#cb212-138" aria-hidden="true" tabindex="-1"></a><span class="fu">sd_list</span>(dist)</span>
<span id="cb212-139"><a href="#cb212-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-140"><a href="#cb212-140" aria-hidden="true" tabindex="-1"></a><span class="co"># average radius of above circle</span></span>
<span id="cb212-141"><a href="#cb212-141" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_centdist</span>(circle) <span class="sc">|&gt;</span> <span class="fu">mean_list</span>()</span>
<span id="cb212-142"><a href="#cb212-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-143"><a href="#cb212-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-144"><a href="#cb212-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Length and width</span></span>
<span id="cb212-145"><a href="#cb212-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-146"><a href="#cb212-146" aria-hidden="true" tabindex="-1"></a>The length and width of an object are calculated with <span class="in">`poly_lw()`</span>, as the difference between the maximum and minimum of the <span class="in">`x`</span> and <span class="in">`y`</span> coordinates after the object has been aligned with <span class="in">`poly_align()`</span>.</span>
<span id="cb212-147"><a href="#cb212-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-148"><a href="#cb212-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height =2, fig.width=10}</span></span>
<span id="cb212-149"><a href="#cb212-149" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_lw</span>(cont)</span>
<span id="cb212-150"><a href="#cb212-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-151"><a href="#cb212-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-152"><a href="#cb212-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Circularity, eccentricity, diameter, and elongation</span></span>
<span id="cb212-153"><a href="#cb212-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-154"><a href="#cb212-154" aria-hidden="true" tabindex="-1"></a>Circularity(Montero et al. 2009)<span class="ot">[^6]</span> is also called shape compactness, or measure of roundness of an object. It is given by $C = P^2 / A$, where $P$ is the perimeter and $A$ is the area of the object.</span>
<span id="cb212-155"><a href="#cb212-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-156"><a href="#cb212-156" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span>Montero, R.S., E. Bribiesca, R. Santiago, and E. Bribiesca. 2009. State of the Art of Compactness and Circularity Measures. International Mathematical Forum 4(27): 1305--1335</span>
<span id="cb212-157"><a href="#cb212-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-160"><a href="#cb212-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-161"><a href="#cb212-161" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity</span>(cont)</span>
<span id="cb212-162"><a href="#cb212-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-163"><a href="#cb212-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-164"><a href="#cb212-164" aria-hidden="true" tabindex="-1"></a>As the above measurement depends on the scale, normalized roundness can be used. In this case, a perfect circle is assumed to have a circularity equal to 1. This measure is invariant under translation, rotation and scale transformations, given $Cn = P^2 / 4 \pi A$</span>
<span id="cb212-165"><a href="#cb212-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-168"><a href="#cb212-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-169"><a href="#cb212-169" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_norm</span>(cont)</span>
<span id="cb212-170"><a href="#cb212-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-171"><a href="#cb212-171" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized circularity for different shapes</span></span>
<span id="cb212-172"><a href="#cb212-172" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_square</span>(<span class="at">plot =</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb212-173"><a href="#cb212-173" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_circle</span>(<span class="at">plot=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">poly_circularity_norm</span>()</span>
<span id="cb212-174"><a href="#cb212-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-175"><a href="#cb212-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-176"><a href="#cb212-176" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_circularity_haralick()`</span> calculates the Circularity of Haralick, CH (Haralick, 1974)<span class="ot">[^7]</span>. The method is based on calculating all Euclidean distances from the object's centroid to each contour pixel. With this set of distances, the mean($m$) and the standard deviation($s$) are calculated. These statistical parameters are used in a ratio that calculates CH as \$CH = m/ sd \$.</span>
<span id="cb212-177"><a href="#cb212-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-178"><a href="#cb212-178" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span>Haralick, R.M. 1974. A Measure for Circularity of Digital Figures. IEEE Transactions on Systems, Man, and Cybernetics SMC-4(4): 394--396. doi: 10.1109/TSMC.1974.5408463.</span>
<span id="cb212-179"><a href="#cb212-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-182"><a href="#cb212-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-183"><a href="#cb212-183" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_circularity_haralick</span>(cont)</span>
<span id="cb212-184"><a href="#cb212-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-185"><a href="#cb212-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-186"><a href="#cb212-186" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_convexity()`</span> Calculates the convexity of a shape using a ratio of the perimeter of the convex hull to the perimeter of the polygon.</span>
<span id="cb212-187"><a href="#cb212-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-190"><a href="#cb212-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-191"><a href="#cb212-191" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_convexity</span>(cont)</span>
<span id="cb212-192"><a href="#cb212-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-193"><a href="#cb212-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-194"><a href="#cb212-194" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_eccentricity()`</span> Calculates the eccentricity of a shape using the ratio of the eigenvalues(coordinate inertia axes).</span>
<span id="cb212-195"><a href="#cb212-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-198"><a href="#cb212-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-199"><a href="#cb212-199" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_eccentricity</span>(cont)</span>
<span id="cb212-200"><a href="#cb212-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-201"><a href="#cb212-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-202"><a href="#cb212-202" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_elongation()`</span> Calculates the elongation of an object as <span class="in">`1 - width / length`</span></span>
<span id="cb212-203"><a href="#cb212-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-206"><a href="#cb212-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-207"><a href="#cb212-207" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_elongation</span>(cont)</span>
<span id="cb212-208"><a href="#cb212-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-209"><a href="#cb212-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-210"><a href="#cb212-210" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_caliper()`</span> Calculates the gauge(also called Feret's diameter).</span>
<span id="cb212-211"><a href="#cb212-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-214"><a href="#cb212-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-215"><a href="#cb212-215" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_caliper</span>(cont)</span>
<span id="cb212-216"><a href="#cb212-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-217"><a href="#cb212-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-218"><a href="#cb212-218" aria-hidden="true" tabindex="-1"></a>Users can use the <span class="in">`poly_measures()`</span> function to calculate most object measurements in a single call.</span>
<span id="cb212-219"><a href="#cb212-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-222"><a href="#cb212-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-223"><a href="#cb212-223" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">poly_measures</span>(cont) <span class="sc">|&gt;</span> <span class="fu">round_cols</span>()</span>
<span id="cb212-224"><a href="#cb212-224" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(measures)</span>
<span id="cb212-225"><a href="#cb212-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-226"><a href="#cb212-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-227"><a href="#cb212-227" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, the measurements can be corrected with <span class="in">`get_measures()`</span>. Image resolution can be obtained using a known distance in the image. In the example, the white square has a side of 5 cm. So using <span class="in">`dpi()`</span> the resolution can be obtained. In this case, the dpi is \~50.</span>
<span id="cb212-228"><a href="#cb212-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-231"><a href="#cb212-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-232"><a href="#cb212-232" aria-hidden="true" tabindex="-1"></a>color_measures <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(measures, <span class="at">dpi =</span> <span class="dv">50</span>)</span>
<span id="cb212-233"><a href="#cb212-233" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(color_measures)</span>
<span id="cb212-234"><a href="#cb212-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-235"><a href="#cb212-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-236"><a href="#cb212-236" aria-hidden="true" tabindex="-1"></a>Some useful functions can be used to manipulate coordinates. In the following example I will show some features implemented in <span class="in">`pliman`</span>. Just for simplicity, I'll use only one object.</span>
<span id="cb212-237"><a href="#cb212-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-240"><a href="#cb212-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-241"><a href="#cb212-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-242"><a href="#cb212-242" aria-hidden="true" tabindex="-1"></a>o2 <span class="ot">&lt;-</span> cont[[<span class="st">"12"</span>]]</span>
<span id="cb212-243"><a href="#cb212-243" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(o2)</span>
<span id="cb212-244"><a href="#cb212-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-245"><a href="#cb212-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-246"><a href="#cb212-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rotate polygons</span></span>
<span id="cb212-247"><a href="#cb212-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-248"><a href="#cb212-248" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_rotate()`</span> can be used to rotate the polygon coordinates by an <span class="in">`angle`</span> (0-360 degrees) in the trigonometric (anti-clockwise) direction.</span>
<span id="cb212-249"><a href="#cb212-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-252"><a href="#cb212-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-253"><a href="#cb212-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-254"><a href="#cb212-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-255"><a href="#cb212-255" aria-hidden="true" tabindex="-1"></a>rot <span class="ot">&lt;-</span> <span class="fu">poly_rotate</span>(o2, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb212-256"><a href="#cb212-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-257"><a href="#cb212-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-258"><a href="#cb212-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Invert polygons</span></span>
<span id="cb212-259"><a href="#cb212-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-260"><a href="#cb212-260" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_flip_x()`</span> and <span class="in">`poly_flip_y()`</span> can be used to flip shapes along the x and y axis, respectively.</span>
<span id="cb212-261"><a href="#cb212-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-264"><a href="#cb212-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-265"><a href="#cb212-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-266"><a href="#cb212-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-267"><a href="#cb212-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-268"><a href="#cb212-268" aria-hidden="true" tabindex="-1"></a>flipped <span class="ot">&lt;-</span> </span>
<span id="cb212-269"><a href="#cb212-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">fx =</span> <span class="fu">poly_flip_x</span>(o2), </span>
<span id="cb212-270"><a href="#cb212-270" aria-hidden="true" tabindex="-1"></a>       <span class="at">fy =</span> <span class="fu">poly_flip_y</span>(o2))</span>
<span id="cb212-271"><a href="#cb212-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-272"><a href="#cb212-272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(flipped, <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-273"><a href="#cb212-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-274"><a href="#cb212-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-275"><a href="#cb212-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perimeter sampling</span></span>
<span id="cb212-276"><a href="#cb212-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-277"><a href="#cb212-277" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_sample()`</span> samples <span class="in">`n`</span> coordinates between existing points, and <span class="in">`poly_sample_prop()`</span> samples a proportion of coordinates between existing ones.</span>
<span id="cb212-278"><a href="#cb212-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-281"><a href="#cb212-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-282"><a href="#cb212-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-283"><a href="#cb212-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-284"><a href="#cb212-284" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 50 coordinates</span></span>
<span id="cb212-285"><a href="#cb212-285" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample</span>(o2, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb212-286"><a href="#cb212-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-287"><a href="#cb212-287" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 10% of coordinates</span></span>
<span id="cb212-288"><a href="#cb212-288" aria-hidden="true" tabindex="-1"></a><span class="fu">poly_sample_prop</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>) <span class="sc">|&gt;</span> <span class="fu">plot_polygon</span>()</span>
<span id="cb212-289"><a href="#cb212-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-290"><a href="#cb212-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-291"><a href="#cb212-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## smoothing</span></span>
<span id="cb212-292"><a href="#cb212-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-293"><a href="#cb212-293" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_smooth()`</span> smooths the contour of a polygon by combining <span class="in">`prop`</span> coordinate point samples and interpolating them using <span class="in">`vertices`</span> vertices(default is 1000) .</span>
<span id="cb212-294"><a href="#cb212-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-297"><a href="#cb212-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-298"><a href="#cb212-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-299"><a href="#cb212-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-300"><a href="#cb212-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-301"><a href="#cb212-301" aria-hidden="true" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span></span>
<span id="cb212-302"><a href="#cb212-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>( <span class="at">original =</span> o2,</span>
<span id="cb212-303"><a href="#cb212-303" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.2</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-304"><a href="#cb212-304" aria-hidden="true" tabindex="-1"></a>        <span class="at">s2 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>),</span>
<span id="cb212-305"><a href="#cb212-305" aria-hidden="true" tabindex="-1"></a>        <span class="at">s1 =</span> <span class="fu">poly_smooth</span>(o2, <span class="at">prop =</span> <span class="fl">0.04</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-306"><a href="#cb212-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-307"><a href="#cb212-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-308"><a href="#cb212-308" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(smoothed, <span class="at">merge =</span> <span class="cn">FALSE</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb212-309"><a href="#cb212-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-310"><a href="#cb212-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-311"><a href="#cb212-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Noises</span></span>
<span id="cb212-312"><a href="#cb212-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-313"><a href="#cb212-313" aria-hidden="true" tabindex="-1"></a><span class="in">`poly_jitter()`</span> adds a small amount of noise to a set of coordinates. See <span class="in">`base::jitter()`</span> for more details.</span>
<span id="cb212-314"><a href="#cb212-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-317"><a href="#cb212-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-318"><a href="#cb212-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-319"><a href="#cb212-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-320"><a href="#cb212-320" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb212-321"><a href="#cb212-321" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-322"><a href="#cb212-322" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">draw_circle</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb212-323"><a href="#cb212-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_jitter</span>(<span class="at">noise_x =</span> <span class="dv">100</span>,</span>
<span id="cb212-324"><a href="#cb212-324" aria-hidden="true" tabindex="-1"></a>              <span class="at">noise_y =</span> <span class="dv">100</span>,</span>
<span id="cb212-325"><a href="#cb212-325" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-326"><a href="#cb212-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-327"><a href="#cb212-327" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(<span class="fu">list</span>(c1, c2), <span class="at">merge =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-328"><a href="#cb212-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-329"><a href="#cb212-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-330"><a href="#cb212-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-331"><a href="#cb212-331" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyzing objects</span></span>
<span id="cb212-332"><a href="#cb212-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-333"><a href="#cb212-333" aria-hidden="true" tabindex="-1"></a>The functions we've seen can be used to obtain measurements of objects. However, for image analysis it is necessary to combine different functions (mainly <span class="in">`object_contour()`</span> and <span class="in">`poly_measures()`</span>). Also, almost always, several images need to be analyzed and repeating this process each time would be tedious and inefficient. To address these needs, users can use the <span class="in">`analyze_objects()`</span> function. Let's start with a simple example, using the <span class="in">`object_300dpi.png`</span> image available on <span class="co">[</span><span class="ot">GitHub page</span><span class="co">](https://github.com/TiagoOlivoto/pliman/tree/master/inst/tmp_images)</span>. To facilitate importing images from this folder, an <span class="in">`image_pliman()`</span> helper function is used.</span>
<span id="cb212-334"><a href="#cb212-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-335"><a href="#cb212-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse =TRUE}</span></span>
<span id="cb212-336"><a href="#cb212-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-337"><a href="#cb212-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb212-338"><a href="#cb212-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb212-339"><a href="#cb212-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-340"><a href="#cb212-340" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-341"><a href="#cb212-341" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb212-342"><a href="#cb212-342" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metan)</span>
<span id="cb212-343"><a href="#cb212-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-344"><a href="#cb212-344" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">"objects_300dpi.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-345"><a href="#cb212-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-346"><a href="#cb212-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-347"><a href="#cb212-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-348"><a href="#cb212-348" aria-hidden="true" tabindex="-1"></a>The image above was produced with Microsoft PowerPoint. It has a known resolution of 300 dpi(dots per inch) and displays four objects</span>
<span id="cb212-349"><a href="#cb212-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-350"><a href="#cb212-350" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Larger square: 10 x 10 cm (100 cm$^2$)</span>
<span id="cb212-351"><a href="#cb212-351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Smaller square: 5 x 5 cm(25 cm$^2$)</span>
<span id="cb212-352"><a href="#cb212-352" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rectangle: 4 x 2 cm(8 cm$^2$)</span>
<span id="cb212-353"><a href="#cb212-353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Circle: 3 cm in diameter(\~7.07 cm$^2$)</span>
<span id="cb212-354"><a href="#cb212-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-355"><a href="#cb212-355" aria-hidden="true" tabindex="-1"></a>To count the objects in the image we use <span class="in">`analyze_objects()`</span> and inform the image(the only required argument). By default, the <span class="in">`NB`</span> index is used for object segmentation.</span>
<span id="cb212-356"><a href="#cb212-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-359"><a href="#cb212-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-360"><a href="#cb212-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-361"><a href="#cb212-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-362"><a href="#cb212-362" aria-hidden="true" tabindex="-1"></a>img_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(img, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-363"><a href="#cb212-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-364"><a href="#cb212-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-365"><a href="#cb212-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjusting object measurements</span></span>
<span id="cb212-366"><a href="#cb212-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-367"><a href="#cb212-367" aria-hidden="true" tabindex="-1"></a>The results were stored in <span class="in">`img_res`</span>. Since there is no scale declared in the example above, we have no idea about the actual area of objects in cm$^2$, only in pixels. In this case, we use <span class="in">`get_measures()`</span> to adjust pixel measurements to metric units.</span>
<span id="cb212-368"><a href="#cb212-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-369"><a href="#cb212-369" aria-hidden="true" tabindex="-1"></a>There are two main ways to adjust object measurements (from pixels to cm, for example). The first is to declare the known area, perimeter or radius of a given object. The measure for the other objects will then be calculated by a simple rule of three. The second is by declaring a known image resolution in dpi(dots per inch). In this case, perimeter, area, and radius will be adjusted by the dpi informed.</span>
<span id="cb212-370"><a href="#cb212-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-371"><a href="#cb212-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring a known value</span></span>
<span id="cb212-372"><a href="#cb212-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-373"><a href="#cb212-373" aria-hidden="true" tabindex="-1"></a>Since we know the area of the larger square (object 1), let's adjust the area of the other objects in the image using this.</span>
<span id="cb212-374"><a href="#cb212-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-377"><a href="#cb212-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-378"><a href="#cb212-378" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(img_res ,</span>
<span id="cb212-379"><a href="#cb212-379" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb212-380"><a href="#cb212-380" aria-hidden="true" tabindex="-1"></a>             area <span class="sc">~</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb212-381"><a href="#cb212-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb212-382"><a href="#cb212-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-383"><a href="#cb212-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-384"><a href="#cb212-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-385"><a href="#cb212-385" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring the image resolution</span></span>
<span id="cb212-386"><a href="#cb212-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-387"><a href="#cb212-387" aria-hidden="true" tabindex="-1"></a>If the image resolution is known, all measurements will be adjusted accordingly. Let's see a numerical example with <span class="in">`pixels_to_cm()`</span>. This function converts the number of pixels(<span class="sc">\*</span> px <span class="sc">\*</span>) into cm, considering the image resolution in <span class="in">`dpi`</span>, as follows: $cm = px \times(2.54 / dpi)$. As we know the number of pixels of the larger square, its perimeter in cm is given by</span>
<span id="cb212-388"><a href="#cb212-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-391"><a href="#cb212-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-392"><a href="#cb212-392" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pixels for the perimeter of the largest square</span></span>
<span id="cb212-393"><a href="#cb212-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-394"><a href="#cb212-394" aria-hidden="true" tabindex="-1"></a>ls_px <span class="ot">&lt;-</span> img_res<span class="sc">$</span>results<span class="sc">$</span>perimeter[<span class="dv">1</span>]</span>
<span id="cb212-395"><a href="#cb212-395" aria-hidden="true" tabindex="-1"></a><span class="fu">pixels_to_cm</span>(<span class="at">px =</span> ls_px , <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb212-396"><a href="#cb212-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-397"><a href="#cb212-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-398"><a href="#cb212-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-399"><a href="#cb212-399" aria-hidden="true" tabindex="-1"></a>The perimeter of object 1 adjusted by image resolution is very close to the known value (40 cm). Below, the values of all measures are adjusted by declaring the <span class="in">`dpi`</span> argument in <span class="in">`get_measures()`</span>.</span>
<span id="cb212-400"><a href="#cb212-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-403"><a href="#cb212-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-404"><a href="#cb212-404" aria-hidden="true" tabindex="-1"></a>img_res_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(img_res, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb212-405"><a href="#cb212-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-406"><a href="#cb212-406" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb212-407"><a href="#cb212-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-408"><a href="#cb212-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-409"><a href="#cb212-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-410"><a href="#cb212-410" aria-hidden="true" tabindex="-1"></a><span class="fu">### Understanding measurements</span></span>
<span id="cb212-411"><a href="#cb212-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-414"><a href="#cb212-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-415"><a href="#cb212-415" aria-hidden="true" tabindex="-1"></a><span class="fu">object_contour</span>(img) <span class="sc">%&gt;%</span> <span class="co"># get the contour of objects</span></span>
<span id="cb212-416"><a href="#cb212-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly_mass</span>() <span class="sc">%&gt;%</span> <span class="co"># computes the center of mass and minimum and maximum radii</span></span>
<span id="cb212-417"><a href="#cb212-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_mass</span>() <span class="co"># plot the measurements</span></span>
<span id="cb212-418"><a href="#cb212-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-419"><a href="#cb212-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-420"><a href="#cb212-420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Larger square:</span>
<span id="cb212-421"><a href="#cb212-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The minimum diameter(a = 9.97) can be considered as the side of the square</span>
<span id="cb212-422"><a href="#cb212-422" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The maximum diameter, given by $a \sqrt {2}$ can be considered the diagonal of the square ($9.97 \sqrt {2} = 14,099 \approx 14,105$</span>
<span id="cb212-423"><a href="#cb212-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-426"><a href="#cb212-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-427"><a href="#cb212-427" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(img_res_cor)</span>
<span id="cb212-428"><a href="#cb212-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-429"><a href="#cb212-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-430"><a href="#cb212-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Texture features</span></span>
<span id="cb212-431"><a href="#cb212-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-432"><a href="#cb212-432" aria-hidden="true" tabindex="-1"></a>The function computes 13 Haralick texture features for each object based on a gray-level co-occurrence matrix (Haralick et al. 1979)<span class="ot">[^8]</span>. Haralick features depend on the configuration of the parameters <span class="in">`har_nbins`</span> and <span class="in">`har_scales`</span>. <span class="in">`har_nbins`</span> controls the number of bins used to compute the Haralick matrix. A smaller <span class="in">`har_nbins`</span> can give more accurate estimates of the correlation because the number of events per bin is higher. While a higher value will give more sensitivity. <span class="in">`har_scales`</span> controls the number of scales used to compute the Haralick features. Since Haralick features compute the correlation of intensities of neighboring pixels, it is possible to identify textures with different scales, e.g., a texture that is repeated every two pixels or 10 pixels. By default, the Haralick features are computed with the R band. To change this default, use the argument <span class="in">`har_band`</span>. For example, <span class="in">`har_band = 2`</span> will compute the features with the green band.</span>
<span id="cb212-433"><a href="#cb212-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-434"><a href="#cb212-434" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span>Haralick, R.M., K. Shanmugam, and I. Dinstein. 1973. Textural Features for Image Classification. IEEE Transactions on Systems, Man, and Cybernetics SMC-3(6): 610--621. doi: 10.1109/TSMC.1973.4309314</span>
<span id="cb212-435"><a href="#cb212-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-436"><a href="#cb212-436" aria-hidden="true" tabindex="-1"></a>The following measures are returned (for more details, see <span class="co">[</span><span class="ot">this post</span><span class="co">](https://earlglynn.github.io/RNotes/package/EBImage/Features-Haralick.html)</span>)</span>
<span id="cb212-437"><a href="#cb212-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-438"><a href="#cb212-438" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`asm`</span>: The angular second-moment feature.</span>
<span id="cb212-439"><a href="#cb212-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`con`</span>: The contrast feature</span>
<span id="cb212-440"><a href="#cb212-440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cor`</span>: Correlation measures the linear dependency of gray levels of neighboring pixels.</span>
<span id="cb212-441"><a href="#cb212-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`var`</span>: The variance of gray levels pixels.</span>
<span id="cb212-442"><a href="#cb212-442" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`idm`</span>: The Inverse Difference Moment (IDM), i.e., the local homogeneity.</span>
<span id="cb212-443"><a href="#cb212-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sav`</span>: The Sum Average.</span>
<span id="cb212-444"><a href="#cb212-444" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sva`</span>: The Sum Variance.</span>
<span id="cb212-445"><a href="#cb212-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sen`</span>: Sum Entropy.</span>
<span id="cb212-446"><a href="#cb212-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dva`</span>: Difference Variance.</span>
<span id="cb212-447"><a href="#cb212-447" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`den`</span>: Difference Entropy</span>
<span id="cb212-448"><a href="#cb212-448" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`f12`</span>: Difference Variance.</span>
<span id="cb212-449"><a href="#cb212-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`f13`</span>: The angular second-moment feature.</span>
<span id="cb212-450"><a href="#cb212-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-451"><a href="#cb212-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Single image processing</span></span>
<span id="cb212-452"><a href="#cb212-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-453"><a href="#cb212-453" aria-hidden="true" tabindex="-1"></a>The <span class="in">`analyze_objects()`</span> function calculates a range of measurements that can be used to study the shape and texture of objects, such as leaves. In the following example, I show how to plot the length and width of each leaf in the following image.</span>
<span id="cb212-454"><a href="#cb212-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-457"><a href="#cb212-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-458"><a href="#cb212-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-459"><a href="#cb212-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-460"><a href="#cb212-460" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-461"><a href="#cb212-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-462"><a href="#cb212-462" aria-hidden="true" tabindex="-1"></a>leaves_meas <span class="ot">&lt;-</span></span>
<span id="cb212-463"><a href="#cb212-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb212-464"><a href="#cb212-464" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-465"><a href="#cb212-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-466"><a href="#cb212-466" aria-hidden="true" tabindex="-1"></a>leaves_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(leaves_meas, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb212-467"><a href="#cb212-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-468"><a href="#cb212-468" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(leaves_cor)</span>
<span id="cb212-469"><a href="#cb212-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-470"><a href="#cb212-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-471"><a href="#cb212-471" aria-hidden="true" tabindex="-1"></a><span class="co"># plot width and length</span></span>
<span id="cb212-472"><a href="#cb212-472" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"width"</span>)</span>
<span id="cb212-473"><a href="#cb212-473" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(leaves_cor , <span class="at">measure =</span> <span class="st">"length"</span>, <span class="at">vjust =</span> <span class="dv">50</span>)</span>
<span id="cb212-474"><a href="#cb212-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-475"><a href="#cb212-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-476"><a href="#cb212-476" aria-hidden="true" tabindex="-1"></a>Here, we will count the grains in the <span class="in">`grains.jpg`</span> image. This image has a cyan background and contains 90 soybeans that touch each other. The <span class="in">`analyze_objects()`</span> function segments the image using the normalized blue index by default, as follows $NB =(B /(R + G + B))$, where *R*, *G* and *B* are the red, green and blue bands. Note that if the image is contained in the default directory, it is not necessary to import it. Just enter the image name in quotes in the <span class="in">`img`</span> argument(e.g., <span class="in">`img = "grains"`</span>).</span>
<span id="cb212-477"><a href="#cb212-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-478"><a href="#cb212-478" aria-hidden="true" tabindex="-1"></a>In this example, objects are counted and segmented objects are colored with random colors using the <span class="in">`show_segmentation = TRUE`</span> argument. Users can set <span class="in">`show_contour = FALSE`</span> to remove the contour line and identify the objects (in this example, the grains) using the <span class="in">`marker = "id"`</span> arguments. The background color can also be changed with <span class="in">`col_background`</span>.</span>
<span id="cb212-479"><a href="#cb212-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-482"><a href="#cb212-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-483"><a href="#cb212-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-484"><a href="#cb212-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-485"><a href="#cb212-485" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span></span>
<span id="cb212-486"><a href="#cb212-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">img =</span> <span class="st">"grains"</span>,</span>
<span id="cb212-487"><a href="#cb212-487" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-488"><a href="#cb212-488" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-489"><a href="#cb212-489" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-490"><a href="#cb212-490" aria-hidden="true" tabindex="-1"></a>count<span class="sc">$</span>statistics</span>
<span id="cb212-491"><a href="#cb212-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-492"><a href="#cb212-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-495"><a href="#cb212-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-496"><a href="#cb212-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the measurements of the object</span></span>
<span id="cb212-497"><a href="#cb212-497" aria-hidden="true" tabindex="-1"></a><span class="fu">get_measures</span>(count) <span class="sc">|&gt;</span> </span>
<span id="cb212-498"><a href="#cb212-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb212-499"><a href="#cb212-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb212-500"><a href="#cb212-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-501"><a href="#cb212-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-502"><a href="#cb212-502" aria-hidden="true" tabindex="-1"></a>In the following example, we will select objects with an area above the average of all objects using <span class="in">`lower_size = 675`</span>.</span>
<span id="cb212-503"><a href="#cb212-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-506"><a href="#cb212-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-507"><a href="#cb212-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-508"><a href="#cb212-508" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb212-509"><a href="#cb212-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-510"><a href="#cb212-510" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb212-511"><a href="#cb212-511" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb212-512"><a href="#cb212-512" aria-hidden="true" tabindex="-1"></a>                <span class="at">topn_upper =</span> <span class="dv">5</span>)</span>
<span id="cb212-513"><a href="#cb212-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-514"><a href="#cb212-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-515"><a href="#cb212-515" aria-hidden="true" tabindex="-1"></a>Users can also use the <span class="in">`topn _*`</span> arguments to select the <span class="in">`n`</span> objects based on the smallest or largest areas. Let's see how to select the 5 grains with the smallest area, showing the original grains on a blue background. We will also use the <span class="in">`my_index`</span> argument to choose a custom index to segment the image. Just for comparison, we will explicitly set the normalized blue index by calling <span class="in">`my_index = "B /(R + G + B)"`</span>.</span>
<span id="cb212-516"><a href="#cb212-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-519"><a href="#cb212-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-520"><a href="#cb212-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-521"><a href="#cb212-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-522"><a href="#cb212-522" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(<span class="st">"grains"</span>,</span>
<span id="cb212-523"><a href="#cb212-523" aria-hidden="true" tabindex="-1"></a>                <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb212-524"><a href="#cb212-524" aria-hidden="true" tabindex="-1"></a>                <span class="at">topn_lower =</span> <span class="dv">5</span>,</span>
<span id="cb212-525"><a href="#cb212-525" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_background =</span> <span class="st">"black"</span>,</span>
<span id="cb212-526"><a href="#cb212-526" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"B /(R + G + B)"</span>) <span class="co"># normalized blue(NB)</span></span>
<span id="cb212-527"><a href="#cb212-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-528"><a href="#cb212-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-529"><a href="#cb212-529" aria-hidden="true" tabindex="-1"></a><span class="fu">## Batch processing</span></span>
<span id="cb212-530"><a href="#cb212-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-531"><a href="#cb212-531" aria-hidden="true" tabindex="-1"></a>In image analysis, it is often necessary to process more than one image. For example, in plant breeding, the number of grains per plant(eg wheat) is often used in the indirect selection of high-yielding plants. In <span class="in">`pliman`</span>, batch processing can be done when the user declares the <span class="in">`pattern`</span> argument.</span>
<span id="cb212-532"><a href="#cb212-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-533"><a href="#cb212-533" aria-hidden="true" tabindex="-1"></a>To speed up processing time, especially for large numbers of images, the <span class="in">`parallel = TRUE`</span> argument can be used. In this case, images are processed asynchronously (in parallel) in separate <span class="in">`R`</span> sessions running in the background on the same machine. The number of sections is set to 50% of available cores. This number can be explicitly controlled with the <span class="in">`workers`</span> argument.</span>
<span id="cb212-534"><a href="#cb212-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-537"><a href="#cb212-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-538"><a href="#cb212-538" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb212-539"><a href="#cb212-539" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-540"><a href="#cb212-540" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-541"><a href="#cb212-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-542"><a href="#cb212-542" aria-hidden="true" tabindex="-1"></a><span class="co"># parallel processing</span></span>
<span id="cb212-543"><a href="#cb212-543" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 multiple sections (50% of my pc's cores)</span></span>
<span id="cb212-544"><a href="#cb212-544" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb212-545"><a href="#cb212-545" aria-hidden="true" tabindex="-1"></a>  list_res <span class="ot">&lt;-</span></span>
<span id="cb212-546"><a href="#cb212-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"img_sb"</span>,</span>
<span id="cb212-547"><a href="#cb212-547" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-548"><a href="#cb212-548" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-549"><a href="#cb212-549" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-550"><a href="#cb212-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-551"><a href="#cb212-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-552"><a href="#cb212-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-553"><a href="#cb212-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-554"><a href="#cb212-554" aria-hidden="true" tabindex="-1"></a><span class="fu"># Object coordinates</span></span>
<span id="cb212-555"><a href="#cb212-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-556"><a href="#cb212-556" aria-hidden="true" tabindex="-1"></a>Users can get the coordinates for all desired objects with <span class="in">`object_coord()`</span>. When the <span class="in">`id`</span> argument is set to <span class="in">`NULL`</span> (default), a bounding rectangle is drawn including all objects. Use <span class="in">`id = "all"`</span> to get the coordinates of all objects in the image or use a numeric vector to indicate the objects to calculate the coordinates. Note that the <span class="in">`watershed = FALSE`</span> argument is used to avoid unique objects being split up into multiple objects by the watershed segmentation algorithm.</span>
<span id="cb212-557"><a href="#cb212-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-558"><a href="#cb212-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r objec2}</span></span>
<span id="cb212-559"><a href="#cb212-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-560"><a href="#cb212-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-561"><a href="#cb212-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-562"><a href="#cb212-562" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"folhas.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-563"><a href="#cb212-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-564"><a href="#cb212-564" aria-hidden="true" tabindex="-1"></a><span class="co"># get the id of each object</span></span>
<span id="cb212-565"><a href="#cb212-565" aria-hidden="true" tabindex="-1"></a><span class="fu">object_id</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-566"><a href="#cb212-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-567"><a href="#cb212-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of a bounding rectangle around all objects</span></span>
<span id="cb212-568"><a href="#cb212-568" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-569"><a href="#cb212-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-570"><a href="#cb212-570" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coordinates for all objects</span></span>
<span id="cb212-571"><a href="#cb212-571" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb212-572"><a href="#cb212-572" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="st">"all"</span>,</span>
<span id="cb212-573"><a href="#cb212-573" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-574"><a href="#cb212-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-575"><a href="#cb212-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates of objects 1 and 2</span></span>
<span id="cb212-576"><a href="#cb212-576" aria-hidden="true" tabindex="-1"></a><span class="co"># 20 border pixels</span></span>
<span id="cb212-577"><a href="#cb212-577" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(leaves ,</span>
<span id="cb212-578"><a href="#cb212-578" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb212-579"><a href="#cb212-579" aria-hidden="true" tabindex="-1"></a>             <span class="at">edge =</span> <span class="dv">20</span>,</span>
<span id="cb212-580"><a href="#cb212-580" aria-hidden="true" tabindex="-1"></a>             <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-581"><a href="#cb212-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-582"><a href="#cb212-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-583"><a href="#cb212-583" aria-hidden="true" tabindex="-1"></a><span class="fu"># Isolating objects</span></span>
<span id="cb212-584"><a href="#cb212-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-585"><a href="#cb212-585" aria-hidden="true" tabindex="-1"></a>Knowing the coordinates of each object, it is possible to isolate it. The <span class="in">`object_isolate()`</span> function is used for this. In the following example, I will isolate object 1 and set a 10-pixel border around the object.</span>
<span id="cb212-586"><a href="#cb212-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-587"><a href="#cb212-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r object3}</span></span>
<span id="cb212-588"><a href="#cb212-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-589"><a href="#cb212-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-590"><a href="#cb212-590" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span></span>
<span id="cb212-591"><a href="#cb212-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_isolate</span>(leaves ,</span>
<span id="cb212-592"><a href="#cb212-592" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-593"><a href="#cb212-593" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> <span class="dv">1</span>,</span>
<span id="cb212-594"><a href="#cb212-594" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge =</span> <span class="dv">10</span>)</span>
<span id="cb212-595"><a href="#cb212-595" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(id1)</span>
<span id="cb212-596"><a href="#cb212-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-597"><a href="#cb212-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-598"><a href="#cb212-598" aria-hidden="true" tabindex="-1"></a><span class="fu"># Including objects in a list</span></span>
<span id="cb212-599"><a href="#cb212-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-600"><a href="#cb212-600" aria-hidden="true" tabindex="-1"></a><span class="in">`object_split()`</span> can be used to split up a series of objects contained in a single image into a list, where each element is one object. By default, the background is removed and shown in white.</span>
<span id="cb212-601"><a href="#cb212-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-604"><a href="#cb212-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-605"><a href="#cb212-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-606"><a href="#cb212-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-607"><a href="#cb212-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-608"><a href="#cb212-608" aria-hidden="true" tabindex="-1"></a>list <span class="ot">&lt;-</span> <span class="fu">object_split</span>(leaves, <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-609"><a href="#cb212-609" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(list)</span>
<span id="cb212-610"><a href="#cb212-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-611"><a href="#cb212-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-612"><a href="#cb212-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-613"><a href="#cb212-613" aria-hidden="true" tabindex="-1"></a><span class="fu"># RGB values for each object</span></span>
<span id="cb212-614"><a href="#cb212-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-615"><a href="#cb212-615" aria-hidden="true" tabindex="-1"></a>To get the RGB intensity of each object in the image, we use the <span class="in">`object_rgb = TRUE`</span> argument in the <span class="in">`analyze_objects()`</span> function. In the following example, we will use the R, G and B bands and their normalized values. The <span class="in">`pliman_indexes()`</span> function returns the indexes available in the package. To compute a specific index, simply enter a formula containing the values of R, G, or B (e.g. <span class="in">`object_index = "B/G+R"`</span>).</span>
<span id="cb212-616"><a href="#cb212-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-617"><a href="#cb212-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb2}</span></span>
<span id="cb212-618"><a href="#cb212-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-619"><a href="#cb212-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-620"><a href="#cb212-620" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"flax.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-621"><a href="#cb212-621" aria-hidden="true" tabindex="-1"></a>(indx <span class="ot">&lt;-</span> <span class="fu">pliman_indexes</span>())</span>
<span id="cb212-622"><a href="#cb212-622" aria-hidden="true" tabindex="-1"></a>flax_leaves <span class="ot">&lt;-</span></span>
<span id="cb212-623"><a href="#cb212-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img ,</span>
<span id="cb212-624"><a href="#cb212-624" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-625"><a href="#cb212-625" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-626"><a href="#cb212-626" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb212-627"><a href="#cb212-627" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="fu">pliman_indexes</span>(), </span>
<span id="cb212-628"><a href="#cb212-628" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb212-629"><a href="#cb212-629" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"black"</span>,</span>
<span id="cb212-630"><a href="#cb212-630" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb212-631"><a href="#cb212-631" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-632"><a href="#cb212-632" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-633"><a href="#cb212-633" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-634"><a href="#cb212-634" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA with the indices</span></span>
<span id="cb212-635"><a href="#cb212-635" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">summary_index</span>(flax_leaves, <span class="at">type =</span><span class="st">"var"</span>)</span>
<span id="cb212-636"><a href="#cb212-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-637"><a href="#cb212-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-638"><a href="#cb212-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-639"><a href="#cb212-639" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> index provided the greatest contribution to the variation of PC1. The biplot containing the indices (variables) and the grains (individuals) can be seen below.</span>
<span id="cb212-640"><a href="#cb212-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-643"><a href="#cb212-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-644"><a href="#cb212-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-645"><a href="#cb212-645" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-646"><a href="#cb212-646" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"var"</span>)</span>
<span id="cb212-647"><a href="#cb212-647" aria-hidden="true" tabindex="-1"></a><span class="fu">get_biplot</span>(ind<span class="sc">$</span>pca_res, <span class="at">show =</span> <span class="st">"ind"</span>)</span>
<span id="cb212-648"><a href="#cb212-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-649"><a href="#cb212-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-650"><a href="#cb212-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-651"><a href="#cb212-651" aria-hidden="true" tabindex="-1"></a>Now, let's plot the <span class="in">`DGCI`</span> (Dark Green Color Index) on each object. The DGCI is based on the HSB (Hue, Saturation, and Brightness) space color and has been used as an indicator of the darkness of the green color <span class="ot">[^9]</span></span>
<span id="cb212-652"><a href="#cb212-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-653"><a href="#cb212-653" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span>Karcher, D.E., and M.D. Richardson. 2003. Quantifying Turfgrass Color Using Digital Image Analysis. Crop Science 43(3): 943--951. doi: 10.2135/cropsci2003.9430</span>
<span id="cb212-654"><a href="#cb212-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-657"><a href="#cb212-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-658"><a href="#cb212-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-659"><a href="#cb212-659" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb212-660"><a href="#cb212-660" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves, <span class="at">measure =</span> <span class="st">"DGCI"</span>)</span>
<span id="cb212-661"><a href="#cb212-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-662"><a href="#cb212-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-663"><a href="#cb212-663" aria-hidden="true" tabindex="-1"></a>It seems that leaves with an average DGCI value of less than 0.4 can be considered "Yellowish" leaves. Users can then work with this feature and adapt it to their case.</span>
<span id="cb212-664"><a href="#cb212-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-665"><a href="#cb212-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb4}</span></span>
<span id="cb212-666"><a href="#cb212-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-667"><a href="#cb212-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-668"><a href="#cb212-668" aria-hidden="true" tabindex="-1"></a>report <span class="ot">&lt;-</span></span>
<span id="cb212-669"><a href="#cb212-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_index</span>(flax_leaves ,</span>
<span id="cb212-670"><a href="#cb212-670" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb212-671"><a href="#cb212-671" aria-hidden="true" tabindex="-1"></a>                <span class="at">cut_point =</span> <span class="fl">0.4</span>,</span>
<span id="cb212-672"><a href="#cb212-672" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-673"><a href="#cb212-673" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> report<span class="sc">$</span>ids</span>
<span id="cb212-674"><a href="#cb212-674" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>between_id</span>
<span id="cb212-675"><a href="#cb212-675" aria-hidden="true" tabindex="-1"></a>report<span class="sc">$</span>within_id[report<span class="sc">$</span>within_id<span class="sc">$</span>id <span class="sc">%in%</span> ids,]</span>
<span id="cb212-676"><a href="#cb212-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-677"><a href="#cb212-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-678"><a href="#cb212-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-679"><a href="#cb212-679" aria-hidden="true" tabindex="-1"></a>In the following graph, I plot the distribution of the RGB values "Yellowish" and "Greenish" leaves R, G, and B values.</span>
<span id="cb212-680"><a href="#cb212-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-683"><a href="#cb212-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-684"><a href="#cb212-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-685"><a href="#cb212-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-686"><a href="#cb212-686" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution of RGB values</span></span>
<span id="cb212-687"><a href="#cb212-687" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb212-688"><a href="#cb212-688" aria-hidden="true" tabindex="-1"></a>rgbs <span class="ot">&lt;-</span></span>
<span id="cb212-689"><a href="#cb212-689" aria-hidden="true" tabindex="-1"></a>  flax_leaves<span class="sc">$</span>object_rgb <span class="sc">|&gt;</span></span>
<span id="cb212-690"><a href="#cb212-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, h, s, b) <span class="sc">|&gt;</span> </span>
<span id="cb212-691"><a href="#cb212-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> ids, <span class="st">"Yellowish"</span>, <span class="st">"Greenish"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb212-692"><a href="#cb212-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span></span>
<span id="cb212-693"><a href="#cb212-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>type)</span>
<span id="cb212-694"><a href="#cb212-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-695"><a href="#cb212-695" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rgbs, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb212-696"><a href="#cb212-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb212-697"><a href="#cb212-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(type <span class="sc">~</span> name)</span>
<span id="cb212-698"><a href="#cb212-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-699"><a href="#cb212-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-700"><a href="#cb212-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-701"><a href="#cb212-701" aria-hidden="true" tabindex="-1"></a>Now, using the ids of each grain, I plot the values only in the "yello" leaves.</span>
<span id="cb212-702"><a href="#cb212-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-705"><a href="#cb212-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-706"><a href="#cb212-706" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-707"><a href="#cb212-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-708"><a href="#cb212-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-709"><a href="#cb212-709" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb212-710"><a href="#cb212-710" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span>
<span id="cb212-711"><a href="#cb212-711" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves ,</span>
<span id="cb212-712"><a href="#cb212-712" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> ids,</span>
<span id="cb212-713"><a href="#cb212-713" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb212-714"><a href="#cb212-714" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb212-715"><a href="#cb212-715" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(flax_leaves ,</span>
<span id="cb212-716"><a href="#cb212-716" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> flax_leaves<span class="sc">$</span>results<span class="sc">$</span>id[<span class="sc">!</span>flax_leaves<span class="sc">$</span>results<span class="sc">$</span>id <span class="sc">%in%</span> ids],</span>
<span id="cb212-717"><a href="#cb212-717" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb212-718"><a href="#cb212-718" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb212-719"><a href="#cb212-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-720"><a href="#cb212-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-721"><a href="#cb212-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-722"><a href="#cb212-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-723"><a href="#cb212-723" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb212-724"><a href="#cb212-724" aria-hidden="true" tabindex="-1"></a>When there are many objects, the <span class="in">`parallel = TRUE`</span> argument will speed up extracting the RGB values. In the following example, an image with 1343 grains of *Vicia cracca* is analyzed. The indices <span class="in">`"R"`</span> and <span class="in">`"R/G"`</span> are computed. Grains with an average red value greater than 0.25 are highlighted.</span>
<span id="cb212-725"><a href="#cb212-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-726"><a href="#cb212-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rgb5, eval=FALSE}</span></span>
<span id="cb212-727"><a href="#cb212-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-728"><a href="#cb212-728" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-729"><a href="#cb212-729" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"vicia.jpg"</span>)</span>
<span id="cb212-730"><a href="#cb212-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-731"><a href="#cb212-731" aria-hidden="true" tabindex="-1"></a>vicia <span class="ot">&lt;-</span></span>
<span id="cb212-732"><a href="#cb212-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img2,</span>
<span id="cb212-733"><a href="#cb212-733" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-734"><a href="#cb212-734" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="st">"R"</span>,</span>
<span id="cb212-735"><a href="#cb212-735" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-736"><a href="#cb212-736" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-737"><a href="#cb212-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-738"><a href="#cb212-738" aria-hidden="true" tabindex="-1"></a>summary_index <span class="ot">&lt;-</span></span>
<span id="cb212-739"><a href="#cb212-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary_index</span>(vicia ,</span>
<span id="cb212-740"><a href="#cb212-740" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">"R"</span>,</span>
<span id="cb212-741"><a href="#cb212-741" aria-hidden="true" tabindex="-1"></a>                <span class="at">cut_point =</span> <span class="fl">0.25</span>,</span>
<span id="cb212-742"><a href="#cb212-742" aria-hidden="true" tabindex="-1"></a>                <span class="at">select_higher =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-743"><a href="#cb212-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-744"><a href="#cb212-744" aria-hidden="true" tabindex="-1"></a>count2 <span class="ot">&lt;-</span></span>
<span id="cb212-745"><a href="#cb212-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img2,</span>
<span id="cb212-746"><a href="#cb212-746" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-747"><a href="#cb212-747" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-748"><a href="#cb212-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-749"><a href="#cb212-749" aria-hidden="true" tabindex="-1"></a>ids2 <span class="ot">&lt;-</span> summary_index<span class="sc">$</span>ids</span>
<span id="cb212-750"><a href="#cb212-750" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(count2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb212-751"><a href="#cb212-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-752"><a href="#cb212-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-753"><a href="#cb212-753" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb212-754"><a href="#cb212-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-755"><a href="#cb212-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-756"><a href="#cb212-756" aria-hidden="true" tabindex="-1"></a><span class="fu"># Leaf area</span></span>
<span id="cb212-757"><a href="#cb212-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-758"><a href="#cb212-758" aria-hidden="true" tabindex="-1"></a><span class="fu">## Known resolution</span></span>
<span id="cb212-759"><a href="#cb212-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-762"><a href="#cb212-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-763"><a href="#cb212-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-764"><a href="#cb212-764" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> <span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-765"><a href="#cb212-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-766"><a href="#cb212-766" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb212-767"><a href="#cb212-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb212-768"><a href="#cb212-768" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">"B-G"</span>,</span>
<span id="cb212-769"><a href="#cb212-769" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-770"><a href="#cb212-770" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"black"</span>,</span>
<span id="cb212-771"><a href="#cb212-771" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-772"><a href="#cb212-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-773"><a href="#cb212-773" aria-hidden="true" tabindex="-1"></a><span class="co"># using images with known resolution</span></span>
<span id="cb212-774"><a href="#cb212-774" aria-hidden="true" tabindex="-1"></a>af_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(af, <span class="at">dpi =</span> <span class="fl">45.8</span>)</span>
<span id="cb212-775"><a href="#cb212-775" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor ,</span>
<span id="cb212-776"><a href="#cb212-776" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb212-777"><a href="#cb212-777" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">20</span>,</span>
<span id="cb212-778"><a href="#cb212-778" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" cyan "</span>)</span>
<span id="cb212-779"><a href="#cb212-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-780"><a href="#cb212-780" aria-hidden="true" tabindex="-1"></a><span class="co"># declaring the measure of a known object</span></span>
<span id="cb212-781"><a href="#cb212-781" aria-hidden="true" tabindex="-1"></a>af_cor2 <span class="ot">&lt;-</span> </span>
<span id="cb212-782"><a href="#cb212-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_measures</span>(af,</span>
<span id="cb212-783"><a href="#cb212-783" aria-hidden="true" tabindex="-1"></a>               <span class="at">id =</span> <span class="dv">18</span>,</span>
<span id="cb212-784"><a href="#cb212-784" aria-hidden="true" tabindex="-1"></a>               <span class="at">measure =</span> area <span class="sc">~</span> <span class="dv">25</span>)</span>
<span id="cb212-785"><a href="#cb212-785" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor2 ,</span>
<span id="cb212-786"><a href="#cb212-786" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb212-787"><a href="#cb212-787" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">35</span>,</span>
<span id="cb212-788"><a href="#cb212-788" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">"salmon"</span>)</span>
<span id="cb212-789"><a href="#cb212-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-790"><a href="#cb212-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-791"><a href="#cb212-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-792"><a href="#cb212-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-793"><a href="#cb212-793" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference object (dev version)</span></span>
<span id="cb212-794"><a href="#cb212-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-795"><a href="#cb212-795" aria-hidden="true" tabindex="-1"></a><span class="fu">### Single images</span></span>
<span id="cb212-796"><a href="#cb212-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-797"><a href="#cb212-797" aria-hidden="true" tabindex="-1"></a>The <span class="in">`reference`</span> argument can now be used to correct the object measures even when images with different shooting distances are used. This differs from the previous example (declaring the object with the known area) in a subtle, but crucial aspect: when <span class="in">`reference`</span> is informed, batch processing can be used! In this example, the leaf area of the <span class="in">`ref_leaves`</span> image is quantified and corrected considering a 5 x 5 (25 cm$^2$) red square as the reference object. When <span class="in">`reference = TRUE`</span> is informed in <span class="in">`analyze_objects()`</span> the function will perform a two-step process of object segmentation; so, the time processing is a bit slower.</span>
<span id="cb212-798"><a href="#cb212-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-799"><a href="#cb212-799" aria-hidden="true" tabindex="-1"></a>The first step consists in segmenting the foreground (leaves and reference object) from the background. To do that, an image index is used and can be declared in the <span class="in">`back_fore_index`</span>. The default (<span class="in">`back_fore_index = "R/(G/B)"`</span>) is optimized to segment white backgrounds from green leaves and a blue reference object. Let's see how this index performs in this example.</span>
<span id="cb212-800"><a href="#cb212-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-803"><a href="#cb212-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-804"><a href="#cb212-804" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-805"><a href="#cb212-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-806"><a href="#cb212-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-807"><a href="#cb212-807" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-808"><a href="#cb212-808" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"ref_leaves.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-809"><a href="#cb212-809" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"R/(G/B)"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb212-810"><a href="#cb212-810" aria-hidden="true" tabindex="-1"></a>bin <span class="ot">&lt;-</span> <span class="fu">image_binary</span>(img, <span class="at">index =</span> <span class="st">"R/(G/B)"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb212-811"><a href="#cb212-811" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(ind, bin)</span>
<span id="cb212-812"><a href="#cb212-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-813"><a href="#cb212-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-814"><a href="#cb212-814" aria-hidden="true" tabindex="-1"></a>This index definitively is not the better option in this case. Will some other available index be better?</span>
<span id="cb212-815"><a href="#cb212-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-818"><a href="#cb212-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-819"><a href="#cb212-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-820"><a href="#cb212-820" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"all"</span>)</span>
<span id="cb212-821"><a href="#cb212-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-822"><a href="#cb212-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-823"><a href="#cb212-823" aria-hidden="true" tabindex="-1"></a>The <span class="in">`B-G`</span> index seems to be a good candidate.</span>
<span id="cb212-824"><a href="#cb212-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-827"><a href="#cb212-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-828"><a href="#cb212-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-829"><a href="#cb212-829" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">"B-G"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb212-830"><a href="#cb212-830" aria-hidden="true" tabindex="-1"></a>seg1 <span class="ot">&lt;-</span> <span class="fu">image_segment</span>(img, <span class="at">index =</span> <span class="st">"B-G"</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-831"><a href="#cb212-831" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(ind, seg1)</span>
<span id="cb212-832"><a href="#cb212-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-833"><a href="#cb212-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-834"><a href="#cb212-834" aria-hidden="true" tabindex="-1"></a>Good job! now, we have the background removed. The next step is to segment the objects and the reference template. We basically need to repeat the previous step isolating the reference.</span>
<span id="cb212-835"><a href="#cb212-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-838"><a href="#cb212-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-839"><a href="#cb212-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-840"><a href="#cb212-840" aria-hidden="true" tabindex="-1"></a><span class="co"># see the better index</span></span>
<span id="cb212-841"><a href="#cb212-841" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(seg1, <span class="at">index =</span> <span class="st">"all"</span>)</span>
<span id="cb212-842"><a href="#cb212-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-843"><a href="#cb212-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-844"><a href="#cb212-844" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R-G`</span> is a good candidate. So, I'll perform the second segmentation using this index.</span>
<span id="cb212-845"><a href="#cb212-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-848"><a href="#cb212-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-849"><a href="#cb212-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-850"><a href="#cb212-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-851"><a href="#cb212-851" aria-hidden="true" tabindex="-1"></a>seg2 <span class="ot">&lt;-</span> </span>
<span id="cb212-852"><a href="#cb212-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_binary</span>(seg1,</span>
<span id="cb212-853"><a href="#cb212-853" aria-hidden="true" tabindex="-1"></a>               <span class="at">index =</span> <span class="st">"R-G"</span>)</span>
<span id="cb212-854"><a href="#cb212-854" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pixels in the reference object</span></span>
<span id="cb212-855"><a href="#cb212-855" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(seg2<span class="sc">$</span><span class="st">`</span><span class="at">R-G</span><span class="st">`</span> <span class="sc">!=</span> <span class="dv">1</span>))</span>
<span id="cb212-856"><a href="#cb212-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-857"><a href="#cb212-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-858"><a href="#cb212-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-859"><a href="#cb212-859" aria-hidden="true" tabindex="-1"></a>Now that we know the indexes to be used for each segmentation, we can use the function <span class="in">`analyze_objects`</span> to get the corrected measures based on the reference object.</span>
<span id="cb212-860"><a href="#cb212-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-863"><a href="#cb212-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-864"><a href="#cb212-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-865"><a href="#cb212-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb212-866"><a href="#cb212-866" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> </span>
<span id="cb212-867"><a href="#cb212-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img, </span>
<span id="cb212-868"><a href="#cb212-868" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-869"><a href="#cb212-869" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference_area =</span> <span class="dv">25</span>,</span>
<span id="cb212-870"><a href="#cb212-870" aria-hidden="true" tabindex="-1"></a>                  <span class="at">back_fore_index =</span> <span class="st">"B-G"</span>,</span>
<span id="cb212-871"><a href="#cb212-871" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fore_ref_index =</span> <span class="st">"R-G"</span>,</span>
<span id="cb212-872"><a href="#cb212-872" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-873"><a href="#cb212-873" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>)</span>
<span id="cb212-874"><a href="#cb212-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-875"><a href="#cb212-875" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the measures corrected by the image resolution</span></span>
<span id="cb212-876"><a href="#cb212-876" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(af_cor ,</span>
<span id="cb212-877"><a href="#cb212-877" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">"area"</span>,</span>
<span id="cb212-878"><a href="#cb212-878" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">20</span>,</span>
<span id="cb212-879"><a href="#cb212-879" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">" cyan "</span>)</span>
<span id="cb212-880"><a href="#cb212-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-881"><a href="#cb212-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-882"><a href="#cb212-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-883"><a href="#cb212-883" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple images</span></span>
<span id="cb212-884"><a href="#cb212-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-885"><a href="#cb212-885" aria-hidden="true" tabindex="-1"></a>If users need to analyze multiple images from the same sample, the images must share the same filename prefix, which is defined as the part of the filename that precedes the first hyphen (<span class="in">`-`</span>) or underscore (<span class="in">`_`</span>). Then, when using <span class="in">`get_measures()`</span>, measurements from leaf images called, for example, <span class="in">`F1-1.jpeg`</span>, <span class="in">`F1_2.jpeg`</span> and <span class="in">`F1-3.jpeg`</span> will be combined into a single image (<span class="in">`F1`</span>), displayed in the <span class="in">`merge`</span> object. This is useful, for example, for analyzing large sheets that need to be split into multiple images or multiple sheets belonging to the same sample that cannot be scanned into a single image.</span>
<span id="cb212-886"><a href="#cb212-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-887"><a href="#cb212-887" aria-hidden="true" tabindex="-1"></a>In the following example, 36 images will be analyzed. These images contain flax leaves from 12 evaluation dates, with three replications<span class="ot">[^10]</span>. Note that to ensure that all images are processed, all images must share a common pattern, in this case (<span class="in">`"A"`</span>). Here, I will use the <span class="in">`pattern = "A"`</span> to indicate that all images with this pattern name should be merged.</span>
<span id="cb212-888"><a href="#cb212-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-889"><a href="#cb212-889" aria-hidden="true" tabindex="-1"></a><span class="ot">[^10]: </span>The images come from an experiment evaluating flax cultivars at the Universidade Federal de Santa Catarina - UFSC</span>
<span id="cb212-890"><a href="#cb212-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-893"><a href="#cb212-893" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-894"><a href="#cb212-894" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-895"><a href="#cb212-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-896"><a href="#cb212-896" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span></span>
<span id="cb212-897"><a href="#cb212-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">"A"</span>,</span>
<span id="cb212-898"><a href="#cb212-898" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">"linhaca"</span>,</span>
<span id="cb212-899"><a href="#cb212-899" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-900"><a href="#cb212-900" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reference_area =</span> <span class="dv">20</span>,</span>
<span id="cb212-901"><a href="#cb212-901" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-902"><a href="#cb212-902" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb212-903"><a href="#cb212-903" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-904"><a href="#cb212-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-905"><a href="#cb212-905" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(res)</span>
<span id="cb212-906"><a href="#cb212-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-907"><a href="#cb212-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-908"><a href="#cb212-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-909"><a href="#cb212-909" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`merged`</span> is a list with three objects:</span>
<span id="cb212-910"><a href="#cb212-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-911"><a href="#cb212-911" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`results`</span>: a data frame that contains the measurements of each individual object (in this case, an individual leaf) of each analyzed image.</span>
<span id="cb212-912"><a href="#cb212-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-913"><a href="#cb212-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge3}</span></span>
<span id="cb212-914"><a href="#cb212-914" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>results <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb212-915"><a href="#cb212-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-916"><a href="#cb212-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-917"><a href="#cb212-917" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summary`</span> : a data frame that contains the summary of the results, containing the number of objects in each image (<span class="in">`n`</span>) the sum, mean and standard deviation of the area of each image, as well as the average value for all others measurements (perimeter, radius, etc.)</span>
<span id="cb212-918"><a href="#cb212-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-919"><a href="#cb212-919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge4}</span></span>
<span id="cb212-920"><a href="#cb212-920" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>summary <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb212-921"><a href="#cb212-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-922"><a href="#cb212-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-923"><a href="#cb212-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-924"><a href="#cb212-924" aria-hidden="true" tabindex="-1"></a>The <span class="in">`area_sum`</span> of img <span class="in">`A1_28_1`</span> is the sum of the 18 leaves.</span>
<span id="cb212-925"><a href="#cb212-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-926"><a href="#cb212-926" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge6}</span></span>
<span id="cb212-927"><a href="#cb212-927" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged<span class="sc">$</span>results<span class="sc">$</span>area[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>])</span>
<span id="cb212-928"><a href="#cb212-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-929"><a href="#cb212-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-930"><a href="#cb212-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-931"><a href="#cb212-931" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`merge`</span>: a data frame that contains the results merged by image prefix (In this case, A1 to A12).</span>
<span id="cb212-932"><a href="#cb212-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-933"><a href="#cb212-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge5}</span></span>
<span id="cb212-934"><a href="#cb212-934" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>merge <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb212-935"><a href="#cb212-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-936"><a href="#cb212-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-937"><a href="#cb212-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-938"><a href="#cb212-938" aria-hidden="true" tabindex="-1"></a>Below, I will fit a non-linear model (Logistic) to model the leaf area evolution across the crop cycle.</span>
<span id="cb212-939"><a href="#cb212-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-940"><a href="#cb212-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge9}</span></span>
<span id="cb212-941"><a href="#cb212-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb212-942"><a href="#cb212-942" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb212-943"><a href="#cb212-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb212-944"><a href="#cb212-944" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb212-945"><a href="#cb212-945" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb212-946"><a href="#cb212-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-947"><a href="#cb212-947" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> </span>
<span id="cb212-948"><a href="#cb212-948" aria-hidden="true" tabindex="-1"></a>  merged<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb212-949"><a href="#cb212-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_col</span>(img, </span>
<span id="cb212-950"><a href="#cb212-950" aria-hidden="true" tabindex="-1"></a>               <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"avaliacao"</span>, <span class="st">"das"</span>, <span class="st">"bloco"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb212-951"><a href="#cb212-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">das =</span> <span class="fu">as.numeric</span>(das))</span>
<span id="cb212-952"><a href="#cb212-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-953"><a href="#cb212-953" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb212-954"><a href="#cb212-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-955"><a href="#cb212-955" aria-hidden="true" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span> </span>
<span id="cb212-956"><a href="#cb212-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb212-957"><a href="#cb212-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())</span>
<span id="cb212-958"><a href="#cb212-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-959"><a href="#cb212-959" aria-hidden="true" tabindex="-1"></a><span class="co"># leaf area</span></span>
<span id="cb212-960"><a href="#cb212-960" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> b1<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b2 <span class="sc">-</span> b3 <span class="sc">*</span> x))</span>
<span id="cb212-961"><a href="#cb212-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-962"><a href="#cb212-962" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(das, area_sum)) <span class="sc">+</span> </span>
<span id="cb212-963"><a href="#cb212-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"nls"</span>,</span>
<span id="cb212-964"><a href="#cb212-964" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">formula =</span> formula,</span>
<span id="cb212-965"><a href="#cb212-965" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b1 =</span> <span class="dv">248</span>,</span>
<span id="cb212-966"><a href="#cb212-966" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b2 =</span> <span class="dv">6</span>,</span>
<span id="cb212-967"><a href="#cb212-967" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b3 =</span> <span class="fl">0.07</span>)),</span>
<span id="cb212-968"><a href="#cb212-968" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-969"><a href="#cb212-969" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb212-970"><a href="#cb212-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se,</span>
<span id="cb212-971"><a href="#cb212-971" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb212-972"><a href="#cb212-972" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb212-973"><a href="#cb212-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb212-974"><a href="#cb212-974" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb212-975"><a href="#cb212-975" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb212-976"><a href="#cb212-976" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb212-977"><a href="#cb212-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df_plot<span class="sc">$</span>das)) <span class="sc">+</span></span>
<span id="cb212-978"><a href="#cb212-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb212-979"><a href="#cb212-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Days after sowing"</span>,</span>
<span id="cb212-980"><a href="#cb212-980" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Área<span class="sc">~</span>foliar<span class="sc">~</span>média<span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span>planta<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}))) <span class="sc">+</span></span>
<span id="cb212-981"><a href="#cb212-981" aria-hidden="true" tabindex="-1"></a>  my_theme</span>
<span id="cb212-982"><a href="#cb212-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-983"><a href="#cb212-983" aria-hidden="true" tabindex="-1"></a><span class="co"># number of leaves</span></span>
<span id="cb212-984"><a href="#cb212-984" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> b1<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b2 <span class="sc">-</span> b3 <span class="sc">*</span> x))</span>
<span id="cb212-985"><a href="#cb212-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-986"><a href="#cb212-986" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(das, n)) <span class="sc">+</span> </span>
<span id="cb212-987"><a href="#cb212-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"nls"</span>,</span>
<span id="cb212-988"><a href="#cb212-988" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">formula =</span> formula,</span>
<span id="cb212-989"><a href="#cb212-989" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b1 =</span> <span class="dv">188</span>,</span>
<span id="cb212-990"><a href="#cb212-990" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b2 =</span> <span class="dv">3</span>,</span>
<span id="cb212-991"><a href="#cb212-991" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">b3 =</span> <span class="fl">0.05</span>)),</span>
<span id="cb212-992"><a href="#cb212-992" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-993"><a href="#cb212-993" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb212-994"><a href="#cb212-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se,</span>
<span id="cb212-995"><a href="#cb212-995" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb212-996"><a href="#cb212-996" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb212-997"><a href="#cb212-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb212-998"><a href="#cb212-998" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb212-999"><a href="#cb212-999" aria-hidden="true" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb212-1000"><a href="#cb212-1000" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb212-1001"><a href="#cb212-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(df_plot<span class="sc">$</span>das)) <span class="sc">+</span></span>
<span id="cb212-1002"><a href="#cb212-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb212-1003"><a href="#cb212-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Days after sowing"</span>,</span>
<span id="cb212-1004"><a href="#cb212-1004" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of leaves per plant"</span>) <span class="sc">+</span></span>
<span id="cb212-1005"><a href="#cb212-1005" aria-hidden="true" tabindex="-1"></a>  my_theme</span>
<span id="cb212-1006"><a href="#cb212-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1007"><a href="#cb212-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1008"><a href="#cb212-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1009"><a href="#cb212-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1010"><a href="#cb212-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1011"><a href="#cb212-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filling 'holes'</span></span>
<span id="cb212-1012"><a href="#cb212-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1013"><a href="#cb212-1013" aria-hidden="true" tabindex="-1"></a>An important aspect to consider in leaf area measures is when leaves present 'holes'. This can occur, for example, by the attack of pests. In this case, the area would have to be considered, because it was there! The image bellow is used as an example.</span>
<span id="cb212-1014"><a href="#cb212-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1015"><a href="#cb212-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10}</span></span>
<span id="cb212-1016"><a href="#cb212-1016" aria-hidden="true" tabindex="-1"></a>holes <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"holes.jpg"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-1017"><a href="#cb212-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1018"><a href="#cb212-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1019"><a href="#cb212-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1020"><a href="#cb212-1020" aria-hidden="true" tabindex="-1"></a>In this case, the missing area will not be computed using the default settings of <span class="in">`analyze_objects()`</span>. To include this area as the leaf area, we can use the argument <span class="in">`fill_hull()`</span>. Note that this will only work for missing areas within a closed object. If the missing area includes the original leaf contour, there is no (yet available) way to reconstruct the leaf perimeter.</span>
<span id="cb212-1021"><a href="#cb212-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1022"><a href="#cb212-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width =10,}</span></span>
<span id="cb212-1023"><a href="#cb212-1023" aria-hidden="true" tabindex="-1"></a>af <span class="ot">&lt;-</span></span>
<span id="cb212-1024"><a href="#cb212-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb212-1025"><a href="#cb212-1025" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1026"><a href="#cb212-1026" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb212-1027"><a href="#cb212-1027" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb212-1028"><a href="#cb212-1028" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb212-1029"><a href="#cb212-1029" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb212-1030"><a href="#cb212-1030" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1031"><a href="#cb212-1031" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1032"><a href="#cb212-1032" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb212-1033"><a href="#cb212-1033" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb212-1034"><a href="#cb212-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1035"><a href="#cb212-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># fill the missing area</span></span>
<span id="cb212-1036"><a href="#cb212-1036" aria-hidden="true" tabindex="-1"></a>af2 <span class="ot">&lt;-</span></span>
<span id="cb212-1037"><a href="#cb212-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(holes,</span>
<span id="cb212-1038"><a href="#cb212-1038" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>, <span class="co"># fill ' holes '</span></span>
<span id="cb212-1039"><a href="#cb212-1039" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1040"><a href="#cb212-1040" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">"white"</span>,</span>
<span id="cb212-1041"><a href="#cb212-1041" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"area"</span>,</span>
<span id="cb212-1042"><a href="#cb212-1042" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">"red"</span>,</span>
<span id="cb212-1043"><a href="#cb212-1043" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="dv">3</span>,</span>
<span id="cb212-1044"><a href="#cb212-1044" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1045"><a href="#cb212-1045" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1046"><a href="#cb212-1046" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prefix =</span> <span class="st">"proc2_"</span>,</span>
<span id="cb212-1047"><a href="#cb212-1047" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb212-1048"><a href="#cb212-1048" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">5</span>)</span>
<span id="cb212-1049"><a href="#cb212-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1050"><a href="#cb212-1050" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"proc"</span>, <span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb212-1051"><a href="#cb212-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb212-1052"><a href="#cb212-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1053"><a href="#cb212-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1054"><a href="#cb212-1054" aria-hidden="true" tabindex="-1"></a>We can simply use the ratio between <span class="in">`proc_img`</span> and <span class="in">`proc_img2`</span> to compute the injured area in this leaflet.</span>
<span id="cb212-1055"><a href="#cb212-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1058"><a href="#cb212-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1059"><a href="#cb212-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># percent of the injured area</span></span>
<span id="cb212-1060"><a href="#cb212-1060" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">-</span> <span class="dv">86432</span> <span class="sc">/</span> <span class="dv">99186</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb212-1061"><a href="#cb212-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1062"><a href="#cb212-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1063"><a href="#cb212-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1064"><a href="#cb212-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compound leaves</span></span>
<span id="cb212-1065"><a href="#cb212-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1066"><a href="#cb212-1066" aria-hidden="true" tabindex="-1"></a>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <span class="in">`analyze_objects()`</span>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</span>
<span id="cb212-1067"><a href="#cb212-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1068"><a href="#cb212-1068" aria-hidden="true" tabindex="-1"></a>The following images by <span class="co">[</span><span class="ot">Daniel Saueressig</span><span class="co">](https://www.florestaombrofilamista.com.br/sidol/?menu=contact)</span> were obtained from the *Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista*<span class="ot">[^11]</span> and show examples of simple and compound leaves.</span>
<span id="cb212-1069"><a href="#cb212-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1070"><a href="#cb212-1070" aria-hidden="true" tabindex="-1"></a><span class="ot">[^11]: https://www.florestaombrofilamista.com.br/sidol/?menu=glossary</span></span>
<span id="cb212-1071"><a href="#cb212-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1072"><a href="#cb212-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc1}</span></span>
<span id="cb212-1073"><a href="#cb212-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1074"><a href="#cb212-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1075"><a href="#cb212-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1076"><a href="#cb212-1076" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> </span>
<span id="cb212-1077"><a href="#cb212-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="fu">c</span>(<span class="st">"simple.jpg"</span>, <span class="st">"compound.jpg"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb212-1078"><a href="#cb212-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_horizontal</span>()</span>
<span id="cb212-1079"><a href="#cb212-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb212-1080"><a href="#cb212-1080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1081"><a href="#cb212-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1082"><a href="#cb212-1082" aria-hidden="true" tabindex="-1"></a>Analyzing non-touching simple leaves is fairly simple. We already did that. The squares in the background have 4 cm$^2$. With this information, it is possible to obtain the image resolution with <span class="in">`dpi(simple)`</span>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</span>
<span id="cb212-1083"><a href="#cb212-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1084"><a href="#cb212-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc2}</span></span>
<span id="cb212-1085"><a href="#cb212-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1086"><a href="#cb212-1086" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> imgs<span class="sc">$</span>simple.jpg</span>
<span id="cb212-1087"><a href="#cb212-1087" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(simple, <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-1088"><a href="#cb212-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1089"><a href="#cb212-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1090"><a href="#cb212-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1091"><a href="#cb212-1091" aria-hidden="true" tabindex="-1"></a>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. This can be solved by either using <span class="in">`object_size = "large"`</span> or <span class="in">`watershed = FALSE`</span>, to omit the watershed segmentation algorithm. The last is used here.</span>
<span id="cb212-1092"><a href="#cb212-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1093"><a href="#cb212-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc3}</span></span>
<span id="cb212-1094"><a href="#cb212-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1095"><a href="#cb212-1095" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> </span>
<span id="cb212-1096"><a href="#cb212-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(simple,</span>
<span id="cb212-1097"><a href="#cb212-1097" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1098"><a href="#cb212-1098" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>,</span>
<span id="cb212-1099"><a href="#cb212-1099" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1100"><a href="#cb212-1100" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_size =</span> <span class="dv">6</span>)</span>
<span id="cb212-1101"><a href="#cb212-1101" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(sarea, <span class="at">dpi =</span> <span class="fl">48.65</span>)</span>
<span id="cb212-1102"><a href="#cb212-1102" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb212-1103"><a href="#cb212-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1104"><a href="#cb212-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1105"><a href="#cb212-1105" aria-hidden="true" tabindex="-1"></a>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</span>
<span id="cb212-1106"><a href="#cb212-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1107"><a href="#cb212-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc4}</span></span>
<span id="cb212-1108"><a href="#cb212-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1109"><a href="#cb212-1109" aria-hidden="true" tabindex="-1"></a>compound <span class="ot">&lt;-</span> imgs<span class="sc">$</span>compound.jpg</span>
<span id="cb212-1110"><a href="#cb212-1110" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb212-1111"><a href="#cb212-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb212-1112"><a href="#cb212-1112" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1113"><a href="#cb212-1113" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1114"><a href="#cb212-1114" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-1115"><a href="#cb212-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1116"><a href="#cb212-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1117"><a href="#cb212-1117" aria-hidden="true" tabindex="-1"></a>Therefore, using <span class="in">`watershed = FALSE`</span> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</span>
<span id="cb212-1118"><a href="#cb212-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1119"><a href="#cb212-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sc5}</span></span>
<span id="cb212-1120"><a href="#cb212-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1121"><a href="#cb212-1121" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb212-1122"><a href="#cb212-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb212-1123"><a href="#cb212-1123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1124"><a href="#cb212-1124" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1125"><a href="#cb212-1125" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1126"><a href="#cb212-1126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-1127"><a href="#cb212-1127" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">"id"</span>)</span>
<span id="cb212-1128"><a href="#cb212-1128" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(carea, <span class="at">dpi =</span> <span class="fl">49.5</span>)</span>
<span id="cb212-1129"><a href="#cb212-1129" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb212-1130"><a href="#cb212-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1131"><a href="#cb212-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1132"><a href="#cb212-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1133"><a href="#cb212-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1134"><a href="#cb212-1134" aria-hidden="true" tabindex="-1"></a><span class="fu"># Shapefiles</span></span>
<span id="cb212-1135"><a href="#cb212-1135" aria-hidden="true" tabindex="-1"></a>Orthomosaic kindly provided by Prof. Dr. <span class="co">[</span><span class="ot">Ivan Ricardo Carvalho</span><span class="co">](https://www.researchgate.net/profile/Ivan-Carvalho-4)</span> (UNIJUÍ)</span>
<span id="cb212-1136"><a href="#cb212-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1137"><a href="#cb212-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1140"><a href="#cb212-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1141"><a href="#cb212-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1142"><a href="#cb212-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1143"><a href="#cb212-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1144"><a href="#cb212-1144" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"mosaic.tif"</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-1145"><a href="#cb212-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1146"><a href="#cb212-1146" aria-hidden="true" tabindex="-1"></a><span class="co"># aligned &lt;- image_align(shp)</span></span>
<span id="cb212-1147"><a href="#cb212-1147" aria-hidden="true" tabindex="-1"></a>aligned <span class="ot">&lt;-</span> <span class="fu">image_rotate</span>(shp, <span class="at">angle =</span> <span class="fl">82.591</span>)</span>
<span id="cb212-1148"><a href="#cb212-1148" aria-hidden="true" tabindex="-1"></a><span class="co"># cropped &lt;- image_crop(aligned, plot = TRUE)</span></span>
<span id="cb212-1149"><a href="#cb212-1149" aria-hidden="true" tabindex="-1"></a>cropped <span class="ot">&lt;-</span> <span class="fu">image_crop</span>(aligned,</span>
<span id="cb212-1150"><a href="#cb212-1150" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width =</span> <span class="dv">1900</span><span class="sc">:</span><span class="dv">3953</span>,</span>
<span id="cb212-1151"><a href="#cb212-1151" aria-hidden="true" tabindex="-1"></a>                      <span class="at">height =</span> <span class="dv">1350</span><span class="sc">:</span><span class="dv">1625</span>,</span>
<span id="cb212-1152"><a href="#cb212-1152" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-1153"><a href="#cb212-1153" aria-hidden="true" tabindex="-1"></a>anal <span class="ot">&lt;-</span> </span>
<span id="cb212-1154"><a href="#cb212-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects_shp</span>(cropped,</span>
<span id="cb212-1155"><a href="#cb212-1155" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="dv">26</span>,</span>
<span id="cb212-1156"><a href="#cb212-1156" aria-hidden="true" tabindex="-1"></a>                      <span class="at">index =</span> <span class="st">"HUE"</span>,</span>
<span id="cb212-1157"><a href="#cb212-1157" aria-hidden="true" tabindex="-1"></a>                      <span class="at">object_index =</span> <span class="st">"DGCI"</span>,</span>
<span id="cb212-1158"><a href="#cb212-1158" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1159"><a href="#cb212-1159" aria-hidden="true" tabindex="-1"></a>                      <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1160"><a href="#cb212-1160" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cropped)</span>
<span id="cb212-1161"><a href="#cb212-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(anal<span class="sc">$</span>shapefiles)</span>
<span id="cb212-1162"><a href="#cb212-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(anal, <span class="at">measure =</span> <span class="st">"DGCI"</span>)</span>
<span id="cb212-1163"><a href="#cb212-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1164"><a href="#cb212-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1165"><a href="#cb212-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1166"><a href="#cb212-1166" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fourier analyses</span></span>
<span id="cb212-1167"><a href="#cb212-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Functions</span></span>
<span id="cb212-1168"><a href="#cb212-1168" aria-hidden="true" tabindex="-1"></a>The functions were adapted from Claude (2088)^[Claude, J. 2008. Morphometrics with R. Springer.</span>
<span id="cb212-1169"><a href="#cb212-1169" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb212-1170"><a href="#cb212-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1173"><a href="#cb212-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1174"><a href="#cb212-1174" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb212-1175"><a href="#cb212-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: Show functions</span></span>
<span id="cb212-1176"><a href="#cb212-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1177"><a href="#cb212-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># Core function for elliptical Fourier analyses</span></span>
<span id="cb212-1178"><a href="#cb212-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># Elliptical Fourier transform (and its normalization)</span></span>
<span id="cb212-1179"><a href="#cb212-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># adapted from https://momx.github.io/Momocs/reference/fourier.html</span></span>
<span id="cb212-1180"><a href="#cb212-1180" aria-hidden="true" tabindex="-1"></a>fourier <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">nhm =</span> <span class="dv">10</span>, ...) {</span>
<span id="cb212-1181"><a href="#cb212-1181" aria-hidden="true" tabindex="-1"></a>  coo <span class="ot">&lt;-</span> <span class="fu">poly_check</span>(x) <span class="sc">|&gt;</span> <span class="fu">poly_unclose</span>()</span>
<span id="cb212-1182"><a href="#cb212-1182" aria-hidden="true" tabindex="-1"></a>  nr <span class="ot">&lt;-</span> <span class="fu">nrow</span>(coo)</span>
<span id="cb212-1183"><a href="#cb212-1183" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (nhm <span class="sc">*</span> <span class="dv">2</span> <span class="sc">&gt;</span> nr) {</span>
<span id="cb212-1184"><a href="#cb212-1184" aria-hidden="true" tabindex="-1"></a>    nhm <span class="ot">&lt;-</span> <span class="fu">floor</span>(nr<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb212-1185"><a href="#cb212-1185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">.is_verbose</span>()) {</span>
<span id="cb212-1186"><a href="#cb212-1186" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"'nhm' must be lower than half the number of points, and has been set to "</span>, nhm, <span class="st">"harmonics"</span>)</span>
<span id="cb212-1187"><a href="#cb212-1187" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb212-1188"><a href="#cb212-1188" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1189"><a href="#cb212-1189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (nhm <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) {</span>
<span id="cb212-1190"><a href="#cb212-1190" aria-hidden="true" tabindex="-1"></a>    nhm <span class="ot">=</span> <span class="fu">floor</span>(nr<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb212-1191"><a href="#cb212-1191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">.is_verbose</span>()) {</span>
<span id="cb212-1192"><a href="#cb212-1192" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"the number of harmonics used has been set to: "</span>, nhm)</span>
<span id="cb212-1193"><a href="#cb212-1193" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb212-1194"><a href="#cb212-1194" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1195"><a href="#cb212-1195" aria-hidden="true" tabindex="-1"></a>  Dx <span class="ot">&lt;-</span> coo[, <span class="dv">1</span>] <span class="sc">-</span> coo[, <span class="dv">1</span>][<span class="fu">c</span>(nr, (<span class="dv">1</span><span class="sc">:</span>(nr <span class="sc">-</span> <span class="dv">1</span>)))]</span>
<span id="cb212-1196"><a href="#cb212-1196" aria-hidden="true" tabindex="-1"></a>  Dy <span class="ot">&lt;-</span> coo[, <span class="dv">2</span>] <span class="sc">-</span> coo[, <span class="dv">2</span>][<span class="fu">c</span>(nr, (<span class="dv">1</span><span class="sc">:</span>(nr <span class="sc">-</span> <span class="dv">1</span>)))]</span>
<span id="cb212-1197"><a href="#cb212-1197" aria-hidden="true" tabindex="-1"></a>  Dt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Dx<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> Dy<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb212-1198"><a href="#cb212-1198" aria-hidden="true" tabindex="-1"></a>  Dt[Dt <span class="sc">&lt;</span> <span class="fl">1e-10</span>] <span class="ot">&lt;-</span> <span class="fl">1e-10</span>  <span class="co"># to avoid Nan</span></span>
<span id="cb212-1199"><a href="#cb212-1199" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(Dt)</span>
<span id="cb212-1200"><a href="#cb212-1200" aria-hidden="true" tabindex="-1"></a>  t1m1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, t1[<span class="sc">-</span>nr])</span>
<span id="cb212-1201"><a href="#cb212-1201" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">&lt;-</span> <span class="fu">sum</span>(Dt)</span>
<span id="cb212-1202"><a href="#cb212-1202" aria-hidden="true" tabindex="-1"></a>  an <span class="ot">&lt;-</span> bn <span class="ot">&lt;-</span> cn <span class="ot">&lt;-</span> dn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nhm)</span>
<span id="cb212-1203"><a href="#cb212-1203" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nhm) {</span>
<span id="cb212-1204"><a href="#cb212-1204" aria-hidden="true" tabindex="-1"></a>    Ti <span class="ot">&lt;-</span> (T<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> pi<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> i<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb212-1205"><a href="#cb212-1205" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> i <span class="sc">*</span> pi</span>
<span id="cb212-1206"><a href="#cb212-1206" aria-hidden="true" tabindex="-1"></a>    an[i] <span class="ot">&lt;-</span> Ti <span class="sc">*</span> <span class="fu">sum</span>((Dx<span class="sc">/</span>Dt) <span class="sc">*</span> (<span class="fu">cos</span>(r <span class="sc">*</span> t1<span class="sc">/</span>T) <span class="sc">-</span> <span class="fu">cos</span>(r <span class="sc">*</span> t1m1<span class="sc">/</span>T)))</span>
<span id="cb212-1207"><a href="#cb212-1207" aria-hidden="true" tabindex="-1"></a>    bn[i] <span class="ot">&lt;-</span> Ti <span class="sc">*</span> <span class="fu">sum</span>((Dx<span class="sc">/</span>Dt) <span class="sc">*</span> (<span class="fu">sin</span>(r <span class="sc">*</span> t1<span class="sc">/</span>T) <span class="sc">-</span> <span class="fu">sin</span>(r <span class="sc">*</span> t1m1<span class="sc">/</span>T)))</span>
<span id="cb212-1208"><a href="#cb212-1208" aria-hidden="true" tabindex="-1"></a>    cn[i] <span class="ot">&lt;-</span> Ti <span class="sc">*</span> <span class="fu">sum</span>((Dy<span class="sc">/</span>Dt) <span class="sc">*</span> (<span class="fu">cos</span>(r <span class="sc">*</span> t1<span class="sc">/</span>T) <span class="sc">-</span> <span class="fu">cos</span>(r <span class="sc">*</span> t1m1<span class="sc">/</span>T)))</span>
<span id="cb212-1209"><a href="#cb212-1209" aria-hidden="true" tabindex="-1"></a>    dn[i] <span class="ot">&lt;-</span> Ti <span class="sc">*</span> <span class="fu">sum</span>((Dy<span class="sc">/</span>Dt) <span class="sc">*</span> (<span class="fu">sin</span>(r <span class="sc">*</span> t1<span class="sc">/</span>T) <span class="sc">-</span> <span class="fu">sin</span>(r <span class="sc">*</span> t1m1<span class="sc">/</span>T)))</span>
<span id="cb212-1210"><a href="#cb212-1210" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1211"><a href="#cb212-1211" aria-hidden="true" tabindex="-1"></a>  ao <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(coo[, <span class="dv">1</span>] <span class="sc">*</span> Dt<span class="sc">/</span>T)</span>
<span id="cb212-1212"><a href="#cb212-1212" aria-hidden="true" tabindex="-1"></a>  co <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(coo[, <span class="dv">2</span>] <span class="sc">*</span> Dt<span class="sc">/</span>T)</span>
<span id="cb212-1213"><a href="#cb212-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">an =</span> an, <span class="at">bn =</span> bn, <span class="at">cn =</span> cn, <span class="at">dn =</span> dn, <span class="at">ao =</span> ao,</span>
<span id="cb212-1214"><a href="#cb212-1214" aria-hidden="true" tabindex="-1"></a>              <span class="at">co =</span> co,</span>
<span id="cb212-1215"><a href="#cb212-1215" aria-hidden="true" tabindex="-1"></a>              <span class="at">nr =</span> nr,</span>
<span id="cb212-1216"><a href="#cb212-1216" aria-hidden="true" tabindex="-1"></a>              <span class="at">coords =</span> coo))</span>
<span id="cb212-1217"><a href="#cb212-1217" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-1218"><a href="#cb212-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1219"><a href="#cb212-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalized coefficients</span></span>
<span id="cb212-1220"><a href="#cb212-1220" aria-hidden="true" tabindex="-1"></a>fourier_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(ef, <span class="at">start =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb212-1221"><a href="#cb212-1221" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> ef<span class="sc">$</span>an[<span class="dv">1</span>]</span>
<span id="cb212-1222"><a href="#cb212-1222" aria-hidden="true" tabindex="-1"></a>  B1 <span class="ot">&lt;-</span> ef<span class="sc">$</span>bn[<span class="dv">1</span>]</span>
<span id="cb212-1223"><a href="#cb212-1223" aria-hidden="true" tabindex="-1"></a>  C1 <span class="ot">&lt;-</span> ef<span class="sc">$</span>cn[<span class="dv">1</span>]</span>
<span id="cb212-1224"><a href="#cb212-1224" aria-hidden="true" tabindex="-1"></a>  D1 <span class="ot">&lt;-</span> ef<span class="sc">$</span>dn[<span class="dv">1</span>]</span>
<span id="cb212-1225"><a href="#cb212-1225" aria-hidden="true" tabindex="-1"></a>  nhm <span class="ot">&lt;-</span> <span class="fu">length</span>(ef<span class="sc">$</span>an)</span>
<span id="cb212-1226"><a href="#cb212-1226" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">atan</span>(<span class="dv">2</span> <span class="sc">*</span> (A1 <span class="sc">*</span> B1 <span class="sc">+</span> C1 <span class="sc">*</span> D1)<span class="sc">/</span>(A1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> C1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span></span>
<span id="cb212-1227"><a href="#cb212-1227" aria-hidden="true" tabindex="-1"></a>                                                 B1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> D1<span class="sc">^</span><span class="dv">2</span>))<span class="sc">%%</span>pi</span>
<span id="cb212-1228"><a href="#cb212-1228" aria-hidden="true" tabindex="-1"></a>  phaseshift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta), <span class="sc">-</span><span class="fu">sin</span>(theta),</span>
<span id="cb212-1229"><a href="#cb212-1229" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">cos</span>(theta)), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb212-1230"><a href="#cb212-1230" aria-hidden="true" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(A1, C1, B1, D1), <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">%*%</span> phaseshift</span>
<span id="cb212-1231"><a href="#cb212-1231" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">apply</span>(M2<span class="sc">^</span><span class="dv">2</span>, <span class="dv">2</span>, sum)</span>
<span id="cb212-1232"><a href="#cb212-1232" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (v[<span class="dv">1</span>] <span class="sc">&lt;</span> v[<span class="dv">2</span>]) {</span>
<span id="cb212-1233"><a href="#cb212-1233" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta <span class="sc">+</span> pi<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb212-1234"><a href="#cb212-1234" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1235"><a href="#cb212-1235" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> (theta <span class="sc">+</span> pi<span class="sc">/</span><span class="dv">2</span>)<span class="sc">%%</span>pi <span class="sc">-</span> pi<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb212-1236"><a href="#cb212-1236" aria-hidden="true" tabindex="-1"></a>  Aa <span class="ot">&lt;-</span> A1 <span class="sc">*</span> <span class="fu">cos</span>(theta) <span class="sc">+</span> B1 <span class="sc">*</span> <span class="fu">sin</span>(theta)</span>
<span id="cb212-1237"><a href="#cb212-1237" aria-hidden="true" tabindex="-1"></a>  Cc <span class="ot">&lt;-</span> C1 <span class="sc">*</span> <span class="fu">cos</span>(theta) <span class="sc">+</span> D1 <span class="sc">*</span> <span class="fu">sin</span>(theta)</span>
<span id="cb212-1238"><a href="#cb212-1238" aria-hidden="true" tabindex="-1"></a>  scale <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Aa<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> Cc<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb212-1239"><a href="#cb212-1239" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">atan</span>(Cc<span class="sc">/</span>Aa)<span class="sc">%%</span>pi</span>
<span id="cb212-1240"><a href="#cb212-1240" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Aa <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb212-1241"><a href="#cb212-1241" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> psi <span class="sc">+</span> pi</span>
<span id="cb212-1242"><a href="#cb212-1242" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1243"><a href="#cb212-1243" aria-hidden="true" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>scale</span>
<span id="cb212-1244"><a href="#cb212-1244" aria-hidden="true" tabindex="-1"></a>  rotation <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(psi), <span class="sc">-</span><span class="fu">sin</span>(psi), <span class="fu">sin</span>(psi), <span class="fu">cos</span>(psi)),</span>
<span id="cb212-1245"><a href="#cb212-1245" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb212-1246"><a href="#cb212-1246" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> B <span class="ot">&lt;-</span> C <span class="ot">&lt;-</span> D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nhm)</span>
<span id="cb212-1247"><a href="#cb212-1247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (start) {</span>
<span id="cb212-1248"><a href="#cb212-1248" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb212-1249"><a href="#cb212-1249" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1250"><a href="#cb212-1250" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nhm) {</span>
<span id="cb212-1251"><a href="#cb212-1251" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> size <span class="sc">*</span> rotation <span class="sc">%*%</span></span>
<span id="cb212-1252"><a href="#cb212-1252" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="fu">c</span>(ef<span class="sc">$</span>an[i], ef<span class="sc">$</span>cn[i],</span>
<span id="cb212-1253"><a href="#cb212-1253" aria-hidden="true" tabindex="-1"></a>               ef<span class="sc">$</span>bn[i], ef<span class="sc">$</span>dn[i]), <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">%*%</span></span>
<span id="cb212-1254"><a href="#cb212-1254" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(i <span class="sc">*</span> theta), <span class="fu">sin</span>(i <span class="sc">*</span> theta),</span>
<span id="cb212-1255"><a href="#cb212-1255" aria-hidden="true" tabindex="-1"></a>               <span class="sc">-</span><span class="fu">sin</span>(i <span class="sc">*</span> theta), <span class="fu">cos</span>(i <span class="sc">*</span> theta)), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb212-1256"><a href="#cb212-1256" aria-hidden="true" tabindex="-1"></a>    A[i] <span class="ot">&lt;-</span> mat[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb212-1257"><a href="#cb212-1257" aria-hidden="true" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> mat[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb212-1258"><a href="#cb212-1258" aria-hidden="true" tabindex="-1"></a>    C[i] <span class="ot">&lt;-</span> mat[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb212-1259"><a href="#cb212-1259" aria-hidden="true" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> mat[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb212-1260"><a href="#cb212-1260" aria-hidden="true" tabindex="-1"></a>    lnef <span class="ot">&lt;-</span> <span class="fu">c</span>(A[i], B[i], C[i], D[i])</span>
<span id="cb212-1261"><a href="#cb212-1261" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1262"><a href="#cb212-1262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">A =</span> A, <span class="at">B =</span> B, <span class="at">C =</span> C, <span class="at">D =</span> D, <span class="at">size =</span> scale, <span class="at">theta =</span> theta,</span>
<span id="cb212-1263"><a href="#cb212-1263" aria-hidden="true" tabindex="-1"></a>       <span class="at">psi =</span> psi, <span class="at">ao =</span> ef<span class="sc">$</span>ao, <span class="at">co =</span> ef<span class="sc">$</span>co, <span class="at">lnef =</span> lnef)</span>
<span id="cb212-1264"><a href="#cb212-1264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-1265"><a href="#cb212-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1266"><a href="#cb212-1266" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse fourier</span></span>
<span id="cb212-1267"><a href="#cb212-1267" aria-hidden="true" tabindex="-1"></a>fourier_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(ef, nhm, <span class="at">nb.pts =</span> <span class="dv">120</span>) {</span>
<span id="cb212-1268"><a href="#cb212-1268" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ef<span class="sc">$</span>ao))</span>
<span id="cb212-1269"><a href="#cb212-1269" aria-hidden="true" tabindex="-1"></a>    ef<span class="sc">$</span>ao <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb212-1270"><a href="#cb212-1270" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ef<span class="sc">$</span>co))</span>
<span id="cb212-1271"><a href="#cb212-1271" aria-hidden="true" tabindex="-1"></a>    ef<span class="sc">$</span>co <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb212-1272"><a href="#cb212-1272" aria-hidden="true" tabindex="-1"></a>  an <span class="ot">&lt;-</span> ef<span class="sc">$</span>an</span>
<span id="cb212-1273"><a href="#cb212-1273" aria-hidden="true" tabindex="-1"></a>  bn <span class="ot">&lt;-</span> ef<span class="sc">$</span>bn</span>
<span id="cb212-1274"><a href="#cb212-1274" aria-hidden="true" tabindex="-1"></a>  cn <span class="ot">&lt;-</span> ef<span class="sc">$</span>cn</span>
<span id="cb212-1275"><a href="#cb212-1275" aria-hidden="true" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> ef<span class="sc">$</span>dn</span>
<span id="cb212-1276"><a href="#cb212-1276" aria-hidden="true" tabindex="-1"></a>  ao <span class="ot">&lt;-</span> ef<span class="sc">$</span>ao</span>
<span id="cb212-1277"><a href="#cb212-1277" aria-hidden="true" tabindex="-1"></a>  co <span class="ot">&lt;-</span> ef<span class="sc">$</span>co</span>
<span id="cb212-1278"><a href="#cb212-1278" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(nhm)) {</span>
<span id="cb212-1279"><a href="#cb212-1279" aria-hidden="true" tabindex="-1"></a>    nhm <span class="ot">&lt;-</span> <span class="fu">length</span>(an)</span>
<span id="cb212-1280"><a href="#cb212-1280" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1281"><a href="#cb212-1281" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi, <span class="at">length =</span> nb.pts <span class="sc">+</span> <span class="dv">1</span>)[<span class="sc">-</span>(nb.pts <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb212-1282"><a href="#cb212-1282" aria-hidden="true" tabindex="-1"></a>  hx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nhm, nb.pts)</span>
<span id="cb212-1283"><a href="#cb212-1283" aria-hidden="true" tabindex="-1"></a>  hy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nhm, nb.pts)</span>
<span id="cb212-1284"><a href="#cb212-1284" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nhm) {</span>
<span id="cb212-1285"><a href="#cb212-1285" aria-hidden="true" tabindex="-1"></a>    hx[i, ] <span class="ot">&lt;-</span> an[i] <span class="sc">*</span> <span class="fu">cos</span>(i <span class="sc">*</span> theta) <span class="sc">+</span> bn[i] <span class="sc">*</span> <span class="fu">sin</span>(i <span class="sc">*</span> theta)</span>
<span id="cb212-1286"><a href="#cb212-1286" aria-hidden="true" tabindex="-1"></a>    hy[i, ] <span class="ot">&lt;-</span> cn[i] <span class="sc">*</span> <span class="fu">cos</span>(i <span class="sc">*</span> theta) <span class="sc">+</span> dn[i] <span class="sc">*</span> <span class="fu">sin</span>(i <span class="sc">*</span> theta)</span>
<span id="cb212-1287"><a href="#cb212-1287" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-1288"><a href="#cb212-1288" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (ao<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">apply</span>(hx, <span class="dv">2</span>, sum)</span>
<span id="cb212-1289"><a href="#cb212-1289" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (co<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">apply</span>(hy, <span class="dv">2</span>, sum)</span>
<span id="cb212-1290"><a href="#cb212-1290" aria-hidden="true" tabindex="-1"></a>  coo <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb212-1291"><a href="#cb212-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(coo) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb212-1292"><a href="#cb212-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coo)</span>
<span id="cb212-1293"><a href="#cb212-1293" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-1294"><a href="#cb212-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1295"><a href="#cb212-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1296"><a href="#cb212-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1297"><a href="#cb212-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1298"><a href="#cb212-1298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Elliptical fourier</span></span>
<span id="cb212-1299"><a href="#cb212-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1302"><a href="#cb212-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1303"><a href="#cb212-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1304"><a href="#cb212-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1305"><a href="#cb212-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1306"><a href="#cb212-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-1307"><a href="#cb212-1307" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">"img"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb212-1308"><a href="#cb212-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(imgs) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ind"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb212-1309"><a href="#cb212-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1310"><a href="#cb212-1310" aria-hidden="true" tabindex="-1"></a>conts <span class="ot">&lt;-</span> </span>
<span id="cb212-1311"><a href="#cb212-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(imgs,</span>
<span id="cb212-1312"><a href="#cb212-1312" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-1313"><a href="#cb212-1313" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1314"><a href="#cb212-1314" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1315"><a href="#cb212-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1316"><a href="#cb212-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1317"><a href="#cb212-1317" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">fourier</span>(conts<span class="sc">$</span>ind1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span>, <span class="at">nhm =</span> <span class="dv">100</span>)</span>
<span id="cb212-1318"><a href="#cb212-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imgs<span class="sc">$</span>ind1)</span>
<span id="cb212-1319"><a href="#cb212-1319" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 harmônicas</span></span>
<span id="cb212-1320"><a href="#cb212-1320" aria-hidden="true" tabindex="-1"></a>d_i <span class="ot">&lt;-</span> <span class="fu">fourier_inv</span>(d, <span class="dv">10</span>, <span class="at">nb.pts =</span> <span class="dv">1000</span>)</span>
<span id="cb212-1321"><a href="#cb212-1321" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(d_i, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb212-1322"><a href="#cb212-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># 20 harmônicas</span></span>
<span id="cb212-1323"><a href="#cb212-1323" aria-hidden="true" tabindex="-1"></a>d_i <span class="ot">&lt;-</span> <span class="fu">fourier_inv</span>(d, <span class="dv">20</span>, <span class="at">nb.pts =</span> <span class="dv">1000</span>)</span>
<span id="cb212-1324"><a href="#cb212-1324" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(d_i, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb212-1325"><a href="#cb212-1325" aria-hidden="true" tabindex="-1"></a><span class="co"># 40 harmônicas</span></span>
<span id="cb212-1326"><a href="#cb212-1326" aria-hidden="true" tabindex="-1"></a>d_i <span class="ot">&lt;-</span> <span class="fu">fourier_inv</span>(d, <span class="dv">80</span>, <span class="at">nb.pts =</span> <span class="dv">1000</span>)</span>
<span id="cb212-1327"><a href="#cb212-1327" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(d_i, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb212-1328"><a href="#cb212-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1329"><a href="#cb212-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1330"><a href="#cb212-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1331"><a href="#cb212-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1332"><a href="#cb212-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rotation and size</span></span>
<span id="cb212-1333"><a href="#cb212-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1336"><a href="#cb212-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1337"><a href="#cb212-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1338"><a href="#cb212-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1339"><a href="#cb212-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1340"><a href="#cb212-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span>
<span id="cb212-1341"><a href="#cb212-1341" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"changes.png"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb212-1342"><a href="#cb212-1342" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb212-1343"><a href="#cb212-1343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img,</span>
<span id="cb212-1344"><a href="#cb212-1344" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-1345"><a href="#cb212-1345" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1346"><a href="#cb212-1346" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1347"><a href="#cb212-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1348"><a href="#cb212-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1349"><a href="#cb212-1349" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fourier</span>(cont<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>, <span class="at">nhm =</span> <span class="dv">5</span>)</span>
<span id="cb212-1350"><a href="#cb212-1350" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fourier</span>(cont<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span>, <span class="at">nhm =</span> <span class="dv">5</span>)</span>
<span id="cb212-1351"><a href="#cb212-1351" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fourier</span>(cont<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span>, <span class="at">nhm =</span> <span class="dv">5</span>)</span>
<span id="cb212-1352"><a href="#cb212-1352" aria-hidden="true" tabindex="-1"></a>f1<span class="sc">$</span>an</span>
<span id="cb212-1353"><a href="#cb212-1353" aria-hidden="true" tabindex="-1"></a>f2<span class="sc">$</span>an</span>
<span id="cb212-1354"><a href="#cb212-1354" aria-hidden="true" tabindex="-1"></a>f3<span class="sc">$</span>an</span>
<span id="cb212-1355"><a href="#cb212-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1356"><a href="#cb212-1356" aria-hidden="true" tabindex="-1"></a>f1n <span class="ot">&lt;-</span> <span class="fu">fourier_norm</span>(f1)</span>
<span id="cb212-1357"><a href="#cb212-1357" aria-hidden="true" tabindex="-1"></a>f2n <span class="ot">&lt;-</span> <span class="fu">fourier_norm</span>(f2)</span>
<span id="cb212-1358"><a href="#cb212-1358" aria-hidden="true" tabindex="-1"></a>f3n <span class="ot">&lt;-</span> <span class="fu">fourier_norm</span>(f3)</span>
<span id="cb212-1359"><a href="#cb212-1359" aria-hidden="true" tabindex="-1"></a>f1n<span class="sc">$</span>A</span>
<span id="cb212-1360"><a href="#cb212-1360" aria-hidden="true" tabindex="-1"></a>f2n<span class="sc">$</span>A</span>
<span id="cb212-1361"><a href="#cb212-1361" aria-hidden="true" tabindex="-1"></a>f3n<span class="sc">$</span>A</span>
<span id="cb212-1362"><a href="#cb212-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1363"><a href="#cb212-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1364"><a href="#cb212-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1365"><a href="#cb212-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1366"><a href="#cb212-1366" aria-hidden="true" tabindex="-1"></a><span class="fu">## Morphological diversity</span></span>
<span id="cb212-1367"><a href="#cb212-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1370"><a href="#cb212-1370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1371"><a href="#cb212-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1372"><a href="#cb212-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1373"><a href="#cb212-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1374"><a href="#cb212-1374" aria-hidden="true" tabindex="-1"></a>conts <span class="ot">&lt;-</span> </span>
<span id="cb212-1375"><a href="#cb212-1375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(imgs,</span>
<span id="cb212-1376"><a href="#cb212-1376" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-1377"><a href="#cb212-1377" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1378"><a href="#cb212-1378" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1379"><a href="#cb212-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1380"><a href="#cb212-1380" aria-hidden="true" tabindex="-1"></a>eff <span class="ot">&lt;-</span> <span class="fu">lapply</span>(conts, <span class="cf">function</span>(x){</span>
<span id="cb212-1381"><a href="#cb212-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fourier</span>(x[[<span class="dv">1</span>]], <span class="at">nhm =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span> <span class="fu">fourier_norm</span>()</span>
<span id="cb212-1382"><a href="#cb212-1382" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb212-1383"><a href="#cb212-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1384"><a href="#cb212-1384" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(eff, <span class="cf">function</span>(x){x[[<span class="st">"A"</span>]]}))</span>
<span id="cb212-1385"><a href="#cb212-1385" aria-hidden="true" tabindex="-1"></a>bn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(eff, <span class="cf">function</span>(x){x[[<span class="st">"B"</span>]]}))</span>
<span id="cb212-1386"><a href="#cb212-1386" aria-hidden="true" tabindex="-1"></a>cn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(eff, <span class="cf">function</span>(x){x[[<span class="st">"C"</span>]]}))</span>
<span id="cb212-1387"><a href="#cb212-1387" aria-hidden="true" tabindex="-1"></a>dn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(eff, <span class="cf">function</span>(x){x[[<span class="st">"D"</span>]]}))</span>
<span id="cb212-1388"><a href="#cb212-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1389"><a href="#cb212-1389" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> </span>
<span id="cb212-1390"><a href="#cb212-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(an, bn, cn, dn) <span class="sc">|&gt;</span> </span>
<span id="cb212-1391"><a href="#cb212-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">specie =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"specie"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each =</span> <span class="dv">3</span>)))</span>
<span id="cb212-1392"><a href="#cb212-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1393"><a href="#cb212-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1394"><a href="#cb212-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb212-1395"><a href="#cb212-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb212-1396"><a href="#cb212-1396" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(coefs, <span class="at">quali.sup =</span> <span class="dv">61</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1397"><a href="#cb212-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca, <span class="at">habillage =</span> <span class="dv">61</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-1398"><a href="#cb212-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1399"><a href="#cb212-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs)</span>
<span id="cb212-1400"><a href="#cb212-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1401"><a href="#cb212-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1402"><a href="#cb212-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1403"><a href="#cb212-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1404"><a href="#cb212-1404" aria-hidden="true" tabindex="-1"></a><span class="fu"># Distance to an ideotype</span></span>
<span id="cb212-1405"><a href="#cb212-1405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cluster objects</span></span>
<span id="cb212-1408"><a href="#cb212-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1409"><a href="#cb212-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb212-1410"><a href="#cb212-1410" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">"distance.png"</span>, <span class="at">path =</span> <span class="st">"fourier"</span>)</span>
<span id="cb212-1411"><a href="#cb212-1411" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb212-1412"><a href="#cb212-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img,</span>
<span id="cb212-1413"><a href="#cb212-1413" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">"B"</span>,</span>
<span id="cb212-1414"><a href="#cb212-1414" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb212-1415"><a href="#cb212-1415" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1416"><a href="#cb212-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_polygon</span>(cont, <span class="at">aspect_ratio =</span> <span class="dv">1</span>)</span>
<span id="cb212-1417"><a href="#cb212-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1418"><a href="#cb212-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1419"><a href="#cb212-1419" aria-hidden="true" tabindex="-1"></a>dfour <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cont, <span class="cf">function</span>(x){</span>
<span id="cb212-1420"><a href="#cb212-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fourier</span>(x, <span class="at">nhm =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span> <span class="fu">fourier_norm</span>()</span>
<span id="cb212-1421"><a href="#cb212-1421" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb212-1422"><a href="#cb212-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1423"><a href="#cb212-1423" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(dfour, <span class="cf">function</span>(x){x[[<span class="st">"A"</span>]]}))</span>
<span id="cb212-1424"><a href="#cb212-1424" aria-hidden="true" tabindex="-1"></a>bn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(dfour, <span class="cf">function</span>(x){x[[<span class="st">"B"</span>]]}))</span>
<span id="cb212-1425"><a href="#cb212-1425" aria-hidden="true" tabindex="-1"></a>cn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(dfour, <span class="cf">function</span>(x){x[[<span class="st">"C"</span>]]}))</span>
<span id="cb212-1426"><a href="#cb212-1426" aria-hidden="true" tabindex="-1"></a>dn <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(dfour, <span class="cf">function</span>(x){x[[<span class="st">"D"</span>]]}))</span>
<span id="cb212-1427"><a href="#cb212-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1428"><a href="#cb212-1428" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(an, bn, cn, dn)</span>
<span id="cb212-1429"><a href="#cb212-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1430"><a href="#cb212-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1431"><a href="#cb212-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb212-1432"><a href="#cb212-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb212-1433"><a href="#cb212-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb212-1434"><a href="#cb212-1434" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(coefs, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1435"><a href="#cb212-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-1436"><a href="#cb212-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1437"><a href="#cb212-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># distance</span></span>
<span id="cb212-1438"><a href="#cb212-1438" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="fu">dist</span>(coefs) <span class="sc">|&gt;</span> <span class="fu">hclust</span>()</span>
<span id="cb212-1439"><a href="#cb212-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(distance, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb212-1440"><a href="#cb212-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1441"><a href="#cb212-1441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1442"><a href="#cb212-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1443"><a href="#cb212-1443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distance to an ideotype</span></span>
<span id="cb212-1446"><a href="#cb212-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1447"><a href="#cb212-1447" aria-hidden="true" tabindex="-1"></a>desc_ide <span class="ot">&lt;-</span> coefs[<span class="dv">1</span>,]</span>
<span id="cb212-1448"><a href="#cb212-1448" aria-hidden="true" tabindex="-1"></a>desc_objs <span class="ot">&lt;-</span> coefs[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb212-1449"><a href="#cb212-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1450"><a href="#cb212-1450" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the differences between each object and the ideotype</span></span>
<span id="cb212-1451"><a href="#cb212-1451" aria-hidden="true" tabindex="-1"></a>gen_ide <span class="ot">&lt;-</span> <span class="fu">sweep</span>(desc_objs, <span class="dv">2</span>, desc_ide, <span class="st">"-"</span>)</span>
<span id="cb212-1452"><a href="#cb212-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1453"><a href="#cb212-1453" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> </span>
<span id="cb212-1454"><a href="#cb212-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(gen_ide, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))}) <span class="sc">%&gt;%</span> </span>
<span id="cb212-1455"><a href="#cb212-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-1456"><a href="#cb212-1456" aria-hidden="true" tabindex="-1"></a>distances</span>
<span id="cb212-1457"><a href="#cb212-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">The {pliman} R package</div>   
    <div class="nav-footer-right">Prof.&nbsp;Dr.&nbsp;Tiago Olivoto FIT/CCA/UFSC</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>